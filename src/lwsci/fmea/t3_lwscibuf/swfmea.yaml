#
# Copyright (c) 2021, LWPU CORPORATION.  All rights reserved.
#
# LWPU CORPORATION and its licensors retain all intellectual property
# and proprietary rights in and to this software, related documentation
# and any modifications thereto.  Any use, reproduction, disclosure or
# distribution of this software and related documentation without an express
# license agreement from LWPU CORPORATION is strictly prohibited.
#

doc_id: SWE-LWSCIBUF-001-SWFMEA-WKSHT
reviewed_in:
  - "https://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145435"
  - "https://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145909"
  - "https://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/147285"
  - "https://cr.lwpu.com/ui#review:id=183243"
  - "https://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/147652"
  - "https://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/148825"
  - "https://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/153481"
  - "https://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/156287"
  - "https://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/156573"
state: Released for Review
history:
  - author: rsamant@lwpu.com
    date: Aug 19, 2021
    comment: Initial commit for 5.2
  - author: rsamant@lwpu.com
    date: Aug 27, 2021
    comment: Address review comments from CR 183243
  - author: rsamant@lwpu.com
    date: Sep 7, 2021
    comment: Added Threat IDs
  - author: rkotha@lwpu.com
    date: Oct 20, 2021
    comment: Updated testing method
  - author: rsamant@lwpu.com
    date: Nov 21, 2021
    comment: Updated effectiveness based on https://lwbugs/200764638
  - author: rkotha@lwpu.com
    date: Nov 29, 2021
    comment: Addressed confirmation review findings
input_work_products:
  - title: Software Requirement Specification
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/143331/list?projectId=22182
    rev: "LwStreams requirements for 5.2 M6a - 06/07/2021"
    purpose: Work product to identify functionalities, causes, local and external failure mode effects
  - title: Software Architecture and Design
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/143466/list?projectId=22182
    rev: "[T3 LwStreams][SWADS][5.2 M6a][V3]: Baseline"
    purpose: Work product to identify functionalities, causes, local and external failure mode effects
  - title: Boundary Diagram
    location: https://lwpu.jamacloud.com/perspective.req#/items/18839103?projectId=22182 (Version 17)
    rev: Sep 14, 2021
    purpose: Reference to SWAD section containing LwStreams boundary diagram
  - title: Sub-architecture Diagram
    location: https://lwpu.jamacloud.com/perspective.req#/items/18840033?projectId=22182 (Version 29)
    rev: Sep 14, 2021
    purpose: Reference to SWAD section containing LwStreams sub-architecture diagram
  - title: FMEA/Safety Plan
    location: https://p4viewer/get///sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/01_Project_Management/SWE-LWSTREAMS-002-SP.docx
    rev: Nov 23, 2021
    purpose: Reference to LwStreams Safety Plan
    cl: 30690141
  - title: LwStreams FMEA Functionality Map table
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/142467/list?projectId=22182
    rev: May 23, 2021
    purpose: Reference to LwStreams FMEA functionality mapping table
  - title: LwStreams heavens sheet for Init APIs
    cl: 30359060
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/03_Architectural_Design/Security/LwStreams_Heaven_init.xlsx?revision=2
    rev: Aug 30, 2021
    purpose: Heavens sheet for threat ID reference
  - title: LwStreams heavens sheet for Runtime APIs
    cl: 30359060
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/03_Architectural_Design/Security/LwStreams_Heaven_runtime.xlsx?revision=2
    rev: Aug 30, 2021
    purpose: Heavens sheet for threat ID reference
references:
  - title: "LwStreams FMEA Development Guidelines"
    cl: 30277502
    location: https://p4viewer/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/08_Safety_Analysis/SWE-LWSTREAMS-040-DG.docx?revision=13
    rev: Aug 9, 2021
    purpose: Process guidance for performing FMEAs
  - title: "SW FMEA Process Guide"
    cl: 29417137
    location: https://p4viewer.lwpu.com/get/sw/embedded/docs/admin/process/PLC/SWE-SAFETY-005-SWFMEA.docx?revision=17
    rev: Dec 11, 2020
    purpose: Process guidance for performing FMEAs
  - title: DRIVE OS 5.2 FMEA and DFA Tailoring
    cl: 30144530
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/Program_Level_WPs/01_Project_Management/SWE-DRIVE-114-SWTLR.docx?revision=2
    rev: Jul 1, 2021
    purpose: Process guidance for performing FMEAs
RASIC:
  responsible: dbhosale@lwpu.com
  approve: pjayakumar@lwpu.com
  support:
    - rsamant@lwpu.com
    - kding@lwpu.com
    - hugol@lwpu.com
  inform:
    - dshikhare@lwpu.com
    - deveshg@lwpu.com
    - dkamurthy@lwpu.com
    - aparnad@lwpu.com
  consult: rkotha@lwpu.com
  review:
    - rkotha@lwpu.com
    - rsamant@lwpu.com
    - kding@lwpu.com
    - hugol@lwpu.com

functions:
  - id: LWSCIBUF_FUNC_COMPATIBILITY_CHECKING
    description: Compatibility checking
    failure_modes:
      - id: LWSCIBUF_FUNC_COMPATIBILITY_CHECKING_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the version compatibility
          function.
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: &shared_impact_compatibility_checking >-
          ASIL-B (GID-REQ-4679278)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_COMPATIBILITY_CHECKING_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_compatibility_checking
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_COMPATIBILITY_CHECKING
            description:
              &shared_cause_description_error_without_justification >-
              LwStreams returns error code even when API performs required
              functionality. Internal failure in LwStreams.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
        evaluation: &shared_evaluation_error_without_justification
          effectiveness: High
          justification: &justification_interface_spec_docs_error_codes >-
            Verified by unit test and code inspection test that the functionality
            API interface specification dolwments all possible error codes
            returned by the functionality.
          actions: N/A
      - id: LWSCIBUF_FUNC_COMPATIBILITY_CHECKING_FM_003_WRONG_WRITE
        description: &shared_description_wrong_write >-
          LwStreams writes memory not provided by the application or modifies
          input in an unexpected way.
        class: Functionality unexpected
        local_effects: &shared_local_effects_wrong_write
          - Corruption of LwStreams data structures
        external_effects: &shared_external_effects_wrong_write
          - Corruption of memory mapped into the application's address space
        heavens_ref: N/A
        impact: *shared_impact_compatibility_checking
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4804837)
        evaluation: &shared_evaluation_wrong_write
          effectiveness: Medium
          justification: >-
            LwStreams does not maintain a record of previously created or
            allocated resources. As such, it only operates using data passed
            into the API function call.

            Thus, the only possibility for a write to be performed on memory
            that is not provided by the application is if some pointer
            arithmetic is not performed correctly, the wrong address is used
            as input to some operation, or some buffer/stack overflow.

            Lwrrently the verification of this doesn't happen explicitly. Thus
            the only verification is what is lwrrently performed as part of
            normal PLC processes (Code Review, Code Inspection, Testing, etc.).

            For egregious cases we would expect this to be caught during Code
            Review, if not Code Inspection. In other cases, the failure should
            be sufficiently deterministic since the operation would be
            stateless and thus can be detected via a verification test.

            The verification methods employed by our current tests only assert 
            that a result is written in the given output parameter, but not the
            absence of some other write during the API call.
            Also, other system level memory corruption will be analyzed in
            DriveOS FMEA.
          actions:
            - ref: https://lwbugs/200764638
              description: >-
                Set up builds with AddressSanitizer enabled and ensure that ASan
                doesn't report any errors
            - ref: https://lwbugs/200764638
              description: >-
                Run ASan builds with a fuzzing harness
            - ref: https://lwbugs/200764638
              description: >-
                Consider running the test application in a emulator or under a
                hypervisor and explicitly mapping expected allocations/accesses
                on a byte-level such that any other writes to some memory
                location outside of LwSciCommon-allocated memory or the memory
                provided as an input parameter cause a page fault or result in
                an error trap (potentially in combination with a fuzzer harness)
      - id: LWSCIBUF_FUNC_COMPATIBILITY_CHECKING_FM_004_FALSE_POSITIVE
        description: >-
          LwStreams claims that the library is compatible when it is not (false
          positive).
        class: Incorrect value
        local_effects:
          - Undefined behavior
        external_effects:
          - Application may not be able to correctly allocate buffers
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_compatibility_checking
        causes:
          - id: LWSTREAMS_BUF_CAUSE_004
            description: >-
              The LwStreams architect does not correctly identify a breaking
              change and releases a library version that does not comply with
              the versioning requirement. As a result, LwStreams claims that
              the library is compatible when in reality it is not.
            heavens_ref: N/A
            measures:
              - id: LWSCIBUF_MEAS_0001
                description: >-
                  The ABI checker tool is set up to detect breakages in the
                  library's ABI by running on public headers.
                type: Detection and Reporting of Cause
                refs:
                  - 18839622 # LwSciBufCheckVersionCompatibility
                tests: [] # TODO: Add ABI checker scan result?
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
        evaluation:
          effectiveness: Medium
          justification: >-
            The ABI checker only verifies that the ABI provided by LwStreams
            has not changed, but does not make any guarantees about the
            behavior of the API.

            LwStreams does not lwrrently verify the compatibility of all its
            dependencies, either at runtime or at compile-time, as evidenced by
            LwColor.

            However, this case is impossible due to the use-cases DRIVE OS
            lwrrently supports.
          actions:
            - ref: https://lwbugs/200764638
              description: >-
                Add an item to the release runbook (or process) to ensure that the
                library version is incremented whenever a release contains new
                functionality
            - ref: https://lwbugs/200764638
              description: >-
                Consider imposing a versioning requirement on all dependencies
            - ref: https://lwbugs/200764638
              description: >-
                Add documentation for a compatibility matrix of compatible
                driver/release versions
      - id: LWSCIBUF_FUNC_COMPATIBILITY_CHECKING_FM_005_FALSE_NEGATIVE
        description: >-
          LwStreams claims that the library is not compatible when it is
          (false negative).
        class: Incorrect value
        local_effects: None
        external_effects:
          - Application incorrectly thinks that the two versions of LwStreams
            cannot be used together
          - Application unable to continue
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_compatibility_checking
        causes:
          - id: LWSTREAMS_BUF_CAUSE_002
            description: >-
              The LwStreams architect incorrectly identifies a breaking change
              and releases a library version that does not comply with the
              versioning requirement. As a result, LwStreams claims that the
              library is incompatible when in reality it is compatible.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
        evaluation:
          effectiveness: High
          justification: >-
            This measure prevents the DRIVE OS application from transitioning
            from the init phase to the runtime phase. As such, if an
            application checks the version compatibility and LwStreams claims
            that the versions are not compatible (when in reality they are),
            the safe state is maintained.
          actions: N/A
      - id: LWSCIBUF_FUNC_COMPATIBILITY_CHECKING_FM_006_TIMEOUT
        description: >-
          LwStreams compatibility checking hangs or takes too long.
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_compatibility_checking
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: &shared_evaluation_hang
          effectiveness: High
          justification: >-
            This measure prevents the DRIVE OS application from transitioning from the init phase
              to the runtime phase when an error is detected. As such, if an application checks the
              error code and observes an error, the safe state is maintained.
          actions: N/A
  - id: LWSCIBUF_FUNC_GET_CPU_POINTER_FROM_LWSCIBUFOBJ
    description: Get CPU Pointer from LwSciBufObj
    failure_modes:
      - id: LWSCIBUF_FUNC_GET_CPU_POINTER_FROM_LWSCIBUFOBJ_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the Get CPU Pointer
          function.
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: &shared_impact_get_cpu_pointer >-
          ASIL-B (GID-REQ-4679256)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_CPU_POINTER_FROM_LWSCIBUFOBJ_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_get_cpu_pointer
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_GET_CPU_POINTER_FROM_LWSCIBUFOBJ
            description: *shared_cause_description_error_without_justification
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
        evaluation: *shared_evaluation_error_without_justification
      - id: LWSCIBUF_FUNC_GET_CPU_POINTER_FROM_LWSCIBUFOBJ_FM_003_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_get_cpu_pointer
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4789170, GID-SWAD-4789171)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_GET_CPU_POINTER_FROM_LWSCIBUFOBJ_FM_004_WHEN_NOT_ALLOWED
        description: >-
          Get CPU Pointer from LwSciBufObj returns a CPU pointer when CPU
          access was not provided on the allocated LwSciBufObj
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Escalation of privilege
          - Undefined behavior
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_get_cpu_pointer
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_010
            # - LwStreams does not properly validate the CPU access
            # - LwStreams does not properly maintain the associated CPU access
            #   when allocating the LwSciBufObj
            description: >-
              Internal failure in LwStreams.
            na: >-
              This failure mode cause is prevented by design (GID-SWAD-4789170,
              GID-SWAD-4789171, GID-SWAD-4789164)
        evaluation:
          effectiveness: High
          justification: >-
            The integration tests verify that when the LwSciBufObj does not return a
            CPU pointer when CPU access was not provided on the LwSciBufObj.

            The integration tests for LwSciBufObjAlloc() verifies the CPU access
            associated with the LwSciBufObj are properly set.
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_CPU_POINTER_FROM_LWSCIBUFOBJ_FM_006_NO_WRITES
        description: >-
          Returns a CPU pointer that doesn't allow writes when read/write
          access was requested
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Writes may not actually get reflected
          - Undefined behavior
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_get_cpu_pointer
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_011
            # - Returns some other CPU pointer
            # - LwStreams stored the wrong CPU pointer during allocation
            # - LwStreams didn't request read/write access during allocation
            description: >-
              Internal failure in LwStreams
            na: >-
              This failure mode cause is prevented by design (GID-SWAD-4789170,
              GID-SWAD-4789171, GID-SWAD-4789164).
          # Things handled by LwSciCommon
          # - corruption of the data structure
        evaluation:
          effectiveness: High
          justification: &shared_justification_not_verified >-
            All causes are prevented by design and verified by testing.
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_CPU_POINTER_FROM_LWSCIBUFOBJ_FM_004_CPU_POINER_TOO_HIGH
        description: >-
          Incorrect virtual address is returned as the CPU pointer
        class: Incorrect value
        local_effects:
          - Potentially corrupt LwStreams data structures
        external_effects:
          - Access other mapped buffers via the address provided by the pointer
          - Potentially a page fault when attempting to access unmapped memory
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_get_cpu_pointer
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_011
            # Things handled by LwSciCommon
            # - The memory storing the location of the CPU pointer in the
            #   LwSciBufObj was corrupted
        evaluation:
          effectiveness: High
          justification: *shared_justification_not_verified
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_CPU_POINTER_FROM_LWSCIBUFOBJ_FM_003_TIMEOUT
        description: >-
          Get CPU Pointer from LwSciBufObj hangs or takes too long.
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_get_cpu_pointer
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang
  - id: LWSCIBUF_FUNC_TRANSPORT_DESCRIPTOR_FREE
    description: Transport descriptor free
    failure_modes:
      - id: LWSCIBUF_FUNC_TRANSPORT_DESCRIPTOR_FREE_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the Transport descriptor
          free function
        class: Functionality missing
        local_effects: None
        external_effects: &shared_external_effects_transport_descriptor_free
          - Memory allocated for the transport descriptor will be leaked
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: &shared_impact_transport_descriptor_free >-
          ASIL-B (GID-REQ-4679216)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_TRANSPORT_DESCRIPTOR_FREE_FM_002_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_transport_descriptor_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4789170, GID-SWAD-4789171)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_TRANSPORT_DESCRIPTOR_FREE_FM_003_DOES_NOT_DESTROY_DESCRIPTOR
        description: >-
          The LwStreams does not destroy the transport descriptor.
        class: Functionality unexpected
        local_effects: None
        external_effects: *shared_external_effects_transport_descriptor_free
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_transport_descriptor_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_650
            # - Does not call free
            # - Calls free on a NULL address
            description: >-
              Internal failure in LwStreams.
            na: >-
              This failure mode cause is prevented by design (GID-SWAD-4790260,
              GID-SWAD-4790253)
            # TODO: Can we refer to SQA's test plans? If so, then this is
            # implicitly covered by the Valgrind+stress tests
        evaluation:
          effectiveness: High
          justification: *shared_justification_not_verified
          actions: N/A
      - id: LWSCIBUF_FUNC_TRANSPORT_DESCRIPTOR_FREE_FM_004_DESTROY_DESCRIPTOR_UNEXPECTED
        description: >-
          The LwStreams destroys the transport descriptor when not requested
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Double free when the transport descriptor is actually freed
            (resulting in a SIGABRT)
        heavens_ref: N/A
        impact: *shared_impact_transport_descriptor_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_651
            description: >-
              Internal failure in LwStreams.
            na: >-
              LwStreams is a userspace library which is ilwoked only by
              application calls. LwSciBuf does not maintain any background
              exelwtion threads or call these APIs.

              Prevented by design (GID-SWAD-4790260, GID-SWAD-4790253).
        evaluation:
          effectiveness: Medium
          justification: >-
            LwSciBuf does have background threads. As such, the only way an API
            can be called is if it is initiated by the API user.
          actions:
            - ref: https://lwbugs/200764638
              description: >-
                Add a Verification Method via Inspection that LwSciBuf does not
                call LwSciBufAttrListAndObjFreeDesc() or
                LwSciBufAttrListFreeDesc()
      - id: LWSCIBUF_FUNC_TRANSPORT_DESCRIPTOR_FREE_FM_005_DESTROY_WRONG_DESCRIPTOR
        description: >-
          LwStreams frees the incorrect descriptor
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Memory allocated for the transport descriptor (that was not freed)
            will be leaked
          - Attempts to access the incorrectly freed descriptor will result in
            unexpected behavior
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_transport_descriptor_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_652
            # - Does not pass the same input parameter to the free function
            # - Input parameter is corrupted prior to passing to the free function
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4790260, GID-SWAD-4790253).
        evaluation:
          effectiveness: High
          justification: >-
            The integration tests asserts that the correct parameters are passed
            to the LwSciCommon API.
          actions: N/A
      - id: LWSCIBUF_FUNC_TRANSPORT_DESCRIPTOR_FREE_FM_006_DOES_NOT_CLEAR
        description: >-
          LwStreams partially clears/does not completely clear the memory
          associated with the allocated memory used to store the transport
          descriptor
        class: Incorrect value
        local_effects:
          - APIs may reuse the descriptor without realizing that the memory has
            already been freed
        external_effects:
          - May successfully call LwStreams APIs to send transport descriptors
            on an already-freed transport descriptor
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_transport_descriptor_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_653
            # Things handled by LwSciCommon
            # - LwSciCommon doesn't clear the Magic ID
            # - LwSciCommon doesn't zero out the memory
            # - LwSciCommon doesn't zero out the metadata header
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4790260, GID-SWAD-4790253).
          - LWSTREAMS_BUF_SHARED_CAUSE_001
        evaluation:
          effectiveness: High
          justification: *shared_justification_not_verified
          actions: N/A
      - id: LWSCIBUF_FUNC_TRANSPORT_DESCRIPTOR_FREE_FM_002_TIMEOUT
        description: >-
          LwStreams transport descriptor freeing hangs or takes too long.
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_transport_descriptor_free
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation:
          effectiveness: High
          justification: >-
            This measure detects when the cause oclwrs.
          actions: N/A
  - id: LWSCIBUF_FUNC_GET_ATTRIBUTE_LIST_FROM_OJBECT
    description: Get attribute list from object
    failure_modes:
      - id: LWSCIBUF_FUNC_GET_ATTRIBUTE_LIST_FROM_OJBECT_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the Get attribute list
          from object function.
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: &shared_impact_get_attribute_list_from_object >-
          ASIL-B (GID-REQ-4679255)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_ATTRIBUTE_LIST_FROM_OJBECT_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_get_attribute_list_from_object
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_GET_ATTRIBUTE_LIST_FROM_OJBECT
            description: *shared_cause_description_error_without_justification
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
      - id: LWSCIBUF_FUNC_GET_ATTRIBUTE_LIST_FROM_OJBECT_FM_003_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_get_attribute_list_from_object
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4789168)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_GET_ATTRIBUTE_LIST_FROM_OJBECT_FM_004_ILWALID_LIST
        description: >-
          LwStreams does not return the reconciled LwSciBufAttrList associated
          with the allocated LwSciBufObj. Instead an invalid LwSciBufAttrList
          is returned.
        class: Functionality unexpected
        local_effects:
          - Subsequent library operations on the LwSciBufAttrList may fail
        external_effects:
          - Subsequent library operations on the LwSciBufAttrList may fail
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_get_attribute_list_from_object
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_303
            # - Incorrect reconciled attribute list is stored
            #
            # Things handled by LwSciCommon
            # - Stored reconciled attribute list is corrupted
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789168, GID-SWAD-4789164)
        evaluation:
          &shared_evaluation_get_attribute_list_missing_assert_identical
          effectiveness: High
          justification: *shared_justification_not_verified
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_ATTRIBUTE_LIST_FROM_OJBECT_FM_006_WRONG_ATTRIBUTE_LIST
        description: >-
          LwStreams does not return the correct reconciled attribute list
          associated to the given LwSciBufObj. Instead a reconciled
          LwSciBufAttrList corresponding to some other LwSciBufObj is returned.
        class: Incorrect value
        local_effects:
          - Further operations on retrieved list will give incorrect results.
        external_effects:
          - Incorrect results for subsequent operations on the retrieved list
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_get_attribute_list_from_object
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_303
        evaluation: *shared_evaluation_get_attribute_list_missing_assert_identical
      - id: LWSCIBUF_FUNC_GET_ATTRIBUTE_LIST_FROM_OJBECT_FM_007_TIMEOUT
        description: >-
          LwStreams hangs or takes too long
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_get_attribute_list_from_object
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang
  - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE
    description: Create object reference
    failure_modes:
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the create object
          reference function
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_332
        impact: &shared_impact_create_object_reference >-
          ASIL-B (GID-REQ-4679263)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_create_object_reference
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_CREATE_OBJECT_REFERENCE
            description: *shared_cause_description_error_without_justification
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_010_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_create_object_reference
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4789178)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_004_DOES_NOT_ACQUIRE_REFERENCE
        description: >-
          LwStreams did not acquire a reference on the input LwSciBufObj
        class: Functionality unexpected
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - LwSciBufObj will be destroyed too soon
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_create_object_reference
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_069
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789178) and verified by integration
              testing (GID-TEST-4911147)
        evaluation:
          effectiveness: High
          justification: >-
            The test asserts that the LwSciCommon API is called to increment
            the reference count.
          actions: N/A
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_008_ACQUIRES_WRONG_REFERENCE
        description: >-
          LwStreams acquires a reference on a different LwSciBufObj
        class: Functionality unexpected
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - Potential resource leak later
          - References reach their maximum sooner than anticipated
          - LwSciBufObj may be freed too soon, leading to undefined behavior
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_create_object_reference
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_069
        evaluation:
          effectiveness: High
          justification: >-
            The integration test asserts that the correct LwSciBufObj reference is
            provided.
          actions: N/A
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_009_UNEXPECTED
        description: >-
          LwStreams acquires a reference on the LwSciBufObj when not requested
        class: Functionality unexpected
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - Potential resource leak later
          - References reach their maximum sooner than anticipated
          - LwSciBufObj may be freed too soon, leading to undefined behavior
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_create_object_reference
        causes:
          - id: LWSCIBUF_CAUSE_NA_651
            # - API is called unexpectedly
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789178)
        evaluation:
          effectiveness: High
          justification: >-
            LwSciBuf does have background threads. As such, the only way an API
            can be called is if it is initiated by the API user.
          actions:
            - ref: https://lwbugs/200764638
              description: >-
                Add a Verification Method via Inspection that LwSciBuf does not
                call LwSciBufObjRef()
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_005_ACQUIRES_MULTIPLE_REFERENCE
        description: >-
          LwStreams acquires more than one reference on the input LwSciBufObj
        class: Incorrect value
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - Potential resource leak later
          - References reach their maximum sooner than anticipated
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_create_object_reference
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_070
            # - LwSciCommon API takes multiple references
            # - LwSciCommon API to take references is called multiple times
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789178)
        evaluation:
          effectiveness: High
          justification: >-
            The existing integration test asserts that the LwSciCommon API to
            increment references is only called once.
          actions: N/A
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_006_DECREMENTS_REFERENCE
        description: >-
          LwStreams decrements the reference on the input LwSciBufObj
        class: Incorrect value
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - LwSciBufObj may be released too early
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_create_object_reference
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_071
            # - LwSciCommon API actually decrements instead of incrementing
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789178)
        evaluation:
          effectiveness: High
          justification: >-
            While the integration test asserts that the LwSciCommon API is called to
            increment the reference count.
          actions: N/A
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_007_OVERFLOW_REFERENCE
        description: >-
          LwStreams overflows the reference count
        class: Incorrect value
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - LwSciBufObj may be freed too early
          - The underlying buffer may be freed before the application has
            completed reading/writing from it, leading to undefined behavior
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_create_object_reference
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_073
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789178)
        evaluation:
          effectiveness: High
          justification: >-
            The architecture claims that an overflow is detected as an error.

            The integration test verifies that LwSciError_IlwalidState is indeed
            returned.
          actions: N/A
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_REFERENCE_FM_003_TIMEOUT
        description: >-
          LwStreams hangs or takes too long
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_create_object_reference
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang
  - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG
    description: Set Lwmedia flag
    failure_modes:
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the Set LwMedia flag
          function.
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_332
        impact: &shared_impact_set_lwmedia_flag >-
          ASIL-B (GID-REQ-4679262)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_set_lwmedia_flag
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_SET_LWMEDIA_FLAG
            description: *shared_cause_description_error_without_justification
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_003_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_set_lwmedia_flag
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4789181)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_004_GET_WRONG_INDEX
        description: >-
          LwStreams returns the value for the wrong flag index
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Incorrect values are returned
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_set_lwmedia_flag
        causes:
          - id: LWSCIBUF_CAUSE_NA_100_SET_LWMEDIA_FLAG_USE_WRONG_INDEX
            # - LwStreams retrieves the value from the wrong index
            # - LwStreams retrieves the right index but returns the wrong value
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789181)
        evaluation: &shared_evaluation_set_lwmedia_flag_wrong_index
          effectiveness: High
          justification: >-
            The integration test does not actually assert that the set bit inside the
            bitset matches what was returned.

            However, the integration test asserts that calling the API again
            results in the write being reflected, which indicates that the
            correct index is being used.
          actions: N/A
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_005_SET_WRONG_INDEX
        description: >-
          LwStreams sets the given value at the wrong flag index
        class: Functionality unexpected
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - Application uses corrupted data
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_set_lwmedia_flag
        causes:
          - id: LWSCIBUF_CAUSE_NA_102_SET_LWMEDIA_FLAG_SET_AT_WRONG_INDEX
            # - LwStreams uses the wrong index
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789181)
        evaluation: *shared_evaluation_set_lwmedia_flag_wrong_index
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_006_SET_WRONG_VALUE
        description: >-
          LwStreams sets the wrong value at the correct flag index
        class: Functionality unexpected
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - Application uses corrupted data
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_set_lwmedia_flag
        causes:
          - id: LWSCIBUF_CAUSE_NA_103_SET_LWMEDIA_FLAG_SET_WRONG_VALUE
            # - LwStreams does not store the given value
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789181)
        evaluation: *shared_evaluation_set_lwmedia_flag_wrong_index
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_007_SET_MULTIPLE_INDICES
        description: >-
          LwStreams sets multiple indices
        class: Functionality unexpected
        local_effects:
          - Corruption of LwStreams data structures
        external_effects:
          - Application uses corrupted data
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_set_lwmedia_flag
        causes:
          - id: LWSCIBUF_CAUSE_NA_104_SET_LWMEDIA_FLAG_IMPROPER_UPDATE
            # - LwStreams does not properly construct the update operation
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789181) and verified by
              integration test (GID-TEST-4913276)
        evaluation:
          effectiveness: High
          justification: >-
            The integration test asserts on the old and new values of the
            LwMedia flags in a loop over all allowed indices.

            If multiple indices were set, then the old value would eventually
            reflect the wrong value.
          actions: N/A
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_008_RETURN_STALE_VALUE
        description: >-
          LwStreams retrieves the correct index but returns a stale value
        class: Incorrect value
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application does not use the correct flag value
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_set_lwmedia_flag
        causes:
          - id: LWSCIBUF_CAUSE_NA_105_SET_LWMEDIA_FLAG_IMPROPER_SYNCHRONIZATION
            # - Improper synchronization between reads/updates of LwMedia flags
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789181) and verified by integration 
              testing (GID-TEST-4910987) and integration testing
              (GID-TEST-4913276)
        evaluation:
          effectiveness: High
          justification: >-
            The integration test asserts on the old and new values of the
            LwMedia flags in a loop over all allowed indices.

            If a stale value is returned, then eventually the second API call
            to read the value will reflect a stale value.

            The integration test verifies the correct locking operations are called.
          actions: N/A
      - id: LWSCIBUF_FUNC_SET_LWMEDIA_FLAG_FM_009_TIMEOUT
        description: >-
          LwStreams hangs or takes too long
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_set_lwmedia_flag
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang
  - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH
    description: CPU Cache flush
    failure_modes:
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the CPU cache flush
          function.
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_495
        impact: &shared_impact_cpu_cache_flush >-
          ASIL-B (GID-REQ-4679257)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_cpu_cache_flush
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_CPU_CACHE_FLUSH
            description: *shared_cause_description_error_without_justification
            heavens_ref: N/A
            measures: []
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_003_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_cpu_cache_flush
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4789172)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_004_CLAIM_SUCCESS_ACTUALLY_UNSUCCESSFUL
        description: >-
          LwStreams claims that the cache flush was successfully performed when
          it was not
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application may not be performing cache coherent reads/writes
          - Corruption of data stored within buffers
        heavens_ref: T3_LwStreams_495
        impact: *shared_impact_cpu_cache_flush
        causes:
          - id: LWSCIBUF_CAUSE_NA_201_CPU_CACHE_FLUSH_DOES_NOT_PROPAGATE_ERROR
            # - LwStreams does not propagate errors from the LwRm dependency
            # - LwStreams calls the wrong API
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789172)
        evaluation:
          effectiveness: High
          justification: >-
            In order to verify that the correct API is being called, this must
            be done via a integration test.
          actions: N/A
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_008_WHEN_COHERENCY_NOT_REQUIRED
        description: >-
          Flushes when NeedSWCacheCoherency is not set to true
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Flushes may be attempted when the memory is not mapped
          - Corruption
          - Undefined behavior
        heavens_ref: T3_LwStreams_495
        impact: *shared_impact_cpu_cache_flush
        causes:
          - id: LWSCIBUF_CAUSE_NA_400
            # - LwStreams does not properly validate that the general attribute
            #   key NeedSWCacheCoherency is set to true
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789172)
        evaluation:
          effectiveness: High
          justification: >-
            The existing integration test verifies the absence of a
            call to flush the memory.
          actions: N/A
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_009_WHEN_NOT_REQUIRED
        description: >-
          Flushes when CPU access is not requested
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Flushes may be attempted when the memory is not mapped
          - Corruption
          - Undefined behavior
        heavens_ref: N/A
        impact: *shared_impact_cpu_cache_flush
        causes:
          - id: LWSCIBUF_CAUSE_NA_400_NO_CPU_ACCESS
            # - LwStreams does not properly validate that the buffer was not
            #   mapped to the CPU
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789172)
        evaluation:
          effectiveness: High
          justification: >-
            The existing integration test proves the absence of a call to the
            LwRm API when CPU access is not required.
          actions: N/A
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_005_WRONG_FLUSH_PARAMS
        description: >-
          Flushes bytes using incorrect parameters (beginning from the wrong
          start address, using the wrong offset callwlated from the given start
          address, flushes the incorrect number of bytes using the wrong length
          callwlated)
        class: Incorrect value
        local_effects: None
        external_effects:
          - Application may not be performing cache coherent reads/writes
          - Corruption of data stored within buffers
          - The wrong data may be flushed
        heavens_ref: T3_LwStreams_495
        impact: *shared_impact_cpu_cache_flush
        causes:
          - id: LWSCIBUF_CAUSE_NA_600
            # - Uses wrong start address/length/offset
            # - Start address/length/offset is corrupted
            description: >
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789172)
        evaluation:
          effectiveness: High
          justification: >-
            The tests asserts that the values provided to the LwRm API
            are the same as the ones provided to the API (or are callwlated
            correctly).
          actions: N/A
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_010_TIMEOUT
        description: >-
          LwStreams hangs or takes too long
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_cpu_cache_flush
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang
      - id: LWSCIBUF_FUNC_CPU_CACHE_FLUSH_FM_011_TOO_SOON
        description: >-
          LwStreams claims that the cache flush was successfully completed
          before it was completed
        class: Incorrect timing
        local_effects: None
        external_effects:
          - Application may not be performing cache coherent reads/writes
          - Corruption of data stored within buffers
        heavens_ref: T3_LwStreams_495
        impact: *shared_impact_cpu_cache_flush
        causes:
          - id: LWSCIBUF_CAUSE_NA_202_CPU_CACHE_FLUSH_ASYNC
            description: >-
              LwStreams calls a non-blocking async API but returns before the
              async operation completes
            na: >-
              Prevented by design (GID-SWAD-4789172)
        evaluation:
          effectiveness: High
          justification: >-
            This is prevented by architecture since none of the LwSciBuf APIs
            that are called are async.
          actions: N/A
  - id: LWSCIBUF_FUNC_GET_MEMORY_HANDLE_FROM_OBJECT
    description: Get memory handle from Object
    failure_modes:
      - id: LWSCIBUF_FUNC_GET_MEMORY_HANDLE_FROM_OBJECT_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the Get memory handle
          from object.
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_332
        impact: &shared_impact_get_memory_handle >-
          ASIL-B (GID-REQ-4679260)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_MEMORY_HANDLE_FROM_OBJECT_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_get_memory_handle
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_GET_MEMORY_HANDLE_FROM_OBJECT
            description: LwStreams returns error code even when API performs required functionality. Internal failure in LwStreams.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
      - id: LWSCIBUF_FUNC_GET_MEMORY_HANDLE_FROM_OBJECT_FM_003_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_get_memory_handle
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4789179)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_GET_MEMORY_HANDLE_FROM_OBJECT_FM_004_RETURN_ILWALID_MEMHANDLE
        description: >-
          Returns some invalid memory handle
        class: Incorrect value
        local_effects: None
        external_effects:
          - Subsequent calls using the memory handle will potentially fail
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_get_memory_handle
        causes:
          - id: LWSCIBUF_CAUSE_NA_700
            # - Incorrect memory handle was stored on the LwSciBufObj
            # - Wrong memory handle was returned
            # - Corruption of the stored memory handle
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789179, GID-SWAD-4789164)
        evaluation:
          effectiveness: High
          justification: >-
            The existing integration tests asserts that the memory handle
            returned is the same one that was stored.
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_MEMORY_HANDLE_FROM_OBJECT_FM_005_RETURN_INCORRECT_MEMHANDLE
        description: >-
          Returns some incorrect memory handle associated with some other
          underlying buffer
        class: Incorrect value
        local_effects: None
        external_effects:
          - Subsequent calls using the memory handle will potentially fail
          - Potential access to handles corresponding to other memory buffers
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_get_memory_handle
        causes:
          - LWSCIBUF_CAUSE_NA_700
        evaluation:
          effectiveness: High
          justification: >-
            The existing integration tests asserts that the memory handle
            returned is the same one that was stored.
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_MEMORY_HANDLE_FROM_OBJECT_FM_008_RETURN_INCORRECT_BUF_PROPERTIES
        description: >-
          Returns the correct RM handle but the incorrect result in variables
          describing buffer properties (buffer offset, buffer length)
        class: Incorrect value
        heavens_ref: T3_LwStreams_332
        local_effects: None
        external_effects:
          - Subsequent callwlations using the buffer offset will be incorrect
          - Subsequent callwlations using the buffer length will be incorrect
          - Potential invalid reads past the actual underlying buffer length
          - Layout of buffer is potentially interpreted incorrectly
        impact: *shared_impact_get_memory_handle
        causes:
          - id: LWSCIBUF_CAUSE_NA_502
            # - Incorrect offset/length was stored on the LwSciBufObj
            # - Wrong offset/length was returned
            # - Corruption of the stored offset/length
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789179, GID-SWAD-4789164)
        evaluation:
          effectiveness: High
          justification: >-
            The existing integration tests asserts that the buffer properties
            are stored during LwSciBufObjAlloc()
          actions: N/A
      - id: LWSCIBUF_FUNC_GET_MEMORY_HANDLE_FROM_OBJECT_FM_009_TIMEOUT
        description: >-
          LwStreams hangs or takes too long
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_get_memory_handle
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang
  - id: LWSCIBUF_FUNC_COLOR_FORMAT_COLWERSION
    description: Color format colwersion
    failure_modes:
      - id: LWSCIBUF_FUNC_COLOR_FORMAT_COLWERSION_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the Color format
          colwersion functionality.
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_332
        impact: &shared_impact_color_format_colwersion >-
          ASIL-B (GID-REQ-4679276, GID-REQ-4679277)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_COLOR_FORMAT_COLWERSION_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_color_format_colwersion
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_COLOR_FORMAT_COLWERSION
            description: *shared_cause_description_error_without_justification
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
      - id: LWSCIBUF_FUNC_COLOR_FORMAT_COLWERSION_FM_003_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_color_format_colwersion
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_020
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4804428, GID-SWAD-4804429)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_COLOR_FORMAT_COLWERSION_FM_005_RETURN_WRONG_VALUE
        description: >-
          LwStreams does not correctly colwert the color format
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application uses the incorrect colwerted color format
          - The wrong color format may be used to set attribute keys
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_color_format_colwersion
        causes:
          - id: LWSCIBUF_CAUSE_NA_750
            # - Mapping between LwColor and LwSciColor is incorrect
            # - The mapping is not properly utilized
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4804428, GID-SWAD-4804429)
        evaluation: &shared_evaluation_color_colwersion
          effectiveness: High
          justification: >-
            The existing integration tests exercises colwersions for
            various color formats.
          actions: N/A
      - id: LWSCIBUF_FUNC_COLOR_FORMAT_COLWERSION_FM_004_RETURN_ILWALID_VALUE
        description: >-
          LwStreams correctly colwerts the color format but returns an invalid
          color format
        class: Incorrect value
        local_effects: None
        external_effects:
          - Application makes use of an invalid enum value
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_color_format_colwersion
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_304
            # - Wrong variable is used
            # - The colwerted value is not the same value being returned
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4804428, GID-SWAD-4804429)
        evaluation: *shared_evaluation_color_colwersion
      - id: LWSCIBUF_FUNC_COLOR_FORMAT_COLWERSION_FM_006_COLWERT_RETURN_WRONG_COLOR_FORMAT
        description: >-
          LwStreams correctly colwerts the color format but returns the wrong
          color format
        class: Incorrect value
        local_effects: None
        external_effects:
          - Application uses the incorrect colwerted color format
          - The wrong color format may be used to set attribute keys
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_color_format_colwersion
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_304
        evaluation: *shared_evaluation_color_colwersion
      - id: LWSCIBUF_FUNC_COLOR_FORMAT_COLWERSION_FM_003_TIMEOUT
        description: >-
          LwStreams hangs or takes too long
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_color_format_colwersion
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang
  - id: LWSCIBUF_FUNC_OBJECT_FREE
    description: Object free
    failure_modes:
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the object free function.
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: &shared_impact_object_free >-
          ASIL-B (GID-REQ-4679258, GID-REQ-4679259)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_object_free
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_OBJECT_FREE
            description: *shared_cause_description_error_without_justification
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_003_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_object_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_030
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4804428, GID-SWAD-4804429)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_004_DOES_NOT_RELEASE_OBJ_REF
        description: >-
          Does not release reference on the LwSciBufObj
        class: Functionality unexpected
        local_effects:
          - LwSciBufObj will not actually get destroyed
          - Resource leak
        external_effects:
          - Resource leak
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_object_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_200
            # - Doesn't call LwSciCommon API to release the reference
            # - LwSciCommon API doesn't decrement refcount
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789165) and verified by integration
              testing (GID-TEST-4911116)
        evaluation:
          effectiveness: High
          justification: >-
            The integration test asserts that LwSciCommon APIs are called and that
            the interface deallocation function is called
          actions: N/A
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_005_DOES_NOT_RELEASE_ATTRLIST_REF
        description: >-
          Frees the LwSciBufObj but does not decrement the reference on the
          associated LwSciBufAttrList
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Resource leak
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_object_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_201
            # - Doesn't decrement refcount
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789165)
        evaluation:
          effectiveness: High
          justification: >-
            The existing integration tests asserts that the reference on the
            associated LwSciBufAttrList is decremented.
          actions: N/A
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_006_DOES_NOT_FREE_BUFFER
        description: >-
          Does not free the underlying buffer associated with the LwSciBufObj
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Resource leak
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_object_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_202
            # - Doesn't call cleanup function
            # - Doesn't call LwRm API
            # - LwRm API fails
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789165)
        evaluation:
          effectiveness: High
          justification: >-
            The integration test asserts that LwSciCommon & LwRm APIs are called and that
            the interface deallocation function is called.
          actions: N/A
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_007_DOES_NOT_UNMAP_BUFFER
        description: >-
          Does not unmap the underlying buffer associated with the LwSciBufObj
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Underlying buffer may still be accessible via a CPU pointer
          - Resource leak since the underlying buffer will not have decremented
            its reference count
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_object_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_203
            # - Doesn't call cleanup function
            # - Doesn't call LwRm API to unmap the buffer
            # - LwRm API fails
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789165)
        evaluation:
          effectiveness: High
          justification: >-
            The existing integration test asserts that the LwRm API is called.
          actions: N/A
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_008_FREE_BEFORE_ALL_REFERENCES_DECREMENT
        description: >-
          Frees the LwSciBufObj before all the references on the LwSciBufObj
          are closed
        class: Functionality unexpected
        local_effects:
          - Operations on the LwSciBufObj will fail
        external_effects:
          - Operations on the LwSciBufObj will fail
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        impact: *shared_impact_object_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_204
            # - Doesn't maintain the reference count correctly
            # - Reference count is corrupted
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789165) and verified by integration
              testing (GID-TEST-4911116)
        evaluation:
          effectiveness: High
          justification: >-
            The LwSciCommon APIs used always increment and decrement reference
            counts by 1. In addition, the free callback in the LwSciCommon API
            only frees when the reference count is 0, as evident by the integration
            test exercising LwSciCommon behavior.
          actions: N/A
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_010_DOES_NOT_CLEAR_LWSCIBUFOBJ
        description: >-
          LwStreams partially clears/does not completely clear the memory
          associated with the allocated memory to store the LwSciBufObj
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects:
          - APIs may reuse the LwSciBufObj without realizing that the memory
            has already been freed
        external_effects:
          - May successfully call LwStreams APIs on an already freed LwSciBufObj
        impact: *shared_impact_object_free
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_205
            # - Doesn't call cleanup function
            # - Doesn't call LwRm API
            # - LwRm API fails
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4789165)
          - LWSTREAMS_BUF_SHARED_CAUSE_001
        evaluation:
          effectiveness: High
          justification: >-
            Integration tests verify that the LwSciBufObj is freed via the
            LwSciCommon APIs. Integration test verified that the reference count
            is incremented and decremented by 1. LwSciCommon test verified that 
            freed memory is cleared by overwritten 0 on it.
          actions: N/A
      - id: LWSCIBUF_FUNC_OBJECT_FREE_FM_012_TIMEOUT
        description: >-
          LwStreams hangs or takes too long
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_object_free
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang
  - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION
    description: Engine ID colwersion
    failure_modes:
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_001_MISSING
        description: >-
          Some intended functionality is missing from the Engine ID colwersion
          functions
        class: Functionality missing
        local_effects: None
        external_effects: N/A
        heavens_ref: T3_LwStreams_332
        impact: &shared_impact_engine_id_colwersion >-
          ASIL-B (GID-REQ-4679273, GID-REQ-4679272, GID-REQ-4679274)
        causes:
          - LWSTREAMS_BUF_CAUSE_NA_001
        evaluation:
          effectiveness: High
          justification: >-
            Implausible failure mode
          actions: N/A
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_002_ERROR
        description: >-
          LwStreams returns an error without justification
        class: Functionality unexpected
        local_effects: None
        external_effects:
          - Application unable to continue
        heavens_ref: N/A
        impact: *shared_impact_engine_id_colwersion
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_ENGINE_ID_COLWERSION
            description: *shared_cause_description_error_without_justification
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_003_WRONG_WRITE
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        heavens_ref: N/A
        impact: *shared_impact_engine_id_colwersion
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_040
            description: >-
              Internal failure in LwStreams.
            na: >-
              Prevented by design (GID-SWAD-4788520, LWSTRMS52-SWAD-461,
              GID-SWAD-4788524, GID-SWAD-4788525)
        evaluation: *shared_evaluation_wrong_write
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_004_RETURN_WRONG_HW_ENGINE_NAME
        description: >-
          Returns the wrong hardware engine from the unique engine identifier
        class: Functionality unexpected
        local_effects:
          - Uses wrong hardware engine in subsequent operations
        external_effects:
          - Uses wrong hardware engine in subsequent operations
        heavens_ref: T3_LwStreams_332
        impact: &shared_impact_engine_id_colwersion_only_name >-
          ASIL-B (GID-REQ-4679273)
        causes:
          - id: LWSCIBUF_CAUSE_NA_800
            # - Doesn't check the correct bits in the engine id
            # - Corrupts the engine id
            # - Returns the wrong variable
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4788524)
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_005_RETURN_ILWALID_HW_ENGINE_NAME
        description: >-
          Returns an invalid hardware engine from the unique engine identifier
        class: Functionality unexpected
        local_effects:
          - Uses invalid hardware engine in subsequent operations
        external_effects:
          - Uses invalid hardware engine in subsequent operations
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_engine_id_colwersion_only_name
        causes:
          - id: LWSCIBUF_CAUSE_NA_801
            # - Doesn't validate the id (or the hardware engine name)
            # - Doesn't check the correct bits in the engine id
            # - Corrupts the engine id
            # - Returns the wrong variable
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4788524)
        evaluation:
          effectiveness: Medium
          justification: *shared_justification_not_verified
          actions:
            - ref: https://lwbugs/200764638
              description: >-
                Implement fuzzing over the space of potential engine identifiers.
                The harness can check that when the operation successfully
                completes a valid enum value is returned.
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_006_GENERATE_NONUNIQUE_IDENTIFIERS
        description: >-
          Does not provide a unique identifier for every possible
          (LwSciBufHwEngName, instance) combination
        class: Functionality unexpected
        local_effects:
          - Treats a non-unique identifier as a unique identifier
        external_effects:
          - Treats a non-unique identifier as a unique identifier potentially
            resulting in hash collisions
        heavens_ref: T3_LwStreams_332
        impact: &shared_impact_engine_id_colwersion_only_identifier >-
          ASIL-B (GID-REQ-4679272)
        causes:
          - id: LWSCIBUF_CAUSE_NA_802
            # - Overflow results in some values being the same
            # - Implementation always returns the same id
            # Things handled by LwSciCommon
            # - Corruption
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4788522, GID-SWAD-4788520)
        evaluation:
          effectiveness: Medium
          justification: >-
            The only way to lwrrently verify this is a manual effort. This can
            potentially be automated via an explicit test that checks for this.
          actions:
            - ref: https://lwbugs/200764638
              description: >-
                Write a fuzzer test over the space of valid inputs and ensure
                that all the values generated are unique
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_007_UNSTABLE_IDENTIFIERS
        description: >-
          Does not provide a stable identifier when the identifier for a
          (LwSciBufHwEngName, instance) combination is requested multiple times
        class: Functionality unexpected
        local_effects:
          - Cannot properly identify a hardware engine instance
        external_effects:
          - Cannot properly identify a hardware engine instance
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_engine_id_colwersion_only_identifier
        causes:
          - id: LWSCIBUF_CAUSE_NA_803
            # - Callwlation of id is incorrect
            # - Corruption
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4788522, GID-SWAD-4788520)
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_008_RETURN_WHEN_ILWALID_HW_ENGINE_ID
        description: >-
          Returns the hardware engine instance when the hardware engine id is
          invalid
        class: Functionality unexpected
        local_effects:
          - Uses hardware engine assuming that the hardware engine id is valid
        external_effects:
          - Uses hardware engine assuming that the hardware engine id is valid
          - Subsequent operations on the hardware engine id to extract the
            hardware engine name may fail
        heavens_ref: T3_LwStreams_332
        impact: &shared_impact_engine_id_colwersion_only_instance >-
          ASIL-B (GID-REQ-4679274)
        causes:
          - id: LWSCIBUF_CAUSE_NA_805
            # - Does not validate the given hardware engine id
            # - Corruption of data obtained from the APIs to create ids
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4788525)
        evaluation:
          effectiveness: Medium
          justification: *shared_justification_not_verified
          actions:
            - ref: https://lwbugs/200764638
              description: >-
                Add a fuzzer harness that fuzzes over the space of int64_t values
                to ensure that the hardware engine instance is successfully
                extracted if and only if the hardware engine name is also
                successfully extracted
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_009_RETURN_WRONG_HW_ENGINE_INSTANCE
        description: >-
          Returns the incorrect value of hardware engine instance
        class: Incorrect value
        local_effects:
          - Uses wrong hardware engine instance in subsequent operations
        external_effects:
          - Uses wrong hardware engine instance in subsequent operations
        heavens_ref: T3_LwStreams_332
        impact: *shared_impact_engine_id_colwersion_only_instance
        causes:
          - id: LWSCIBUF_CAUSE_NA_804
            # - Uses the wrong mask
            # - Corrupts the masked result
            description: >-
              Internal failure in LwStreams
            na: >-
              Prevented by design (GID-SWAD-4788522, GID-SWAD-4788520)
        evaluation:
          effectiveness: High
          justification: Integration test verifies zero as well as non-zero instance indices.
          actions: N/A
      - id: LWSCIBUF_FUNC_ENGINE_ID_COLWERSION_FM_010_TIMEOUT
        description: >-
          LwStreams hangs or takes too long
        class: Incorrect timing
        local_effects:
          - LwStreams hangs
        external_effects:
          - Application hang and unable to continue
        heavens_ref: N/A
        impact: *shared_impact_engine_id_colwersion
        causes:
          - LWSTREAMS_BUF_CAUSE_005
        evaluation: *shared_evaluation_hang

  # 21774280 Module open
  - id: LWSCIBUF_FUNC_MODULE_OPEN
    requirements:
      - 18838395
    description: Module open

    failure_modes:
      - id: LWSCIBUF_FUNC_MODULE_OPEN_FM_001
        description: LwStreams reports an error without justification
        impact: ASIL-B (GID-REQ-4679183)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_MODULE_OPEN
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_MODULE_OPEN_FM_002
        description: LwStreams creates new modules when not requested
        impact: ASIL-B (GID-REQ-4679183)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: N/A
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_MODULE_OPEN
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4796400).

      - id: LWSCIBUF_FUNC_MODULE_OPEN_FM_005
        impact: ASIL-B (GID-REQ-4679183)
        heavens_ref: N/A
        description: *shared_description_wrong_write
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_MODULE_OPEN
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4796400)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_MODULE_OPEN_FM_006
        description: LwStreams returns a new module that is incorrect.
          Incorrect module includes module not fully initialized, new module with resources bounded, module without Magic ID initialized.
        impact: ASIL-B (GID-REQ-4679183)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to perform subsequent operations on attribute list, which may lead to unpredicted behavior.
        external_effects: Application may not be able to use the new attribute on subsequent operations which may lead to unpredicted behavior.
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_MODULE_OPEN
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4796400).

      - id: LWSCIBUF_FUNC_MODULE_OPEN_FM_003
        description: LwStreams returns an existing module instead of a new module
        impact: ASIL-B (GID-REQ-4679183)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application will use existing module to perform subsequent operations which were intended to be performed on new module.
          This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_MODULE_OPEN
            description: Internal failure in LwStreams
            # implausible error LwStreams doesn't keep track of module allocations done previously
            na:
              LwStreams doesn't keep track of module allocations done previously.
              This failure mode cause is prevented by design (GID-SWAD-4796400).

      - id: LWSCIBUF_FUNC_MODULE_OPEN_FM_004
        description: LwStreams module open hangs or takes too long
        impact: ASIL-B (GID-REQ-4679183)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_MODULE_CLOSE
    #21774281 Module close
    requirements:
      - 18838398
      - 18838401
    description: Module close

    failure_modes:
      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_001
        description: LwStreams allows access to the module after it is closed or destroyed
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects:
          LwStreams accesses module after it is closed when performing operations on bound resources.
          This may lead to memory corruption or even crash.
        external_effects: Application may perform operations on closed module which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_001_MODULE_CLOSE
            description: Internal failure in LwStreams
            # LwStreams may fail to remove magic ID from module
            # LwStreams may fail to free memory
            na: This failure mode cause is prevented by design (GID-SWAD-4796401).
          - LWSTREAMS_BUF_SHARED_CAUSE_001

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_011
        description: LwStreams reports an error without justification
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_MODULE_CLOSE
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_002
        description: LwStreams does not release resources associated with the module after it is closed and no LwSciBuf resources are bound to the module
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams won't be able to allocate resources on subsequent requests.
        external_effects: Application won't be able to allocate more resources.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_MODULE_CLOSE
            description: Internal failure in LwStreams
            # LwStreams may fail to free device structures
            na: This failure mode cause is prevented by design (GID-SWAD-4796401).

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_003
        description: LwStreams destroys a module before it is closed or while LwSciBuf resources are still bound to the module
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams may try to destroy the module again when resources bound to it are destroyed
        external_effects: Application may have unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_MODULE_CLOSE
            description: Internal failure in LwStreams
            # LwStreams may free module when reference count is greater than 0
            na: This failure mode cause is prevented by design (GID-SWAD-4796401).
          - LWSTREAMS_BUF_SHARED_CAUSE_001

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_004
        description: LwStreams changes the observable state of an LwSciBuf resource bound to the module when the module is closed
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: When LwStreams performs subsequent operations on LwSciBuf resources (whose observable state was changed), it may lead to unpredicted behavior.
        external_effects: When the application performs subsequent operations on LwSciBuf resources bound to module, it may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_MODULE_CLOSE
            description: Internal failure in LwStreams
            # LwStreams may modify attribute list and object bound to this module
            na: This failure mode cause is prevented by design (GID-SWAD-4796401).

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_005
        description: LwStreams stops allowing access to a module before it is closed
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application won't be able to perform subsequent operations on the module which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_MODULE_CLOSE
            description: Internal failure in LwStreams
            # LwStreams does not allow to increment ref count of module which is not closed when operating on attribute or object
            na: Prevented by design (GID-SWAD-4796401).

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_009
        description: *shared_description_wrong_write
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_MODULE_CLOSE
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4796401)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_010
        description: LwStreams changes observable state of module instead of closing access and destroying it.
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams may try to destroy the module again when resources bound to it are destroyed.
        external_effects: Application may perform subsequent operations which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_MODULE_CLOSE
            description: Internal failure in LwStreams
            # LwStreams does not free the object but overwrites some data to it.
            na: This failure mode cause is prevented by design (GID-SWAD-4796401).

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_007
        description: LwStreams closes and destroys module when not requested
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application won't be able to perform subsequent operations on the module which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_MODULE_CLOSE
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4796401).

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_006
        description: LwStreams closes and destroys module which was not provided by user
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application won't be able to perform subsequent operations on the module which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_MODULE_CLOSE
            description: Internal failure in LwStreams
            # implausible error LwStreams doesn't keep track of module allocations done previously
            na:
              LwStreams doesn't keep track of module allocations done previously.
              Prevented by design (GID-SWAD-4796401).

      - id: LWSCIBUF_FUNC_MODULE_CLOSE_FM_008
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679184, GID-REQ-4679185)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION
    # 21774283
    requirements:
      - 18838446
    description: Attribute list creation
    failure_modes:
      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_001
        description: LwStreams reports an error without justification
        impact: ASIL-B (GID-REQ-4679203)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_ATTRIBUTE_LIST_CREATION
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_002
        description: LwStreams creates new attribute lists when not requested
        impact: ASIL-B (GID-REQ-4679203)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: N/A
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_003
        description: LwStreams returns NULL or an invalid attribute list
        # Invalid attribute list,
        #   - attribute list with output only attribute set
        #   - partially initialized attribute list
        #   - non-readable-writable attribute list
        #   - attributes with "input only" accessibility set
        impact: ASIL-B (GID-REQ-4679203)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams won't be able to perform subsequent operations on attribute list, which may lead to unpredicted behavior.
        external_effects: Application may not be able to use the new attribute on subsequent operations which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            # LwStreams does not initialize the data attribute list
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_013
        description: *shared_description_wrong_write
        impact: ASIL-B (GID-REQ-4679203)
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_012_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4793830)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_004
        description: LwStreams returns an attribute list with attributes having presence as optional already set
        # default value is incorrect for buffer allocation
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams may allocate a buffer with incorrect properties which may lead to unpredicted behavior
        external_effects:
          Application may not set attributes having presence as optional and buffer allocate by LwStreams.
          The allocated buffer may not be as per application expectations which may lead to buffer corruption and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            # LwStreams sets attributes having presence as optional in attribute list when creating it
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_005
        description: LwStreams returns an attribute list with attributes having presence other than optional already set
        # default value is incorrect for buffer allocation
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may not be able to set value of attributes having presence other than optional in attribute list.
          Application unable to continue.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            # LwStreams sets attributes having presence other than optional in attribute list when creating it
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_006
        description: LwStreams returns an attribute list with more number of slots than requested
        # User always requests single slot attribute list, but LwStreams provides multi-slot attribute list
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_007
        description: LwStreams returns an attribute list with less number of slots than requested
        # User always requests single slot attribute list, but LwStreams provides zero-slot attribute list
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application won't be able to set attributes in new attribute list.
          Application unable to continue.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_008
        description: LwStreams returns an attribute list not bound to the specified module
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams won't be able to fully free LwSciBuf resources
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_009
        description: LwStreams returns an attribute list not bound to the module specified by application
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams may perform subsequent operations on wrong module which is bound to attribute list.
        external_effects:
          Application may perform unintentional operations on wrong module like unbinding etc when operating on returned attribute list.
          This may lead to unpredicted behavior.
          Application may try to perform reconciliation which may fail due to mis-match in bound
          module of input unreconciled attribute list. Application unable to continue.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_010
        description: LwStreams returns a reconciled attribute list instead of an empty attribute list
        # default value is incorrect for buffer allocation
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application won't be able to perform subsequent operations, like setting attributes on the returned attribute list which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_010_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_012
        description: LwStreams returns an existing attribute list instead of a new attribute list
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application will use existing attribute to perform subsequent operations which were intended to be performed on new attribute list. This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_011_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams
            # implausible error LwStreams doesn't keep track of attribute list allocations done previously
            na: This failure mode cause is prevented by design (GID-SWAD-4793830).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CREATION_FM_011
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679203)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES
    # 21774285
    requirements:
      - 17822370
      - 18838464
      - 18838461
    description: Setting attributes

    failure_modes:
      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_001
        description: LwStreams reports an error without justification
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_SETTING_ATTRIBUTES
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_002
        description: LwStreams failed to validate if the provided attribute list is unreconciled and sets attributes in attribute list other than unreconciled list.
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams may corrupt reconciled or appended attribute list
        external_effects: Application may perform subsequent operations on corrupted attribute list which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_003
        description: LwStreams failed to change "set status" of provided attributes in provided attribute list to "set"
        # This also includes failure mode where LwStreams sets "set status" to something other than "set"
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may be able to set the value of attribute again which may lead to incorrect reconciliation, buffer allocation and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_004
        description: LwStreams failed to validated the provided attributes are of "accessibility type" "input" in provided attribute list
        # this also includes failure mode where LwStreams sets attributes and sets "set status" when "accessibility type" is not "input"
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may be able to set the value of output attribute which may lead to incorrect buffer allocation and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_005
        description: LwStreams failed to validate the provided attribute has "set status" as "unset" in provided attribute list
        # this also includes failure mode where LwStreams sets attributes and sets "set status" when "set status" is not "unset"
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may be able to set the value of attribute again which may lead to incorrect reconciliation, buffer allocation and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_006
        description: LwStreams sets attribute value for another attribute in provided attribute list. "another attribute" means attribute not be provided by the application
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may be able to set the value of attribute again which may lead to incorrect reconciliation, buffer allocation and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_007
        description: LwStreams sets "set status" of provided attribute to value other than "set" in provided attribute list
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may be able to set the value of attribute again which may lead to incorrect reconciliation, buffer allocation and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_008
        description: LwStreams sets "set status" of another attribute in provided attribute list
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may not be able to set the value of attribute which may restrict the application from entering runtime phase.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_009
        description: LwStreams sets attributes into non-provided attribute list. LwStreams sets "set status" into non-provided attribute list"
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may not be able to set the value of attribute in non-provided attribute list which may restrict the application from entering runtime phase.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_011
        description: LwStreams sets attribute when not requested.
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality unexpected
        heavens_ref: N/A
        local_effects: None
        external_effects:
          Application won't be able to perform set functionality on same attributes
          which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_011_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_012
        description: LwStreams does not set attribute value or attribute "set status" in provided unreconciled list
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may perform subsequent operations like reconcile and allocate buffer based on assumption that attributes are set.
          Application will use the buffer incorrectly leading to data corruption or unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_012_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_014
        description: *shared_description_wrong_write
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_013_ATTRIBUTE_LIST_CREATION
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4793832, GID-SWAD-4793839)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_015
        description: LwStreams does perform set attribute operation on attribute list atomically
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may perform operation on same attribute list conlwrrently which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_014_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_010
        description: LwStreams sets provided attribute to wrong attribute value in provided attribute list.
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may perform subsequent operations like reconciliation which may give incorrect results.
          Application will use the buffer incorrectly leading to unpredicted behavior or corruption.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_010_SETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793832, GID-SWAD-4793839).

      - id: LWSCIBUF_FUNC_SETTING_ATTRIBUTES_FM_013
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679189, GID-REQ-4679210, GID-REQ-4679208)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_GETTING_ATTRIBUTES
    # 21774286
    requirements:
      - 18838458
      - 18838464
    # This functionality also includes
    # - Get slot count
    # - Get isReconciled status
    description: Getting attributes

    failure_modes:
      - id: LWSCIBUF_FUNC_GETTING_ATTRIBUTES_FM_001
        description: LwStreams reports an error without justification
        impact: ASIL-B (GID-REQ-4679207, GID-REQ-4679210)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_GETTING_ATTRIBUTE
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_GETTING_ATTRIBUTES_FM_002
        description: LwStreams failed to validate the provided attributes are of "accessibility type" "output" in provided reconciled attribute list
        impact: ASIL-B (GID-REQ-4679207, GID-REQ-4679210)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may read attributes of "accessibility type" "input" and incorrectly interpret the buffer which may lead to corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_GETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793834, GID-SWAD-4793840).

      - id: LWSCIBUF_FUNC_GETTING_ATTRIBUTES_FM_005
        impact: ASIL-B (GID-REQ-4679207, GID-REQ-4679210)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_GETTING_ATTRIBUTES
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4793834, GID-SWAD-4793840)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_GETTING_ATTRIBUTES_FM_006
        description: LwStreams does perform get attribute operation on attribute list atomically
        impact: ASIL-B (GID-REQ-4679207, GID-REQ-4679210)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may perform operation on same attribute list conlwrrently which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_GETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793834, GID-SWAD-4793840).

      - id: LWSCIBUF_FUNC_GETTING_ATTRIBUTES_FM_007
        description: LwStreams changes ordering of input/output key-value pair list.
        impact: ASIL-B (GID-REQ-4679207, GID-REQ-4679210)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may read the key-value pair unaware of new reordering, which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_GETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793834, GID-SWAD-4793840).

      - id: LWSCIBUF_FUNC_GETTING_ATTRIBUTES_FM_003
        description: LwStreams returns incorrect value for the provided attributes in provided attribute list
        # This also covers cases where LwStreams fails to populate the output attributes
        # retrieves the attributes from another attribute list instead of the input attribute list
        # mixes the attribute values such that a value for one attribute is reported for a distinct attribute
        # LwStreams considers unset attributes as set attribute
        impact: ASIL-B (GID-REQ-4679207, GID-REQ-4679210)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams may use this functionality internally which may lead to unpredicted behavior when incorrect value is returned.
        external_effects: LwStreams may perform incorrect client logic based on incorrect returned value, this may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_GETTING_ATTRIBUTES
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793834, GID-SWAD-4793840).

      - id: LWSCIBUF_FUNC_GETTING_ATTRIBUTES_FM_004
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679207, GID-REQ-4679210)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE
    #21774295
    requirements:
      - 18838449
      - 18838452
    description: Attribute list free

    failure_modes:
      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_001
        description: LwStreams reports an error without justification
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_ATTRIBUTE_LIST_FREE
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_002
        description: LwStreams does not close access to provided attribute list
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects:
          LwStreams accesses the attribute list after it is closed when performing operations on bounded resources.
          This may lead to memory corruption or even crash.
        external_effects: Application may perform operations on attribute which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_ATTRIBUTE_LIST_FREE
            description: Internal failure in LwStreams
            # LwStreams may fail to remove magic ID from attribute list
            # LwStreams may fail to free memory
            na: This failure mode cause is prevented by design (GID-SWAD-4793831).
          - LWSTREAMS_BUF_SHARED_CAUSE_001

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_008
        description: LwStreams does not destroy attribute list, when access to attribute list is closed and no object is bound to it.
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        class: Functionality missing
        local_effects: subsequent resource allocations may fail
        external_effects: Application won't be able to do allocate resources which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_ATTRIBUTE_LIST_FREE
            # LwStreams does not destroy attribute list when reference count is zero
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793831).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_004
        description: LwStreams unbinds the attribute list from the module before the attribute list is destroyed
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        class: Functionality unexpected
        local_effects: LwStreams will try to free already unbound module which will lead to double free which may lead to unpredicted behavior or crash
        external_effects: Application may see unpredicted behavior or crash
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_ATTRIBUTE_LIST_FREE
            # LwStreams unbinds module before reference count is zero
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793831).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_005
        description: LwStreams does not unbind to module and destroys the attribute list
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        class: Functionality unexpected
        local_effects: LwStreams won't be able to free the module as it will have stray attribute list bound to it
        external_effects: Application won't be able to free module which may lead to resource exhaustion
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_ATTRIBUTE_LIST_FREE
            # LwStreams does not decrease reference count of module
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793831).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_006
        description: LwStreams destroys attribute list when access to it was not closed
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        class: Functionality unexpected
        local_effects: None
        external_effects: Application may perform operations on closed attribute list which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_ATTRIBUTE_LIST_FREE
            # LwStreams destroys attribute list before reference count is zero
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793831).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_007
        description: LwStreams destroys attribute list when objects are bound to it
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        class: Functionality unexpected
        local_effects: LwStreams will try to free already destroyed attribute list when freeing object which will lead to double free which may lead to unpredicted behavior or crash
        external_effects: Application may see unpredicted behavior or crash when trying to free object
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_ATTRIBUTE_LIST_FREE
            # LwStreams destroys attribute list before reference count is zero
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793831).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_009
        description: LwStreams changes observable state of module and object bound to provided attribute list
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: When LwStreams performs subsequent operations on LwSciBuf resources (whose observable state was changed), it may lead to unpredicted behavior.
        external_effects: When the application performs subsequent operations on LwSciBuf resources bound to module, it may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_ATTRIBUTE_LIST_FREE
            # LwStreams does not destroy attribute list when reference count is zero
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793831).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_011
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_010_ATTRIBUTE_LIST_FREE
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4793831)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_003
        description: LwStreams closes access to and destroys an attribute list that the application did not request it to close
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application won't be able to perform subsequent operations on the attribute list which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_ATTRIBUTE_LIST_FREE
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4793831).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_FREE_FM_010
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679204, GID-REQ-4679205)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING
    #21774299
    requirements:
      - 18838455
    description: Attribute list cloning

    failure_modes:
      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_001
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-4679206)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_ATTRIBUTE_LIST_CLONING
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_005
        description: LwStreams does not set attribute status in cloned list to "unset" when input list is unreconciled attribute list
        impact: ASIL-B (GID-REQ-4679206)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may fail to perform Set attribute functionality on the cloned attribute list leading to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_ATTRIBUTE_LIST_CLONING
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793836).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_008
        impact: ASIL-B (GID-REQ-4679206)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_ATTRIBUTE_LIST_CLONING
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4793836)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_009
        description: LwStreams creates new cloned attribute list when not requested
        impact: ASIL-B (GID-REQ-4679206)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_ATTRIBUTE_LIST_CLONING
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4793836).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_003
        description: LwStreams creates multiple cloned attribute list
        impact: ASIL-B (GID-REQ-4679206)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_ATTRIBUTE_LIST_CLONING
            description: Internal failure in LwStreams
            # LwStreams returns array of cloned attribute list, while application is expecting single attribute list.
            na: Prevented by design (GID-SWAD-4793836).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_002
        description: LwStreams returns incorrectly cloned attribute list
        # incorrectly cloned includes
        # - NULL attr list
        # - invalid attr list
        # - attr list with different attr list status
        # - attr list with different attribute key status
        # - attr list with different slot count than the input attribute list
        impact: ASIL-B (GID-REQ-4679206)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may see unpredicted behavior on subsequent operations on cloned attribute list
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_ATTRIBUTE_LIST_CLONING
            # LwStreams failed to reset attribute status to unset
            # LwStreams failed to copy reconciliation status
            # LwStreams copied incorrect values in cloned attribute list
            # LwStreams failed to perform clone operation atomically
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793836).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_004
        description: LwStreams returns an existing attribute list instead of a new attribute list
        impact: ASIL-B (GID-REQ-4679206)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application will use existing attribute list to perform subsequent operations which were intended to be performed on new attribute list.
          This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_ATTRIBUTE_LIST_CLONING
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793836).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_006
        description: LwStreams set attribute status in cloned list to "unset" when input list is reconciled attribute list
        impact: ASIL-B (GID-REQ-4679206)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may overwrite values in reconciled attribute list leading to incorrect buffer allocation and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_ATTRIBUTE_LIST_CLONING
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793836).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_CLONING_FM_007
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679206)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_ATTRIBUTE_LISTS_APPENDING
    #21774302
    requirements:
      - 18838467
    description: Attribute lists appending

    failure_modes:
      - id: LWSCIBUF_FUNC_ATTRIBUTE_LISTS_APPENDING_FM_001
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-4679211)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_ATTRIBUTE_LISTS_APPENDING
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LISTS_APPENDING_FM_002
        description: LwStreams returns incorrectly appended attribute list
        # incorrectly appended attr list includes
        # - NULL attr list
        # - invalid attr list
        # - attr list with reconciled attribute status
        # - attr list with different attribute key status
        impact: ASIL-B (GID-REQ-4679211)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may see unpredicted behavior on subsequent operations on appended attribute list
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_ATTRIBUTE_LIST_APPENDING
            # LwStreams failed to copy reconciliation status
            # LwStreams copied incorrect values in appended attribute list
            # LwStreams failed to perform append operation atomically
            # LwStreams copies data across different slots
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793837).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LISTS_APPENDING_FM_006
        impact: ASIL-B (GID-REQ-4679211)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_ATTRIBUTE_LIST_APPENDING
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4793837)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LISTS_APPENDING_FM_007
        description: LwStreams creates new appended attribute list when not requested
        impact: ASIL-B (GID-REQ-4679211)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_ATTRIBUTE_LIST_APPENDING
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4793837).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LISTS_APPENDING_FM_003
        description: LwStreams returns an existing attribute list instead of a new attribute list
        impact: ASIL-B (GID-REQ-4679211)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application will use existing attribute list to perform subsequent operations
          which were intended to be performed on new attribute list. This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_ATTRIBUTE_LIST_APPENDING
            # LwStreams doesn't keep track of appended attribute list allocations done previously
            # LwStreams may return back input attribute list as appended attribute list
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4793837).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LISTS_APPENDING_FM_005
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679211)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION
    #21774304
    requirements:
      - 18838545
      - 20093805
      - 18838548
    description: Object allocation

    failure_modes:
      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_001
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_OBJECT_ALLOCATION
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_006
        description: LwStreams allocate new buffer not bound to provided input reconciled list
        # this failure mode also includes case where buffer is bound to some other reconciled attribute list
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may prematurely deallocate the reconciled attribute list. When the application tries to get reconciled attribute list from object it may fail.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_007
        description: LwStreams does not allocate a new buffer but returns an invalid buffer
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: When the application tries to access buffer it may cause corruption or unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_008
        description: LwStreams does not allocate buffer aligned to 64KB when Display engine is present in the EngineList array of the provided reconciled attribute list
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: When the application tries to access buffer via Display engine that should be 64KB aligned it may cause unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_010
        description: LwStreams does not grant read-write permission to allocated buffer but sets read-write permission attribute in reconciled attribute list
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may not be able to perform read-write operations on allocated buffer which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_011
        description: LwStreams grants read-write permission to allocated buffer but does not set read-write permission attribute in reconciled attribute list
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may read access permissions from reconciled attribute list which may lead to unpredicted behavior in clients logic
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_010_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_012
        description: LwStreams does not grant read-write permission to allocated buffer and also does not set read-write permission attribute in reconciled attribute list
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application logic may fail when it tries to perform read-write operation on buffer
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_011_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_004
        description: LwStreams creates new buffer when not requested
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate buffers in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: N/A
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_005
        description: LwStreams allocate new buffer not confirming to buffer properties in provided reconciled attribute list
        # this failure mode also includes case where buffer is allocated confirming to buffer properties from some other reconciled attribute list
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may incorrectly interpret the buffer and lead to corruption or unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_009
        description: LwStreams allocates buffer aligned to 64KB when Display engine is not present in the EngineList array and other engines do not demand 64KB alignment.
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may not be able to allocate more buffers due to resource exhaustion
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_013
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_012_OBJECT_ALLOCATION
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4789164)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_003
        description: LwStreams returns previously allocated buffer than allocating a new buffer
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application will use existing buffer to perform subsequent operations which were intended to be performed on new buffer. This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_OBJECT_ALLOCATION
            description: Internal failure in LwStreams
            na: This failure mode cause is prevented by design (GID-SWAD-4789164).

      - id: LWSCIBUF_FUNC_OBJECT_ALLOCATION_FM_002
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679250, GID-REQ-5184537, GID-REQ-4679251)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION
    #21774307
    requirements:
      - 18838551
      - 18838554
      - 18838557
      - 18838560
    description: Object duplication

    failure_modes:
      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_001
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_OBJECT_DUPLICATION
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_004
        description: LwStreams modified resources bound to input buffer handle
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may see unpredicted behavior on subsequent operations on bound resources.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_OBJECT_DUPLICATION
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4789166, GID-SWAD-4789167).

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_005
        description:
          When duplicating object with same access permissions, LwStreams returns new buffer handle not associated with same reconciled list as input buffer handle.
          When duplicating object with different access permissions, LwStreams returns new buffer handle not associated with
          cloned attribute list of reconciled attribute list associated with input buffer handle.
        # this failure mode also includes case where it is associated with a different reconciled list or does not associated a reconciled list at all
        # this also failure mode when LwStreams doesn't bind attribute list when actual perm and buffer parameters are same as reconciled list bounded to input buffer handle
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may see unpredicted behavior when it tried to retrieve reconciled associated with duplicated buffer handle
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_OBJECT_DUPLICATION
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4789166, GID-SWAD-4789167).

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_006
        description: LwStreams returns new buffer handle with access permission other than input buffer handle when no access permission is provided
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application maybe able to perform additional access operations on duplicate buffer which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_OBJECT_DUPLICATION
            description: Internal failure in LwStreams
            # LwStreams fails to read access permission of input buffer handle
            # LwStreams misinterprets access permission of input buffer handle
            na: Prevented by design (GID-SWAD-4789166, GID-SWAD-4789167).

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_007
        description: LwStreams failed to validate input access permissions
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: LwStreams will request memory to be duplicated with invalid permissions and lead error code being returned to application.
        external_effects: Application may get duplicate handle with greater access permission or lesser access permission than requested which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_OBJECT_DUPLICATION
            description: Internal failure in LwStreams
            # LwStreams fails to read access permission of input access permissions
            # LwStreams misinterprets access permission of input access permissions
            na: Prevented by design (GID-SWAD-4789166, GID-SWAD-4789167).

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_008
        description: LwStreams binds reconciled attribute list when actualPerm is not same as duplicate handle when contents of reconciled list doesn't match duplicate buffer handle
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may interpret the duplicate buffer handle differently than intended and may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_OBJECT_DUPLICATION
            description: Internal failure in LwStreams
            # LwStreams fails to read access permission of input access permissions
            # LwStreams misinterprets access permission of input access permissions
            na: Prevented by design (GID-SWAD-4789166, GID-SWAD-4789167).

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_009
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_OBJECT_DUPLICATION
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4789166, GID-SWAD-4789167)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_010
        description: LwStreams creates duplicate buffer when not requested
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate buffers in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_010_OBJECT_DUPLICATION
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4789166, GID-SWAD-4789167).

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_003
        description: LwStreams returns previously allocated buffer handle rather than allocating a new buffer handle
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application will use existing buffer handle to perform subsequent operations which were intended to be performed on new buffer. This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_OBJECT_DUPLICATION
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4789166, GID-SWAD-4789167).

      - id: LWSCIBUF_FUNC_OBJECT_DUPLICATION_FM_002
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679252, GID-REQ-4679253, GID-REQ-4679254, GID-REQ-4694347)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE
    #21774314
    requirements:
      - 18838581
    description: Create object from memory handle

    failure_modes:
      - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE_FM_001
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-4679261)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_CREATE_OBJECT_FROM_MEMORY_HANDLE
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE_FM_004
        description: LwStreams create buffer when not requested
        impact: ASIL-B (GID-REQ-4679261)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate buffers in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: N/A
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_CREATE_OBJECT_FROM_MEMORY_HANDLE
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4789180).

      - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE_FM_005
        description: LwStreams allocate new buffer which does not have access permission equal to access permission in input reconciled attribute list
        impact: ASIL-B (GID-REQ-4679261)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_332
        local_effects: None
        external_effects: Application may try to access newly created buffer with permission it doesn't have and lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_CREATE_OBJECT_FROM_MEMORY_HANDLE
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4789180).

      - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE_FM_006
        description: LwStreams returns new buffer handle not associated with input reconciled attribute list
        # this failure mode also includes case where it is associated with a different reconciled list or does not associated a reconciled list at all
        impact: ASIL-B (GID-REQ-4679261)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_332
        local_effects: None
        external_effects: Application may see unpredicted behavior when it tried to retrieve reconciled associated with duplicated buffer handle
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_CREATE_OBJECT_FROM_MEMORY_HANDLE
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4789180).

      - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE_FM_007
        description: LwStreams returns new buffer which is not described by input memory handle, offset, length
        impact: ASIL-B (GID-REQ-4679261)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_332
        local_effects: None
        external_effects: Application logic which is based on input memory handle, offset and length may fail and lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_CREATE_OBJECT_FROM_MEMORY_HANDLE
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4789180).

      - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE_FM_008
        impact: ASIL-B (GID-REQ-4679261)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_CREATE_OBJECT_FROM_MEMORY_HANDLE
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4789180)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE_FM_003
        description: LwStreams returns previously allocated buffer instead of allocating a new buffer
        impact: ASIL-B (GID-REQ-4679261)
        class: Incorrect value
        heavens_ref: T3_LwStreams_332
        local_effects: None
        external_effects:
          Application will use existing buffer object to perform subsequent operations which were intended to be performed on new buffer.
          This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_CREATE_OBJECT_FROM_MEMORY_HANDLE
            description: Internal failure in LwStreams
            # implausible error LwStreams doesn't keep track of buffer handles allocated previously
            na: Prevented by design (GID-SWAD-4789180).

      - id: LWSCIBUF_FUNC_CREATE_OBJECT_FROM_MEMORY_HANDLE_FM_002
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679261)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT
    #21774317
    requirements:
      - 18838476
      - 18838479
      - 18838482
    description: Attribute list transport

    failure_modes:
      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_001
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_ATTRIBUTE_LIST_TRANSPORT
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_015
        description: LwStreams imports reconciled attribute list when mandatory keys are not present in provided export descriptor.
        # Mandatory keys in general attribute as well as buffer type specific attributes.
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application when reading mandatory keys from reconciled attribute list will get garbage value.
          Application unable to continue or may see unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_014_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790252, GID-SWAD-4790259, GID-SWAD-4790258, GID-SWAD-4790251, GID-SWAD-4790256, GID-SWAD-4790257).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_007
        description: LwStreams returns attribute list not bound to provided module
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application logic may fail which depends on attribute list being bounded to input module which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790252, GID-SWAD-4790259, GID-SWAD-4790258).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_008
        description: LwStreams failed to validate reconciliation status of input export descriptor.
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application will get unreconciled attribute list when it was expecting reconciled attribute list.
          Application will get reconciled attribute list when it was expecting unreconciled attribute list.
          Application may not be able to perform subsequent operations on imported attribute list which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790259, GID-SWAD-4790258, GID-SWAD-4790252, GID-SWAD-4790251, GID-SWAD-4790256, GID-SWAD-4790257).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_009
        description: LwStreams failed to validate reconciliation status of input attribute list.
        class: Functionality missing
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application will get export descriptor which client may not be able to import on other side, leading to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790256, GID-SWAD-4790257).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_011
        description: LwStreams successfully imports reconciled attribute list which does not satisfy reconciliation validation requirement against provided unreconciled attribute list.
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Functionality missing
        local_effects: None
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        external_effects: Application will interpret buffer incorrectly using reconciled attribute list which may lead to data corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_010_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790252, GID-SWAD-4790259).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_004
        description: LwStreams exports attribute list or imports attribute list when not requested
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4790251, GID-SWAD-4790252, GID-SWAD-4790256, GID-SWAD-4790257, GID-SWAD-4790259, GID-SWAD-4790258).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_005
        description: LwStreams does not return a export descriptor for provided attribute list
        # This includes export descriptor which is for other attribute list
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may see unpredicted behavior on subsequent operations on export descriptor.
          Application may import export descriptor which returns different attribute list than the one exporter intended to export.
          As a result, Application may interpret buffer incorrectly leading to buffer corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790251, GID-SWAD-4790256, GID-SWAD-4790257).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_006
        description: LwStreams returns export descriptor which is not transferable via provided LwSciIpc channel.
        # This includes export descriptor which is transferable via other LwSciIpc channel
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may see unpredicted behavior when it tries to transfer export descriptor via LwSciIpc channel.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actuibs: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790251, GID-SWAD-4790256, GID-SWAD-4790257) and verified by testing (GID-TEST-4911873, GID-TEST-4911874, GID-TEST-4911875).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_014
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_013_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4790252, GID-SWAD-4790259, GID-SWAD-4790258, GID-SWAD-4790251, GID-SWAD-4790256, GID-SWAD-4790257)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_010
        description: LwStreams returns attribute list that does not represent export descriptor
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may be able to import this incorrect export descriptor and get an incorrect attribute list.
          Application may perform subsequent operations on this incorrect attribute list will lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790256, GID-SWAD-4790257).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_012
        description: LwStreams successfully imports reconciled attribute list with incorrect actual permission or cpu access values.
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application will incorrectly interpret buffer using reconciled attribute list which may lead to data corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_011_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790259, GID-SWAD-4790252).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_013
        description: LwStreams successfully imports unreconciled attribute list without checking reconciliation type
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may fail reconciliation when trying to reconcile on imported unreconciled attribute list
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_012_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790252, GID-SWAD-4790259, GID-SWAD-4790258).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_016
        description: LwStreams returns invalid attribute list which does not represent correct attribute list.
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may not be able to perform subsequent operations on this invalid attribute list. Application won't be able to continue.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_015_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790256, GID-SWAD-4790257).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_003
        description:
          LwStreams returns previously allocated export descriptor instead of allocating a new export descriptor when exporting attribute list.
          LwStreams returns previously allocated attribute list instead of allocating a new attribute list when importing attribute list.
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application will use existing export descriptor to perform subsequent operations which were intended to be performed on new export descriptor.
          Application will use existing attribute list to perform subsequent operations which were intended to be performed on new attribute list.
          This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_ATTRIBUTE_LIST_TRANSPORT
            description: Internal failure in LwStreams
            # implausible error LwStreams doesn't keep track of export descriptor allocated previously
            # implausible error LwStreams doesn't keep track of attribute list allocated previously
            na: Prevented by design (GID-SWAD-4790251, GID-SWAD-4790252, GID-SWAD-4790256, GID-SWAD-4790257, GID-SWAD-4790259, GID-SWAD-4790258).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_TRANSPORT_FM_002
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679214, GID-REQ-4691267, GID-REQ-4691268)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT
    #21774319
    requirements:
      - 18838593
      - 18838599
      - 18838596
      - 18838602
    description: Object transport

    failure_modes:
      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_001
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_OBJECT_TRANSPORT
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_005
        description: LwStreams returns new object export descriptor which is not transferable via provided LwSciIpc channel
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application will use try to transfer the export descriptor via LwSciIpc channel which may lead to unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            # LwStreams creates a export descriptor of incorrect size which cannot be transferred by IPC
            # LwStreams sets incorrect value in IPC table
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_006
        description: LwStreams failed to validate access permissions are granted according to buffer export permissions.
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may be able to import the buffer with incorrect permissions which may lead to buffer corruption and unpredicted behavior.
          Application may not be able to import the export descriptor because of import buffer validation.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            # LwStreams may not validate access permissions
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_008
        description: LwStreams does not set access permissions in export descriptor even when all access permission conditions are satisfied when exporting buffer object.
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application won't be able to import the export descriptor and won't enter run-time state.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            # LwStreams may not validate access permissions
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_010
        description: LwStreams does not bind to provided reconciled attribute list
        # binds to some other reconciled attribute list
        # does not bind even when all conditions are satisfied
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may not be able to get reconciled attribute list buffer object which may lead to unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            # LwStreams does not take reference to provided reconciled attribute list
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_011
        description: LwStreams grants access permission provided in export descriptor without validation of permissions
        # the provided access permissions are greater than the access permissions contained in the descriptor.
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may be able to import the buffer with incorrect permissions which may lead to buffer corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_010_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            # LwStreams forgets to validate access permission from export descriptor against input reconciled attribute list
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_012
        description: LwStreams binds to provided reconciled attribute list without validating the contents of provided attribute list
        # binds when ActualPerm attribute value is not same as the access permissions contained in the export descriptor.
        # binds when Values of all other attributes other than ActualPerm are not same as that of the provided reconciled attribute list.
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: LwStream clients may misinterpret the buffer based on associated reconciled attribute list. This may lead to buffer corruptions and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_011_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            # LwStreams does not validate size, alignment, offset of buffer from export descriptor against reconciled attribute list
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_004
        description: LwStreams exports or imports buffer when not requested
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_007
        description: LwStreams returns new buffer object even when access permissions are not granted to new buffer object.
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may be able to import the buffer with incorrect permissions which may lead to buffer corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            # LwStreams may not validate access permissions
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_013
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_012_OBJECT_TRANSPORT
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_014
        description: LwStreams creates buffer object associated with wrong memory handle.
        # buffer object is associated with other LwRm handle
        # buffer object is not associated with LwRm handle at all
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: LwStream clients may misinterpret the buffer handle based on associated with buffer object. This may lead to buffer corruptions and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_013_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_015
        description: LwStreams returns buffer object imported from export descriptor which is invalid.
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application won't be able to perform subsequent operations on buffer object. Applica not able to continue.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_014_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_009
        description: LwStreams sets incorrect access permissions in export descriptor
        # does not set access permissions to MaxRequestedPerm of the LwSciIpc channel's Peer, even when no access permissions are provided
        # sets access permission when MaxRequestedPerm of LwSciIpc channel's peer is greater than the provided permissions
        # sets access permission when provided permissions are greater than the permissions of the provided buffer handle.
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may be able to import the buffer with incorrect permissions which may lead to buffer corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            # LwStreams sets permissions without validation
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_003
        description:
          LwStreams returns previously allocated export descriptor instead of allocating a new export descriptor when exporting buffer object.
          LwStreams returns previously allocated buffer object instead of allocating a new buffer object when importing buffer object.
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application will use existing export descriptor to perform subsequent operations which were intended to be performed on new export descriptor.
          Application will use existing buffer object to perform subsequent operations which were intended to be performed on new buffer object.
          This may lead to application corruption, unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_OBJECT_TRANSPORT
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4790254, GID-SWAD-4790255).

      - id: LWSCIBUF_FUNC_OBJECT_TRANSPORT_FM_002
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679265, GID-REQ-4691323, GID-REQ-4679266, GID-REQ-4691324)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION
    #21774287
    requirements:
      - 18838527
      - 18838503
      - 17822454
      - 20093805
      - 20208009
      - 17822370
      - 18838470
      - 20208039
      - 18838500
      - 18838518
      - 20246160
      - 18838521
      - 18838539
      - 20208006
      - 20207997
      - 18838533
      - 13561523
      - 21898423
      - 21916858
      - 21898439
      - 18838536
      - 18838530
      - 20208048
      - 13561509
      - 13561535
      - 18838512
      - 18838509
      - 18838506
    description: Reconciled input unreconciled attribute list to create new reconciled attribute list.

    failure_modes:
      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_001
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_ATTRIBUTE_LIST_RECONCILIATION
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_004
        description: LwStreams modified input unreconciled attribute list.
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may see unpredicted behavior on subsequent operations on input unreconciled attribute lists
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_ATTRIBUTE_LIST_RECONCILIATION
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4788464).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_008
        description: LwStreams performs reconciliation when not requested
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        class: Functionality unexpected
        local_effects: LwStreams won't be able to allocate memory in subsequent operations
        external_effects: Resource exhaustion, leading to subsequent memory allocation failure
        heavens_ref: N/A
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_007_ATTRIBUTE_LIST_RECONCILIATION
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4788464).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_009
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        description: *shared_description_wrong_write
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_008_ATTRIBUTE_LIST_RECONCILIATION
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4788464)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_010
        description: LwStreams does not perform reconciliation of attribute list functionality atomically.
        # LwStreams does not lock input unreconciled attribute list. This may lead to other entity changing the values or freeing the attribute list.
        class: Functionality unexpected
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may use the reconciled attribute list to allocate buffer which may not be according to the intended attributes specified in the input unreconciled attribute lists.
          Peers which contributed the unreconciled attribute lists may interpret the buffer incorrectly leading to corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_009_ATTRIBUTE_LIST_RECONCILIATION
            description: Internal failure in LwStreams
            # LwStreams does not lock list or input unreconciled attribute list. This may lead to other entity changing the values or freeing the attribute list.
            na: Prevented by design (GID-SWAD-4788464).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_003
        description: LwStreams returns previously allocated reconciled attribute list.
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application will use existing reconciled attribute list to allocate buffer which may not be sufficient for clients use.
          When client will try to use this buffer it may lead to data corruption and unexpected behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_ATTRIBUTE_LIST_RECONCILIATION
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4788464).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_005
        description: LwStreams returns reconciled attribute list with incorrect values even when all reconciliation conditions are satisfied
        # LwStreams reconciliation policy failed to yield value even when policy passed
        # LwStreams failed to set default values
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may allocate the buffer using incorrect values which may lead to data corruption and unpredicted behavior.
          Application may allocate the buffer correct but may interpret it incorrectly using data-type specific values from incorrect reconciled attribute list.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_ATTRIBUTE_LIST_RECONCILIATION
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4788464).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_006
        description:
          LwStreams returns reconciled attribute list with wrong default values.
          LwStreams sets default values for attributes which are filled by the application.
          LwStreams does not set default values at all.
        # Wrong default value for alignment, memory domain, image count
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may allocate the buffer using incorrect values which may lead to data corruption and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_ATTRIBUTE_LIST_RECONCILIATION
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4788464).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_007
        description: LwStreams returns new reconciled attribute list without validating "presence of attribute" or "accessibility of attribute"
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects: Application may allocate the buffer using incorrect values from an incorrect reconciled attribute list which may lead to data corruption and unpredicted behavior
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_ATTRIBUTE_LIST_RECONCILIATION
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4788464).

      - id: LWSCIBUF_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_002
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-4679235, GID-REQ-4679224, GID-REQ-4679218, GID-REQ-5184537, GID-REQ-5194539, GID-REQ-4679189, GID-REQ-4679212, GID-REQ-5194540, GID-REQ-4679221, GID-REQ-4679229, GID-REQ-5195181, GID-REQ-4679230, GID-REQ-4679243, GID-REQ-5194538, GID-REQ-5194537, GID-REQ-4679237, GID-REQ-4679238, GID-REQ-5420432, GID-REQ-5423158, GID-REQ-5420433, GID-REQ-4679242, GID-REQ-4679236, GID-REQ-5194541, GID-REQ-4679231, GID-REQ-4679244, GID-REQ-4691273, GID-REQ-4679222, GID-REQ-4679225)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

  #================================================================================

  - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST
    #21774296
    description: Validation of reconciled attribute list
    requirements:
      - 21649065
      - 21816382
      - 21649097
      - 21816419
      - 21678110
      - 21685034
      - 21816486
      - 21648966
      - 21648998
      - 21816857
      - 21648915

    failure_modes:
      - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST_FM_001
        description: Validation passes when mandatory keys are not present from input reconciled attribute list.
        # Mandatory keys in general attribute as we as buffer type specific attributes.
        impact: ASIL-B (GID-REQ-5362873, GID-REQ-5411280, GID-REQ-5362884, GID-REQ-5411285, GID-REQ-5378487, GID-REQ-5382877, GID-REQ-5362863, GID-REQ-5362865, GID-REQ-5411331, GID-REQ-5362858)
        class: Functionality missing
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application when reading mandatory keys from reconciled attribute list will get garbage value.
          Application unable to continue or may see unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_001_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4788465).

      - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST_FM_003
        description: LwStreams reports an error without justification (e.g., reports error to Safety Services)
        impact: ASIL-B (GID-REQ-5362873, GID-REQ-5411280, GID-REQ-5362884, GID-REQ-5411285, GID-REQ-5378487, GID-REQ-5382877, GID-REQ-5362863, GID-REQ-5362865, GID-REQ-5411331, GID-REQ-5362858)
        class: Functionality missing
        heavens_ref: N/A
        local_effects: None
        external_effects: Application unable to continue
        evaluation: *shared_evaluation_error_without_justification
        causes:
          - id: LWSTREAMS_BUF_CAUSE_001_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST
            description: LwStreams returns an error due to internal failure.
            heavens_ref: N/A
            measures:
              - LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR

      - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST_FM_005
        description: LwStreams validates reconciled attribute list when not required
        impact: ASIL-B (GID-REQ-5362873, GID-REQ-5411280, GID-REQ-5362884, GID-REQ-5411285, GID-REQ-5378487, GID-REQ-5382877, GID-REQ-5362863, GID-REQ-5362865, GID-REQ-5411331, GID-REQ-5362858)
        class: Functionality unexpected
        heavens_ref: N/A
        local_effects: LwStreams may frequently lock reconciled attribute list leading to degraded performance
        external_effects: Application may see degraded performance
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_003_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST
            description: Internal failure in LwStreams
            na:
              LwStreams is a userspace library which is ilwoked only by application calls.
              LwStreams is not a process to execute without intent of application.
              Prevented by design (GID-SWAD-4788465).

      - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST_FM_006
        description: *shared_description_wrong_write
        impact: ASIL-B (GID-REQ-5362873, GID-REQ-5411280, GID-REQ-5362884, GID-REQ-5411285, GID-REQ-5378487, GID-REQ-5382877, GID-REQ-5362863, GID-REQ-5362865, GID-REQ-5411331, GID-REQ-5362858)
        heavens_ref: N/A
        class: Functionality unexpected
        local_effects: *shared_local_effects_wrong_write
        external_effects: *shared_external_effects_wrong_write
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_004_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST
            description: Internal failure in LwStreams.
            na: Prevented by design (GID-SWAD-4788465)
        evaluation: *shared_evaluation_wrong_write

      - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST_FM_007
        description:
          LwStreams return successful validation without considering all input unreconciled attribute lists during validation
          or considers other unreconciled attribute list not provided by application.
        impact: ASIL-B (GID-REQ-5362873, GID-REQ-5411280, GID-REQ-5362884, GID-REQ-5411285, GID-REQ-5378487, GID-REQ-5382877, GID-REQ-5362863, GID-REQ-5362865, GID-REQ-5411331, GID-REQ-5362858)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may use the reconciled attribute to allocate buffer which may not be according to all unreconciled attribute list.
          Peers which contributed the unreconciled attribute lists may interpret the buffer incorrectly leading to corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_005_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4788465).

      - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST_FM_008
        description: LwStreams does not perform validation of reconciled attribute functionality atomically.
        # LwStreams does not lock reconciled attribute list or input unreconciled attribute list. This may lead to other entity changing the values or freeing the attribute list.
        impact: ASIL-B (GID-REQ-5362873, GID-REQ-5411280, GID-REQ-5362884, GID-REQ-5411285, GID-REQ-5378487, GID-REQ-5382877, GID-REQ-5362863, GID-REQ-5362865, GID-REQ-5411331, GID-REQ-5362858)
        class: Functionality unexpected
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may use the reconciled attribute to allocate buffer which may not be according to all unreconciled attribute list.
          Peers which contributed the unreconciled attribute lists may interpret the buffer incorrectly leading to corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_006_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST
            description: Internal failure in LwStreams
            # LwStreams does not lock reconciled attribute list or input unreconciled attribute list. This may lead to other entity changing the values or freeing the attribute list.
            na: Prevented by design (GID-SWAD-4788465).

      - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST_FM_002
        description: Validation passes when validation policy indicates inconsistency
        # This includes if any of the policy indicates inconsistency
        # We return success when some of the policies are not satisfied
        impact: ASIL-B (GID-REQ-5362873, GID-REQ-5411280, GID-REQ-5362884, GID-REQ-5411285, GID-REQ-5378487, GID-REQ-5382877, GID-REQ-5362863, GID-REQ-5362865, GID-REQ-5411331, GID-REQ-5362858)
        class: Incorrect value
        heavens_ref: T3_LwStreams_259, T3_LwStreams_332
        local_effects: None
        external_effects:
          Application may use the reconciled attribute to allocate buffer which may not be according to all unreconciled attribute list.
          Peers which contributed the unreconciled attribute lists may interpret the buffer incorrectly leading to corruption and unpredicted behavior.
        evaluation:
          effectiveness: High
          justification: Failure mode causes are prevented by design and verified by testing.
          actions: N/A
        causes:
          - id: LWSTREAMS_BUF_CAUSE_NA_002_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST
            description: Internal failure in LwStreams
            na: Prevented by design (GID-SWAD-4788465).

      - id: LWSCIBUF_FUNC_VALIDATION_OF_RECONCILED_ATTRIBUTE_LIST_FM_004
        description: LwStreams hangs or takes too long
        impact: ASIL-B (GID-REQ-5362873, GID-REQ-5411280, GID-REQ-5362884, GID-REQ-5411285, GID-REQ-5378487, GID-REQ-5382877, GID-REQ-5362863, GID-REQ-5362865, GID-REQ-5411331, GID-REQ-5362858)
        class: Incorrect timing
        heavens_ref: N/A
        local_effects: LwStreams may not return exelwtion control to the application
        external_effects: Application may hang
        evaluation: *shared_evaluation_hang
        causes:
          - LWSTREAMS_BUF_CAUSE_005

#================================================================================

# Globally reusable measures
measures:
  - id: LWSCIBUF_MEAS_0001_ERROR_HANDLING_ARR
    description: >-
      DRIVE OS external ARR for error handling.

      The user of DRIVE OS must ensure that any errors reported by Init APIs
      cause the application to prevent transition to normal operation.
    type: Detection and Reporting of Failure Mode
    refs:
      - "DOS_RES_105" # link to DRIVE OS ARR
  - id: LWSCIBUF_MEAS_0002_WATCHDOG_MONITORING
    description: >-
      DRIVE OS watchdog monitoring
    type: Detection and Reporting of Failure Mode
    refs:
      - DOS_ASU_010
  - id: LWSCIBUF_MEAS_0003_ZERO_OUT_MEMORY
    description: >-
      LwStreams overwrites memory with 0s before freeing.
      Magic ID stored inside LwStreams data structures is overwritten by 0x00
      before freeing.
      LwStreams validates if Magic ID is present in data structures before
      performing operations on them.
    type: Detection and Reporting of Failure Mode
    refs:
      - 22034187

# Globally reusable causes
causes:
  - id: LWSTREAMS_BUF_CAUSE_005
    # Internal failure leading to some hang
    description: >-
      Internal failure in LwStreams.
    heavens_ref: N/A
    measures:
      - LWSCIBUF_MEAS_0002_WATCHDOG_MONITORING
  - id: LWSTREAMS_BUF_CAUSE_NA_001
    description: >-
      Internal failure in LwStreams
    na: >-
      The used software verification methods effectively eliminate
      potential software defects related to missing functionality. The
      failure mode is listed for completeness.

  - id: LWSTREAMS_BUF_SHARED_CAUSE_001
    description: Memory freed by LwStreams is still accessible by LwStreams or application.
    heavens_ref: N/A
    measures:
      - LWSCIBUF_MEAS_0003_ZERO_OUT_MEMORY
