#
# Copyright (c) 2021, LWPU CORPORATION.  All rights reserved.
#
# LWPU CORPORATION and its licensors retain all intellectual property
# and proprietary rights in and to this software, related documentation
# and any modifications thereto.  Any use, reproduction, disclosure or
# distribution of this software and related documentation without an express
# license agreement from LWPU CORPORATION is strictly prohibited.
#
doc_id: SWE-LWSCISYNC-002-SWFMEA-WKSHT
reviewed_in:
  - "https://git-p4swmirror.lwpu.com/r/145155"
  - "https://git-p4swmirror.lwpu.com/r/144999"
  - "https://git-p4swmirror.lwpu.com/r/145880"
  - "https://git-p4swmirror.lwpu.com/r/145882"
  - "https://git-p4swmirror.lwpu.com/r/145883"
  - "https://git-p4swmirror.lwpu.com/r/145884"
  - "https://git-p4swmirror.lwpu.com/r/145886"
  - "https://git-p4swmirror.lwpu.com/r/145889"
  - "https://git-p4swmirror.lwpu.com/r/145890"
  - "https://git-p4swmirror.lwpu.com/r/145891"
  - "https://git-p4swmirror.lwpu.com/r/145892"
  - "https://git-p4swmirror.lwpu.com/r/145893"
  - "https://git-p4swmirror.lwpu.com/r/145894"
  - "https://git-p4swmirror.lwpu.com/r/145895"
  - "https://git-p4swmirror.lwpu.com/r/145896"
  - "https://git-p4swmirror.lwpu.com/r/145897"
  - "https://git-p4swmirror.lwpu.com/r/145898"
  - "https://git-p4swmirror.lwpu.com/r/146173"
  - "https://git-p4swmirror.lwpu.com/r/146174"
  - "https://cr.lwpu.com/ui#review:id=183244"
  - "https://git-p4swmirror.lwpu.com/r/147638"
  - "https://git-p4swmirror.lwpu.com/r/147867"
  - "https://git-p4swmirror.lwpu.com/r/147962"
  - "https://git-p4swmirror.lwpu.com/r/148147"
  - "https://git-p4swmirror.lwpu.com/r/148757"
  - "https://git-p4swmirror.lwpu.com/r/153481"
  - "https://git-p4swmirror.lwpu.com/r/156113"
  - "https://git-p4swmirror.lwpu.com/r/156329"
  - "https://git-p4swmirror.lwpu.com/r/156373"
  - "https://git-p4swmirror.lwpu.com/r/156432"
  - "https://git-p4swmirror.lwpu.com/r/156587"
  - "https://git-p4swmirror.lwpu.com/r/156573"
state: Released for Review
history:
  - author: mpurohit@lwpu.com
    date: Aug 19, 2021
    comment: Initial commit
  - author: mpurohit@lwpu.com
    date: Sep 7, 2021
    comment: Added Threat IDs
  - author: rkotha@lwpu.com
    date: Oct 20, 2021
    comment: updated testing method
  - author: dhalas@lwpu.com
    date: Nov 22, 2021
    comment: updated effectiveness
  - author: mpurohit@lwpu.com
    date: Nov 22, 2021
    comment: updated effectiveness
  - author: mpurohit@lwpu.com
    date: Nov 25, 2021
    comment: fix fmea finding
  - author: rkotha@lwpu.com
    date: Nov 29, 2021
    comment: Addressed confirmation review findings
input_work_products:
  - title: Software Requirement Specification
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/143331/list?projectId=22182
    rev: "LwStreams requirements for 5.2 M6a - 06/07/2021"
    purpose: Work product to identify functionalities, causes, local and external failure mode effects
  - title: Software Architecture and Design
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/143466/list?projectId=22182
    rev: "[T3 LwStreams][SWADS][5.2 M6a][V3]: Baseline"
    purpose: Work product to identify functionalities, causes, local and external failure mode effects
  - title: Boundary Diagram
    location: https://lwpu.jamacloud.com/perspective.req#/items/18839103?projectId=22182 (Version 17)
    rev: Sep 14, 2021
    purpose: Reference to SWAD section containing LwStreams boundary diagram
  - title: Sub-architecture Diagram
    location: https://lwpu.jamacloud.com/perspective.req#/items/18840033?projectId=22182 (Version 29)
    rev: Sep 14, 2021
    purpose: Reference to SWAD section containing LwStreams sub-architecture diagram
  - title: FMEA/Safety Plan
    location: https://p4viewer/get///sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/01_Project_Management/SWE-LWSTREAMS-002-SP.docx
    rev: Nov 23, 2021
    purpose: Reference to LwStreams Safety Plan
    cl: 30690141
  - title: LwStreams FMEA Functionality Map table
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/142467/list?projectId=22182
    rev: May 23, 2021
    purpose: Reference to LwStreams FMEA functionality mapping table
  - title: LwStreams heavens sheet for Init APIs
    cl: 30359060
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/03_Architectural_Design/Security/LwStreams_Heaven_init.xlsx?revision=2
    rev: Aug 30, 2021
    purpose: Heavens sheet for threat ID reference
  - title: LwStreams heavens sheet for Runtime APIs
    cl: 30359060
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/03_Architectural_Design/Security/LwStreams_Heaven_runtime.xlsx?revision=2
    rev: Aug 30, 2021
    purpose: Heavens sheet for threat ID reference
references:
  - title: "LwStreams FMEA Development Guidelines"
    cl: 30277502
    location: https://p4viewer/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/08_Safety_Analysis/SWE-LWSTREAMS-040-DG.docx?revision=13
    rev: Aug 9, 2021
    purpose: Process guidance for performing FMEAs
  - title: "SW FMEA Process Guide"
    cl: 30277502
    location: https://p4viewer.lwpu.com/get/sw/embedded/docs/admin/process/PLC/SWE-SAFETY-005-SWFMEA.docx?revision=17
    rev: Dec 11, 2020
    purpose: Process guidance for performing FMEAs
  - title: DRIVE OS 5.2 FMEA and DFA Tailoring
    cl: 30144530
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/Program_Level_WPs/01_Project_Management/SWE-DRIVE-114-SWTLR.docx?revision=2
    rev: Jul 1, 2021
    purpose: Process guidance for performing FMEAs
RASIC:
  responsible: mpurohit@lwpu.com
  approve: pjayakumar@lwpu.com
  support:
    - dhalas@lwpu.com
    - hugol@lwpu.com
  inform:
    - dshikhare@lwpu.com
    - deveshg@lwpu.com
    - dkamurthy@lwpu.com
    - aparnad@lwpu.com
  consult: dhalas@lwpu.com
  review:
    - dhalas@lwpu.com
    - hugol@lwpu.com
    - pjayakumar@lwpu.com

functions:
- id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING
  description: Object transporting
  requirements:
  - 18838818
  - 18838821
  - 18838824
  - 18838830
  - 18838833
  - 18838836
  - 18838839
  - 18838974
  failure_modes:
  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_001
    description: >-
      LwStreams returns an error without justification (does not create an object export descriptor or does not create a new LwSciSyncObj)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_001
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: &shared_na_evaluation_unjust_error_notests
      effectiveness: High
      justification: Interface specification guarantees only errors listed are returned.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_003
    description: >-
      LwStreams creates and populates an export descriptor without permissions.
    class: Functionality missing
    local_effects: None
    external_effects: The resulting export descriptor has no permissions which are necessary for creating an LwScSync Object handle during import.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_002
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686549, GID-SWUD-4686554)
    evaluation:
      effectiveness: High
      justification: Interface specification mentions permissions validation and substituting the AccessPerm.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_006
    description: >-
      LwStreams does not set permissions in the resulting object.
    class: Functionality missing
    local_effects: The resulting LwSciSync Object handle is invalid as it does not have permissions set.
    external_effects: Unexpected behavior from LwStreams.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_003
        description: >-
          Internal failure in LwSciSync.
        na: The design (GID-SWUD-4686550) ensures that permission is set in resulting object.
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_008
    description: >-
      LwStreams does not return failure in the case of permissions validation on object import and instead creates an LwSciSync Object handle with incorrect permissions.
    class: Functionality missing
    local_effects: None
    external_effects: The resulting export descriptor has bigger permissions than the user wanted OR the resulting export descriptor has smaller permissions than what the importer expects.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_004
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686550, GID-SWUD-4686556) # SWUD spec of object import 18844713, 18844731
    evaluation:
      effectiveness: High
      justification: Interface specification in SWUD mentions the validation.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_011
    description: >-
      LwStreams creates and populates an output LwSciSync Object handle despite the input export descriptor being malformed (it does not match any exported descriptor that LwStreams could have created).
    class: Functionality unexpected
    local_effects: Corruption of LwStreams.
    external_effects: Unexpected behavior from LwStreams
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_011
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_003
    evaluation:
      effectiveness: High
      justification: The safety requirement is saying the exact negation of this failure mode.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_012
    description: >-
      LwStreams allocates and populates an imported LwSciSync Object handle when not requested.
    class: Functionality unexpected
    local_effects: LwStreams memory corruption
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_401
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4802837, GID-SWAD-4802838, GID-SWAD-4802843, GID-SWAD-4802846)
    evaluation: &na_evaluation_when_not_requested
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_002
    description: >-
      LwStreams creates and populates an export descriptor although the result of the permission check forbids it.
    class: Functionality unexpected
    local_effects: None
    external_effects: The resulting export descriptor has bigger permissions than the user wanted OR the resulting export descriptor has smaller permissions than what the importer expects.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_005
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686549, GID-SWUD-4686554) # SWUD specs of object export 18844710, 18844725
    evaluation:
      effectiveness: High
      justification: Interface specification mentions permission validations and accompanying errors.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_013
    description: >-
      LwStreams writes memory not provided by application to write, or modifies input LwSciSync Object handle or imported export descriptor.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_351
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802837, GID-SWAD-4802838)
    evaluation: &shared_na_evaluation_wrong_write
      effectiveness: Medium
      justification: >-
        LwStreams does not maintain a record of previously created or
        allocated resources. As such, it only operates using data passed
        into the API function call.

        Thus, the only possibility for a write to be performed on memory
        that is not provided by the application is if some pointer
        arithmetic is not performed correctly, the wrong address is used
        as input to some operation, or some buffer/stack overflow.

        Lwrrently the verification of this doesn't happen explicitly. Thus
        the only verification is what is lwrrently performed as part of
        normal PLC processes (Code Review, Code Inspection, Testing, etc.).

        For egregious cases we would expect this to be caught during Code
        Review, if not Code Inspection. In other cases, the failure should
        be sufficiently deterministic since the operation would be
        stateless and thus can be detected via a verification test.

        The verification methods employed by our current tests only assert 
        that a result is written in the given output parameter, but not the
        absence of some other write during the API call.
        Also, other system level memory corruption will be analyzed in
        DriveOS FMEA.
      actions:
        - ref: https://lwbugs/200741303
          description: >-
            Set up builds with AddressSanitizer enabled and ensure that ASan
            doesn't report any errors
        - ref: https://lwbugs/200741303
          description: >-
            Run ASan builds with a fuzzing harness
        - ref: https://lwbugs/200741303
          description: >-
            Consider running the test application in a emulator or under a
            hypervisor and explicitly mapping expected allocations/accesses
            on a byte-level such that any other writes to some memory
            location outside of LwSciCommon-allocated memory or the memory
            provided as an input parameter cause a page fault or result in
            an error trap (potentially in combination with a fuzzer harness)

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_004
    description: >-
      LwStreams creates and populates an export descriptor with permissions different than importer's expected permissions when the user requested LwSciSyncAccessPerm_Auto or different than what the user requested.
    class: Incorrect value
    local_effects: None
    external_effects: The resulting export descriptor has bigger permissions than the user wanted OR the resulting export descriptor has smaller permissions than what the importer expects.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_006
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686549, GID-SWUD-4686554) # SWUD specs of object export 18844710, 18844725
    evaluation:
      effectiveness: High
      justification: Interface specification mentions permissions validation and substituting the AccessPerm.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_007
    description: >-
      LwStreams sets permissions in the resulting object differently than importer's expected permisssions if the user chose LwSciSyncAccessPerm_Auto or what user requested.
    class: Incorrect value
    local_effects: None
    external_effects: The resulting export descriptor has bigger permissions than the user wanted OR the resulting export descriptor has smaller permissions than what the importer expects.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_007
        description: Internal failure in LwSciSync
        na: Prevented by design (GID-SWUD-4686550, GID-SWUD-4686556) # specs of obj import 18844713, 18844731
    evaluation:
      effectiveness: High
      justification: The SWUD interface specifications state that the permissions will be written correctly.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_010
    description: >-
      LwStreams creates an LwSciSync Object handle not equivalent to the one that was exported.
    class: Incorrect value
    local_effects: None
    external_effects: Fences expire too early or too late; application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_008
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686550, GID-SWUD-4686556) # specs of obj import 18844713, 18844731
    evaluation:
      effectiveness: High
      justification: Interface specification describes how the new Object is recreated from the Transport Keys.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_015
    description: >-
      LwStreams returns invalid LwSciSync Object handle.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this handle.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_001
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686550, GID-SWUD-4686556) # specs of obj import 18844713, 18844731
    evaluation: &ilwalid_handle_evaluation
      effectiveness: High
      justification: Interface specification states that a valid handle is returned.

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_016
    description: >-
      LwStreams returns invalid LwSciSync Object export descriptor.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this descriptor.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_079
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686549, GID-SWUD-4686554) # SWUD specs of object export 18844710, 18844725
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_OBJECT_TRANSPORTING_FM_014
    description: >-
      LwStreams object export or import hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679413, GID-REQ-4679414, GID-REQ-4679415, GID-REQ-4679417, GID-REQ-4679418, GID-REQ-4679419, GID-REQ-4679420, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_014
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: &shared_evaluation_hang
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
        from the init phase to the runtime phase when an error is detected.
        As such, if an application checks the error code and observes an
        error, the safe state is maintained.


- id: LWSCISYNC_FUNC_OBJECT_DUPLICATION
  description: Object duplication
  requirements:
  - 18838698
  failure_modes:
  - id: LWSCISYNC_FUNC_OBJECT_DUPLICATION_FM_001
    description: >-
      LwStreams returns an error without justification (does not create and populate a duplicated LwSciSync Object handle
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679374)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_002
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_OBJECT_DUPLICATION_FM_003
    description: >-
      LwStreams creates a duplicate LwSciSync Object handle when not requested.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679374)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_402
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4802835)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_OBJECT_DUPLICATION_FM_004
    description: >-
      LwStreams creates more than one duplicate LwSciSync Object.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption. Resource exhaustion.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679374)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_018
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - id: LWSCISYNC_MEAS_033
            description: LwStreams creates only one duplicate.
            type: Prevention of Cause
            refs: [GID-SWUD-4686548] # object dup SWUD spec 18844704
    evaluation:
      effectiveness: High
      justification: The SWUD specification does not mention any other duplicate.

  - id: LWSCISYNC_FUNC_OBJECT_DUPLICATION_FM_005
    description: >-
      LwStreams writes memory not provided by application to write, or modifies input LwSciSync Object handle.
    class: Functionality unexpected
    local_effects: LwStreams corruption
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679374)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_352
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802835)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_OBJECT_DUPLICATION_FM_002
    description: >-
      LwStreams creates an LwSciSync Object handle that is not a duplicate of the input LwSciSync Object handle.
    class: Incorrect value
    local_effects: None
    external_effects: Fences expire too early or too late; application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679374)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_10
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686548) # SWUD spec of object dup 18844704
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that the resulting Object is a duplicate.

  - id: LWSCISYNC_FUNC_OBJECT_DUPLICATION_FM_007
    description: >-
      LwStreams returns invalid output LwSciSync Object handle
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this handle.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679374)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_79
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686548) # SWUD spec of object dup 18844704
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_OBJECT_DUPLICATION_FM_006
    description: >-
      LwStreams object duplication hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang.
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679374)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_020
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_FENCE_DUPLICATION
  description: Fence duplication
  requirements:
  - 18838683
  - 18838686
  failure_modes:
  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_001
    description: >-
      LwStreams returns an error without justification (does not populate the output fence with a duplicate)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_003
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_003
    description: >-
      LwStreams didn't clear the output fence before writing the duplicate.
    class: Functionality missing
    local_effects: None
    external_effects: An untracked reference on LwSciSync Object is left which leads to resource exhaustion.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_012
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686538) # fence dup swud spec 18844488
    evaluation:
      effectiveness: High
      justification: The SWUD specification states the output fence clearing.

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_002
    description: >-
      LwStreams associates the duplicate fence with an LwSciSync Object although it is cleared
    class: Functionality unexpected
    local_effects: Inability to recognize the fence as empty. Inability to take more references on that LwSciSync Object due to reaching max number of references.
    external_effects: Unexpected behavior when using the resulting fence. Resource leak later in the future.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_400
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686538) # fence dup swud spec 18844488
    evaluation:
      effectiveness: High
      justification: The SWUD specification states the output fence cleared if input fence is cleared, hence no object is associated with it.

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_005
    description: >-
      LwStreams populates the output fence although the memory of input and output fences overlap.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Unexpected behavior from LwStreams.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_013
        description: >-
          Internal failure in LwSciSync. User calling to LwStreams incorrectly.
        na: Prevented by design (GID-SWAD-4789687) # fence dup swad spec 18839718
    evaluation:
      effectiveness: High
      justification: Design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_007
    description: >-
      LwStreams creates more than one duplicate fence.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption. Resource exhaustion.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_027
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - id: LWSCISYNC_MEAS_036
            description: LwStreams creates only one duplicate fence.
            type: Prevention of Cause
            refs: [GID-SWUD-4686538] # fence dup SWUD spec 18844488
    evaluation:
      effectiveness: High
      justification: The SWUD specification only mentions one duplicate.

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_008
    description: >-
      LwStreams creates a duplicate fence when not requested.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption. Additional, unexpected reference on LwSciSync Object leading to potential resource exhaustion/leak.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_403
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4789687)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_009
    description: >-
      LwStreams writes memory not provided by application to write, or modifies input fence.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Waiting on the output fence might be too early/too late. Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_353
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4789687)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_004
    description: >-
      LwStreams populates the output fence with data that does not describe a duplicate of the input fence, including clearing it when the input was cleared.
    class: Incorrect value
    local_effects: None.
    external_effects: Waiting on the output fence might be too early/too late
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_014
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686538) # fence dup swud spec 18844488
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that the output fence is a duplicate.

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_011
    description: >-
      LwStreams populates the output fence with data that does not constitute a valid fence.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this fence.
    external_effects: Unpredictable behavior when using this fence.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_080
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686538) # fence dup swud spec 18844488
    evaluation:
      effectiveness: High
      justification: Interface specification states that a valid fence is written.

  - id: LWSCISYNC_FUNC_FENCE_DUPLICATION_FM_010
    description: >-
      LwStreams fence duplication hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679370, GID-REQ-4706825)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_030
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_TAKING_REFERENCE_ON_OBJECT
  description: Taking reference on object
  requirements:
  - 18838701
  failure_modes:
  - id: LWSCISYNC_FUNC_TAKING_REFERENCE_ON_OBJECT_FM_001
    description: >-
      LwStreams returns an error without justification (does not take a reference on the input LwSciSync Object handle)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679375)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_004
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_TAKING_REFERENCE_ON_OBJECT_FM_002
    description: >-
      LwStreams did not acquire a reference on the input LwSciSync Object handle.
    class: Functionality missing
    local_effects: LwSciSyncObj will be destroyed too soon, leading to undefined behavior when it should still be usable.
    external_effects: Unexpected behavior form LwStreams.
    heavens_ref: T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679375)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_016
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686559) # object ref SWUD spec 18844653
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that the reference count is incremented.

  - id: LWSCISYNC_FUNC_TAKING_REFERENCE_ON_OBJECT_FM_003
    description: >-
      LwStreams acquires more than one reference on the input LwSciSync Object handle
    class: Functionality unexpected
    local_effects: Inability to take more references due to reaching max number of references
    external_effects: Resource leak later.
    heavens_ref: T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679375)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_033
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - id: LWSCISYNC_MEAS_039
            description: LwStreams increments the reference count only once.
            type: Prevention of Cause
            refs: [GID-SWUD-4686559] # object ref SWUD spec 18844653
    evaluation:
      effectiveness: High
      justification: The SWUD specification does mention a single increment.

  - id: LWSCISYNC_FUNC_TAKING_REFERENCE_ON_OBJECT_FM_007
    description: >-
      LwStreams takes a reference on an LwSciSync Object handle when not requested
    class: Functionality unexpected
    local_effects: Inability to take more references due to reaching max number of references.
    external_effects: Resource leak later.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679375)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_404
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4803092)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_TAKING_REFERENCE_ON_OBJECT_FM_008
    description: >-
      LwStreams writes memory not provided by application to write, or modifies input LwSciSync Object in a way not related to reference tracking.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679375)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_354
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4803092)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_TAKING_REFERENCE_ON_OBJECT_FM_004
    description: >-
      LwStreams acquires a reference on another LwSciSync Object.
    class: Incorrect value
    local_effects: Inability to take more references due to reaching max number of references. The input LwSciSyncObj will be destroyed too soon, leading to undefined behavior when it should still be usable.
    external_effects: Resource leak later.
    heavens_ref: T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679375)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_017
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686559) # SWUD specs of object ref 18844653
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that the reference count of the input object is incremented.

  - id: LWSCISYNC_FUNC_TAKING_REFERENCE_ON_OBJECT_FM_009
    description: >-
      LwStreams taking a reference on an object hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679375)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_039
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_CHECKING_COMPATIBILITY
  description: Checking compatibility
  requirements:
  - 18838878
  failure_modes:
  - id: LWSCISYNC_FUNC_CHECKING_COMPATIBILITY_FM_001
    description: >-
      LwStreams returns an error without justification (does not return the compatibility status)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679433)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_005
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_CHECKING_COMPATIBILITY_FM_004
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679433)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_355
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798254)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_CHECKING_COMPATIBILITY_FM_002
    description: >-
      LwStreams returns compatibility status as incompatible although the versions are actually copmatible.
    class: Incorrect value
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679433)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_19
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by desing (GID-SWUD-4686545) # version compatibliity check SWUD spec 18844407
    evaluation:
      effectiveness: High
      justification: The SWUD specification does mention checking the conditions for compatibility.

  - id: LWSCISYNC_FUNC_CHECKING_COMPATIBILITY_FM_003
    description: >-
      LwStreams returns compatibility status as compatible although the versions are actually not compatible.
    class: Incorrect value
    local_effects: None
    external_effects: Unpredictable behavior due to applications expecting different behavior than expected.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679433)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_20
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686545) # lib version compatibility check swud spec 18844407
    evaluation:
      effectiveness: High
      justification: The SWUD specification does mention checking the conditions for compatibility.

  - id: LWSCISYNC_FUNC_CHECKING_COMPATIBILITY_FM_005
    description: >-
      LwStreams compatibility checking hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679433)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_044
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES
  description: Getting attributes
  requirements:
  - 18838650
  - 18838644
  - 18838641
  - 18838638
  - 18838665
  failure_modes:
  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_001
    description: >-
      LwStreams returns an error without justification (does not return the attribute values)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_006
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_002
    description: >-
      LwStreams does not return values for all the requested attributes.
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_022
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by desing (GID-SWUD-4685957, GID-SWUD-4685965, GID-SWUD-4685967, GID-SWUD-4685968) # getting attributes SWUD spec 18844215, 18844230, 18844236, 18844239
    evaluation:
      effectiveness: High
      justification: The SWUD specification simply mentions getting values for requested keys which means for all of them.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_008
    description: >-
      LwStreams does not return the slot count at all.
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_023
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685958) as LwStreams always returns something because it is returned via return value of the call. # get slot count SWUD spec 18844218
    evaluation:
      effectiveness: High
      justification: Prevented by the funtion signature.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_004
    description: >-
      LwStreams does return value for attributes whose accessibility does not encompass retrieval.
    class: Functionality unexpected
    local_effects: None.
    external_effects: None.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_024
        description: Internal failure in LwSciSync
        na: Impossible because all LwSciSync attributes encompass retrieval (18840165, 18840207)
    evaluation:
      effectiveness: High
      justification: Impossible failure mode.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_006
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_356
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798504, GID-SWAD-4798513, GID-SWAD-4798537, GID-SWAD-4798539)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_003
    description: >-
      LwStreams does return incorrect values.
    class: Incorrect value
    local_effects: None
    external_effects: Application behavior will not align with capabilities of LwSciSyncObj and expectations of other peers in the scheme.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_025
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by desing (GID-SWUD-4685957, GID-SWUD-4685965, GID-SWUD-4685967, GID-SWUD-4685968) # getting attributes SWUD spec 18844215, 18844230, 18844236, 18844239
    evaluation:
      effectiveness: High
      justification: The SWUD specification does return values of requested attributes.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_005
    description: >-
      LwStreams returned values from another list or from a wrong slot.
    class: Incorrect value
    local_effects: None
    external_effects: Application behavior will not align with capabilities of LwSciSyncObj and expectations of other peers in the scheme.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_026
        description: Internal failure in LwSciSync.
        na: Prevented by desing (GID-SWUD-4685957, GID-SWUD-4685965, GID-SWUD-4685967, GID-SWUD-4685968) # getting attributes SWUD spec 18844215, 18844230, 18844236, 18844239
    evaluation:
      effectiveness: High
      justification: The SWUD specification simply mentions getting values for requested keys which means for all of them.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_009
    description: >-
      LwStreams does return incorrect number of slots.
    class: Incorrect value
    local_effects: None
    external_effects: The value of slot count can be useful only for later checking attribute values in all the slots. If the returned value is lower than actual, the application is not going to be aware of all the values and might start behaving unexpectedly. If the value returned was too big, then LwStreams will return an error.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_027
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685958). # get slot count SWUD spec 18844218
    evaluation:
      effectiveness: High
      justification: The SWUD specification states returning the slot count.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FM_007
    description: >-
      LwStreams getting attribute values or slot count hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679358, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4691483, GID-REQ-4679364)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_051
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_OPENING_A_MODULE
  description: Opening a module
  requirements:
  - 18839001
  - 18838995
  - 18838779
  - 18839007
  - 18839013
  - 18839004
  - 18838998
  - 18839016
  failure_modes:
  - id: LWSCISYNC_FUNC_OPENING_A_MODULE_FM_003
    description: >-
      LwStreams returns an error without justification (does not create and return a new LwSciSyncModule).
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4797643, GID-REQ-4797628, GID-REQ-4679398, GID-REQ-4797645, GID-REQ-4797960, GID-REQ-4797644, GID-REQ-4797629, GID-REQ-4797971)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_007
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_OPENING_A_MODULE_FM_005
    description: >-
      LwStreams returns a new LwSciSyncModule when not requested.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory coruption. Resource exhaustion.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4797643, GID-REQ-4797628, GID-REQ-4679398, GID-REQ-4797645, GID-REQ-4797960, GID-REQ-4797644, GID-REQ-4797629, GID-REQ-4797971)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_405
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4796088)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_OPENING_A_MODULE_FM_006
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4797643, GID-REQ-4797628, GID-REQ-4679398, GID-REQ-4797645, GID-REQ-4797960, GID-REQ-4797644, GID-REQ-4797629, GID-REQ-4797971)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_357
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4796088)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_OPENING_A_MODULE_FM_004
    description: >-
      LwStreams returns an LwSciSyncModule that is already existing instead of a new one.
    class: Incorrect value
    local_effects: None
    external_effects: LwStreams will not return an error in subsequent calls when the user mixes usage of handles intended for different modules. It is not dangerous in itself might might hide a problem in application design.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4797643, GID-REQ-4797628, GID-REQ-4679398, GID-REQ-4797645, GID-REQ-4797960, GID-REQ-4797644, GID-REQ-4797629, GID-REQ-4797971)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_029
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4796088) # module open swad spec 18839724
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_OPENING_A_MODULE_FM_008
    description: >-
      LwStreams returns invalid LwSciSync Module handle.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this handle.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4797643, GID-REQ-4797628, GID-REQ-4679398, GID-REQ-4797645, GID-REQ-4797960, GID-REQ-4797644, GID-REQ-4797629, GID-REQ-4797971)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_081
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4796088) # module open swad spec 18839724
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_OPENING_A_MODULE_FM_007
    description: >-
      LwStreams opening a module or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4797643, GID-REQ-4797628, GID-REQ-4679398, GID-REQ-4797645, GID-REQ-4797960, GID-REQ-4797644, GID-REQ-4797629, GID-REQ-4797971)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_060
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_CLOSING_A_MODULE
  description: Closing a module
  requirements:
  - 18838887
  - 18838890
  failure_modes:
  - id: LWSCISYNC_FUNC_CLOSING_A_MODULE_FM_001
    description: >-
      The LwStreams does not close access to the module.
    class: Functionality missing
    local_effects: None
    external_effects: Resource leak. LwStreams clients may perform operations on closed module which may lead to unpredictable behavior.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691493, GID-REQ-4691494)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_030
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686534) # SWUD spec of module closing 18844599
    evaluation:
      effectiveness: High
      justification: The SWUD specification states closing LwSciSyncModule.

  - id: LWSCISYNC_FUNC_CLOSING_A_MODULE_FM_003
    description: >-
      The LwStreams does not destroy the module when the access to the module is closed and there are no LwSciSync resources still bound to it.
    class: Functionality missing
    local_effects: None
    external_effects: Resource leak
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691493, GID-REQ-4691494)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_031
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686534) # SWUD spec of module closing 18844599
    evaluation:
      effectiveness: High
      justification: The SWUD specification states destroying LwSciSyncModule.

  - id: LWSCISYNC_FUNC_CLOSING_A_MODULE_FM_009
    description: LwStreams allows access to the module after it is closed or destroyed
    class: Functionality missing
    local_effects: LwStreams accesses module after it is closed when performing operations on bound resources.
      This may lead to memory corruption or even crash.
    external_effects: Application may perform operations on closed module which may lead to unpredicted behavior
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691493, GID-REQ-4691494)
    causes:
    - id: LWSTREAMS_SYNC_CAUSE_NA_088
      description: Internal failure in LwStreams.
      na: This failure mode cause is prevented by design (GID-SWUD-4686534) # SWUD spec of module closing 18844599
    - LWSTREAMS_SYNC_SHARED_CAUSE_001
    evaluation:
      effectiveness: High
      justification: The mode's causes are prevented by design.

  - id: LWSCISYNC_FUNC_CLOSING_A_MODULE_FM_002
    description: >-
      The LwStreams closes access to the module when not requested
    class: Functionality unexpected
    local_effects: The LwStreams might write/read from invalid memory - unpredictable behavior.
    external_effects: Application corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691493, GID-REQ-4691494)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_406
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4796089)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_CLOSING_A_MODULE_FM_004
    description: >-
      The LwStreams destroys the module when the access to the module is not closed or there are some LwSciSync resources bound to it.
    class: Functionality unexpected
    local_effects: The LwStreams might write/read from invalid memory - unpredictable behavior.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691493, GID-REQ-4691494)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_032
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686534) # SWUD spec of module closing 18844599
    evaluation:
      effectiveness: High
      justification: The SWUD specification states closing LwSciSyncModule under those conditions.

  - id: LWSCISYNC_FUNC_CLOSING_A_MODULE_FM_005
    description: >-
      LwStreams writes memory not provided by application to write, or modifies input LwSciSyncModule in a way other than closing it.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691493, GID-REQ-4691494)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_358
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4796089)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_CLOSING_A_MODULE_FM_007
    description: >-
      LwStreams closes access to a module different than the requested one.
    class: Incorrect value
    local_effects: None
    external_effects: Resource leak. This other module is unexpectedly unusable and the application cannot continue.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691493, GID-REQ-4691494)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_381
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4796089)
    evaluation:
      effectiveness: High
      justification: Interface spec specifies that input module is freed.

  - id: LWSCISYNC_FUNC_CLOSING_A_MODULE_FM_006
    description: >-
      LwStreams module access closing or module freeing hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691493, GID-REQ-4691494)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_071
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION
  description: Attribute list reconciliation
  requirements:
  - 18838740
  - 18838737
  - 18838746
  - 18838749
  - 18838752
  - 18838755
  - 18838743
  - 18838722
  - 18838725
  - 18838728
  - 18838719
  - 18838734
  - 18838875
  failure_modes:
  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_003
    description: >-
      No conflict was detected but the LwStreams does not set WaiterPrimitiveInfo or SignalerPrimitiveInfo.
    class: Functionality missing
    local_effects: The resulting reconciled attribute list has no primitive type associated with it. LwStreams corruption.
    external_effects: Unexpected behavior from LwStreams.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_033
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800665) # SWUD spec of reocnciliation, T3 spec of internal attributes 18844329, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states those attributes are set.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_005
    description: >-
      The LwStream's does not yield any Signaler's Primitives for the next phase of reconciliation.
    class: Functionality missing
    local_effects: The rest of reconciliation fails or the primitive type is callwlated incorrectly.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_034
        description: Internal failure in LwSciSync.
        na: Prevented by design (TBD)
    evaluation:
      effectiveness: High
      justification: GID-SWAD-4800665 explains how Signaler's primitives are callwlated.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_007
    description: >-
      The LwStream's does not yield any Waiter's Primitives for the next phase of reconciliation.
    class: Functionality missing
    local_effects: The rest of reconciliation fails or the primitive type is callwlated incorrectly.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_035
        description: Internal failure in LwSciSync.
        na: Prevented by design (TBD)
    evaluation:
      effectiveness: High
      justification: GID-SWAD-4800665 explains how Signaler's primitives are callwlated.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_009
    description: >-
      No conflict was detected but the LwStreams does not set SignalerPrimitiveCount.
    class: Functionality missing
    local_effects: The LwSciSyncObj resulting from allocation against the reconciled attribute list will not have enough capability to satisfy signaler's needs.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_036
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800665) # SWUD spec of reocnciliation, T3 spec of internal attributes 18844329, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states those attributes are set.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_011
    description: >-
      No conflict was detected but the LwStreams does not set WaiterContextInsensitiveFenceExports.
    class: Functionality missing
    local_effects: When the user instruments this attribute in the resulting reconciled list or LwSciSyncObj, its value is different from the expected.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_037
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800660) # SWUD spec of reconciliation, T3 spec of public attributes 18844329, 18840165
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states this attribute is set.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_014
    description: >-
      No conflict was detected although there is no primitive type that would satisfy the requirements of all the peers.
    class: Functionality missing
    local_effects: Creating a reconciled attribute list without a primitive type.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_038
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800665) # SWUD spec of reocnciliation, T3 spec of internal attributes 18844329, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states conflict is reported.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_015
    description: >-
      No conflict was detected and reconciliation succeeded although the input signaler's unreconciled attribute list has SignalerPrimitiveCount set to 0.
    class: Functionality missing
    local_effects: The LwSciSyncObj resulting from allocation against the reconciled attribute list is useless as it has no primitives associated with it.
    external_effects: Application corruption. Unexpected behavior from Lwstreams.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_039
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800665) # SWUD spec of reocnciliation, T3 spec of internal attributes 18844329, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states that a conflict is reported in this case.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_018
    description: >-
      LwStreams returns an error without justification (does not create and return a reconciled attribute list)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_008
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_019
    description: >-
      LwStreams returns an already existing reconciled attribute list instead of a new one
    class: Functionality missing
    local_effects: None
    external_effects: Resource leak later on due to imbalanced refcounts
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_041
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969) # function swud specs 18844329
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_022
    description: >-
      LwStreams does not perform the reconciliation operations when requested and does not return the described LwSciSyncObj.
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_042
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686553) # SWUD spec of reconciliation and object allocation function 18844722
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states that LwStreams will perform reonciliation followed by object allocation.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_020
    description: >-
      LwStreams performs reconciliation when not requested
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption. Resource exhaustion.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_407
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4798517)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_001
    description: >-
      No conflict was detected but the LwStreams does not set ActualPerm or sets it to an incorrect value.
    class: Incorrect value
    local_effects: None
    external_effects: The resulting reconciled attribute list has permissions that are too low. Those permissions won't be sufficient for operations expected to be done by the peers.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_043
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800660) # SWUD spec of reconciliation, T3 spec of public attributes 18844329, 18840165
    evaluation:
      effectiveness: High
      justification: The SWAD/SWUD explains ActualPerm reconciliation.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_002
    description: >-
      No conflict was detected but the LwStreams does not set NeedCpuAccess or sets it to a wrong value.
    class: Incorrect value
    local_effects: None
    external_effects: The resulting reconciled attribute list has NeedCpuAccess that is too low. This won't be sufficient for operations expected to be done by the peers.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_044
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800660) # SWUD spec of reconciliation, T3 spec of public attributes 18844329, 18840165
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states that NeedCpuAccess is set.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_004
    description: >-
      The LwStreams sets WaiterPrimitiveInfo or SignalerPrimitiveInfo to a value different than the one described in the requirement.
    class: Incorrect value
    local_effects: The resulting reconciled attribute list has primitive type set to something else than what every peer supports.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_045
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800665) # SWUD spec of reocnciliation, T3 spec of internal attributes 18844329, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states those attributes are set correctly.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_006
    description: >-
      The LwStreams sets yields Signaler's Primitives to a value different than the one described in the requirement
    class: Incorrect value
    local_effects: The resulting reconciled attribute list has primitive type set to something else than what every peer supports.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_046
        description: Internal failure in LwSciSync.
        na: Prevented by design (TBD)
    evaluation:
      effectiveness: High
      justification: GID-SWAD-4800665 explains how Signaler's primitives are callwlated.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_008
    description: >-
      The LwStreams sets yields Waiter's Primitives to a value different than the one described in the requirement
    class: Incorrect value
    local_effects: The resulting reconciled attribute list has primitive type set to something else than what every peer supports.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_047
        description: Internal failure in LwSciSync.
        na: Prevented by design (TBD)
    evaluation:
      effectiveness: High
      justification: GID-SWAD-4800665 explains how Signaler's primitives are callwlated.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_010
    description: >-
      The LwStreams sets SignalerPrimitiveCount to a value different than described in the requirement.
    class: Incorrect value
    local_effects: If the value is too high, no effect. If the value is too high, then the LwSciSyncObj resulting from allocation against the reconciled attribute list will not have enough capability to satisfy signaler's needs.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_048
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800665) # SWUD spec of reocnciliation, T3 spec of internal attributes 18844329, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states those attributes are set.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_012
    description: >-
      The LwStreams sets WaiterContextInsensitiveFenceExports to a value different than described in the requirement.
    class: Incorrect value
    local_effects: When the user instruments this attribute in the resulting reconciled list or LwSciSyncObj, its value is different from the expected.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_049
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969, GID-SWAD-4800660) # SWUD spec of reconciliation, T3 spec of public attributes 18844329, 18840165
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states thus attribute is set.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_023
    description: >-
      LwStreams allocated the LwSciSyncObj against a different reconciled list than the one it just reconciled
    class: Incorrect value
    local_effects: The resulting LwSciSyncObj does not meet requirements of all the peers.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_050
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4802841) # swud spec of reconcile_and_obj_alloc 18839784
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_024
    description: >-
      LwStreams returned an attribute list that is not reconciled.
    class: Incorrect value
    local_effects: None
    external_effects: The application won't be able to use the attribute list for LwSciSyncObj.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_051
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969) # SWUD spec of reconciliation 18844329
    evaluation:
      effectiveness: High
      justification: The SWUD specification states the output list is reconciled in Parameters section.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_025
    description: >-
      LwStreams returns invalid LwSciSync attribute list handle.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this handle.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_082
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685969) # SWUD spec of reconciliation 18844329
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_RECONCILIATION_FM_021
    description: >-
      LwStreams reconciliation  hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679385, GID-REQ-4679384, GID-REQ-4679387, GID-REQ-4692920, GID-REQ-4692921, GID-REQ-4692922, GID-REQ-4679386, GID-REQ-4679380, GID-REQ-4679381, GID-REQ-4682587, GID-REQ-4679379, GID-REQ-4679383, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_092
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING
  description: Attribute list transporting
  requirements:
  - 18838791
  - 18838794
  - 18838788
  - 18838803
  - 18838797
  - 18838974
  - 18838839
  - 18838800
  - 18838806
  failure_modes:
  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_001
    description: >-
      The LwStreams does not include SignalerPrimitiveInfo in the resulting unreconciled attribute list export descriptor.
    class: Functionality missing
    local_effects: The export descriptor does not contain SignalerPrimitiveInfo. If the unreconciled attribute list has signaler permissions, reconciliation will fail or use local cpu primtives which might be are the same in safety. If not, the attribute would be ignored, so no impact.
    external_effects: Later failure from LwStreams.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_052
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686528,  GID-SWAD-4800665) # SWUD spec of export unreconciled, T3 spec of internal attributes 18844359, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD states this attribute is set during export in attribute specification.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_003
    description: >-
      The LwStreams does not include WaiterPrimitiveInfo in the resulting attribute list export descriptor.
    class: Functionality missing
    local_effects: The export descriptor does not contain WaiterPrimitiveInfo. If the unreconciled attribute list has waiter permissions, reconciliation will fail. If not, the attribute would be ignored, so no impact.
    external_effects: Later failure from LwStreams.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_053
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686528,  GID-SWAD-4800665) # SWUD spec of export unreconciled, T3 spec of internal attributes 18844359, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD states this attribute is set during export in attribute specification.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_005
    description: >-
      LwStreams returns an error without justification (does not create an export descriptor or does not create an attribute list)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_009
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation:
      effectiveness: High
      justification: Interface specification guarantees only errors listed are returned.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_010
    description: >-
      LwStreams does not set NeedCpuAccess or ActualPerm attributes in the resulting reconciled attribute list export descriptor to the importing peer's expected values.
    class: Functionality missing
    local_effects: The importing application does not have the required permissions.
    external_effects: Application unable to continue.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_055
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686529, GID-SWAD-4800660) # SWUD spec of export reconciled, T3 spec of public attributes 18844362, 18840165
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states those attribute are being set during reconciled list import in attributes description.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_016
    description: >-
      The LwStreams does not perform validation check of the input attribute list export descriptor during import and the descriptor is invalid.
    class: Functionality missing
    local_effects: LwStreams memory corruption. Resulting attribute list is invalid.
    external_effects: Application memory corruption. Unexpected behavior from LwStreams later.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_110
        description: >-
          Internal failure in LwSciSync. The export descriptor is corrupted during transport. The user feeds incorrect data to LwStreams instead of a valid export descriptor.
        heavens_ref: TBD
        measures:
          - id: LWSCISYNC_MEAS_060
            description: LwStreams does validate the input attribute list descriptors.
            type: Prevention of Cause
            refs: [GID-SWUD-4686530, GID-SWUD-4686531] # SWUD spec of attribute list imports 18844365, 18844368
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that an error is reported when descBuf and descLen do not constitute a valid export descriptor.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_017
    description: >-
      The LwStreams does not perform operations as described in the requirement (does not export object after exporting its reconciled attribute list or does not import the object against just imported reconciled attribute list)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_056
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686554, GID-SWUD-4686556) # SWUD specs of list and object transports 18844725, 18844731
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that LwStreams transports lists and object.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_024
    description: >-
      LwStreams does not validate the resulting reconciled attribute list against input unreconciled lists.
    class: Functionality missing
    local_effects: None
    external_effects: The later imported LwSciSyncObj does not meet importer's requirements.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_057
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686531, GID-SWAD-4800660, GID-SWAD-4800665) # SWUD spec of import reconciled, SWAD specs of attributes 18844368, 18840165, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD function specification states that the imported attribute list is validated and an error is returned on fail. SWAD attribute specifications describe how the validation is performed for each attribute.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_008
    description: >-
      LwStreams writes memory not provided by application to write, or modifies input attribute lists.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_382
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798518, GID-SWAD-4798519, GID-SWAD-4798521, GID-SWAD-4798523)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_023
    description: >-
      LwStreams returned an attribute list but some input attribute lists used to create the input export descriptor were not unreconciled.
    class: Functionality unexpected
    local_effects: None
    external_effects: Application unable to use it in reconciliation or export as an unreconciled list and continue.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_058
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686530) # import unreconciled swud spec 18844365
    evaluation:
      effectiveness: High
      justification: The SWUD specification states those input attribute lists are checked to be unreconciled and error would be reported otherwise.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_025
    description: >-
      Refer to failure modes of "Validating a reconciled attribute list" functionality
    class: Functionality unexpected
    local_effects: Refer to failure modes of "Validating a reconciled attribute list" functionality
    external_effects: Refer to failure modes of "Validating a reconciled attribute list" functionality
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_119
        description: >-
          Refer to failure modes of "Validating a reconciled attribute list" functionality
        heavens_ref: TBD
        measures:
          - id: LWSCISYNC_MEAS_011
            description: Refer to failure modes of "Validating a reconciled attribute list" functionality
            type: Other
            refs: []
    evaluation:
      effectiveness: High
      justification: The reference justifies the score.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_002
    description: >-
      LwStreams fills SignalerPrimitiveInfo but to a wrong value.
    class: Incorrect value
    local_effects: Reconciliation will either pass or fail unexpectedly.
    external_effects: Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_059
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686528,  GID-SWAD-4800665) # SWUD spec of export unreconcield, T3 spec of internal attributes 18844359, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD states this attribute is set during export in attribute specification.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_004
    description: >-
      LwStreams fills WaiterPrimitiveInfo but to a value different than described in the requirement.
    class: Incorrect value
    local_effects: Reconciliation will either pass or fail unexpectedly.
    external_effects: Unexpected behavior from LwStreams.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_060
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686528,  GID-SWAD-4800665) # SWUD spec of export unreconciled, T3 spec of internal attributes 18844359, 18840207
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD states this attribute is set during export in attribute specification.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_006
    description: >-
      LwStreams returns a good attribute list export descriptor but not a new one.
    class: Incorrect value
    local_effects: Double freeing at deinit time
    external_effects: Double freeing at deinit time
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_061
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798518, GID-SWAD-4798519, GID-SWAD-4802843) # func specs of exports 18839805, 18839808, 18839826
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_007
    description: >-
      LwStreams returns a good attribute list export descriptor but not based on the input group of attribute lists.
    class: Incorrect value
    local_effects: Reconciliation process might fail or pass unexpectedly and its potential result does not reflect actual needs of the peers.
    external_effects: Unexpected behvior from LwStreams.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_062
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798518, GID-SWAD-4798519, GID-SWAD-4802843) # func specs of exports 18839805, 18839808, 18839826
    evaluation:
      effectiveness: High
      justification: The SWUD specification describes how export descriptor is produced from input attibute lists.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_011
    description: >-
      LwStreams set NeedCpuAccess or ActualPerm attributes to values different than expected in the peer importing a reconciled attribute list.
    class: Incorrect value
    local_effects: None
    external_effects: The importing application does not have the required permissions or has too big ones.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_063
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686529, GID-SWAD-4800660) # SWUD spec of export reconciled, T3 spec of public attributes 18844362, 18840165
    evaluation:
      effectiveness: High
      justification: The SWUD/SWAD specification states those attribute are being set during reconciled list import in attributes description.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_013
    description: >-
      When importing an attribute list LwStreams returned an attribute list but not a new one.
    class: Incorrect value
    local_effects: Double freeing at deinit time
    external_effects: Double freeing at deinit time
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_064
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798521, GID-SWAD-4798523, GID-SWAD-4802846) # import specs 18839811, 18839814, 18839832
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_014
    description: >-
      LwStreams returned an attribute list that is not based on the input export descriptor.
    class: Incorrect value
    local_effects: None
    external_effects: The importer process will start behaving unexpectedly
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_065
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686530, GID-SWUD-4686531, GID-SWUD-4686556) # SWUD specs of attribute list imports 18844365, 18844368, 18844731
    evaluation:
      effectiveness: High
      justification: The SWUD specification describes how attribute lists are produced from input export descriptors.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_015
    description: >-
      LwStreams returns invalid LwSciSync attribute list handle.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this handle.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_083
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798518, GID-SWAD-4798519, GID-SWAD-4802843) # func specs of exports 18839805, 18839808, 18839826
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_018
    description: >-
      LwStreams returns invalid LwSciSync attribute list descriptor.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this descriptor.
    external_effects: Unpredictable behavior when using this descriptor.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_084
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686530, GID-SWUD-4686531, GID-SWUD-4686556) # SWUD specs of attribute list imports 18844365, 18844368, 18844731
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_TRANSPORTING_FM_009
    description: >-
      LwStreams operation hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679402, GID-REQ-4679403, GID-REQ-4679401, GID-REQ-4679408, GID-REQ-4679407, GID-REQ-4645390, GID-REQ-4679420, GID-REQ-4679404, GID-REQ-4679409)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_103
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_FENCE_EXTRACTING
  description: Fence extracting
  requirements:
  - 18838674
  failure_modes:
  - id: LWSCISYNC_FUNC_FENCE_EXTRACTING_FM_001
    description: >-
      LwStreams returns an error without justification (does not return the requested pair)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679367)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_010
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation:
      effectiveness: High
      justification: Interface specification guarantees only errors listed are returned.

  - id: LWSCISYNC_FUNC_FENCE_EXTRACTING_FM_003
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679367)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_360
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4789691)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_FENCE_EXTRACTING_FM_002
    description: >-
      LwStreams returned a pair but it is not associated with the input fence.
    class: Incorrect value
    local_effects: None
    external_effects: Waiters do not wait properly. They hang or start their work too early, working on corrupted data.
    heavens_ref: T3_LwStreams_550
    impact: ASIL-B (GID-REQ-4679367)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_067
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686543) # SWUD specs of fence extract 18844503
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that the output pair comes from the input fence.

  - id: LWSCISYNC_FUNC_FENCE_EXTRACTING_FM_004
    description: >-
      LwStreams extracting a fence hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679367)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_123
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_FENCE_UPDATING
  description: Fence updating
  requirements:
  - 18838671
  failure_modes:
  - id: LWSCISYNC_FUNC_FENCE_UPDATING_FM_001
    description: >-
      LwStreams returns an error without justification (does not update the LwSciSync fence.
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679366)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_012
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation:
      effectiveness: High
      justification: Interface specification guarantees only errors listed are returned.

  - id: LWSCISYNC_FUNC_FENCE_UPDATING_FM_003
    description: >-
      LwStreams updates an LwSciSync fence when not requested.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory coruption. Waiters don't wait properly. They hang or start their work too early, working on corrupted data.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679366)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_408
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4789692)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_FENCE_UPDATING_FM_004
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679366)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_361
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4789692)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_FENCE_UPDATING_FM_002
    description: >-
      LwStreams updates the fence but it's value does not correspond to the input key-value pair.
    class: Incorrect value
    local_effects: None
    external_effects: Waiters do not wait properly. They hang or start their work too early, working on corrupted data.
    heavens_ref: T3_LwStreams_550
    impact: ASIL-B (GID-REQ-4679366)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_069
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686542) # SWUD specs of fence update 18844500
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that the output fence is produced based on the input pair.

  - id: LWSCISYNC_FUNC_FENCE_UPDATING_FM_006
    description: >-
      LwStreams fills the output fence with invalid fence.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this handle.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_550
    impact: ASIL-B (GID-REQ-4679366)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_085
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686542) # SWUD specs of fence update 18844500
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_FENCE_UPDATING_FM_005
    description: >-
      LwStreams updating a fence hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679366)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_128
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_GETTING_OBJECT_FROM_FENCE
  description: Getting object from fence
  requirements:
  - 18838677
  failure_modes:
  - id: LWSCISYNC_FUNC_GETTING_OBJECT_FROM_FENCE_FM_001
    description: >-
      LwStreams returns an error without justification (does not return the LwSciSync Object.
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679368)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_013
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation:
      effectiveness: High
      justification: Interface specification guarantees only errors listed are returned.

  - id: LWSCISYNC_FUNC_GETTING_OBJECT_FROM_FENCE_FM_003
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679368)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_362
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4789693)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_GETTING_OBJECT_FROM_FENCE_FM_002
    description: >-
      LwStreams returns an object but it is not the one associated with the input LwSciSyncFence.
    class: Incorrect value
    local_effects: None
    external_effects: The user has wrong idea about which LwSciSync Object is associated with its fence.
    heavens_ref: T3_LwStreams_550
    impact: ASIL-B (GID-REQ-4679368)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_071
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4789693) # getting object function specs 18839844
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_GETTING_OBJECT_FROM_FENCE_FM_005
    description: >-
      LwStreams returns invalid LwSciSync Object handle..
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this handle.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_550
    impact: ASIL-B (GID-REQ-4679368)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_086
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4789693) # getting object function specs 18839844
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_GETTING_OBJECT_FROM_FENCE_FM_004
    description: >-
      LwStreams getting object from fence hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679368)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_132
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING
  description: Attribute list cloning
  requirements:
  - 18838659
  failure_modes:
  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_001
    description: >-
      LwStreams returns an error without justification (does not return the attribute list)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_015
        description: LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation:
      effectiveness: High
      justification: Interface specification guarantees only errors listed are returned.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_004
    description: >-
      LwStreams does not produce a cloned attribute list.
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_078
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798508) # list clone function specs 18839754
    evaluation:
      effectiveness: High
      justification: Interface specification guarantees that a cloned attribute list is produced when LwStreams reports a success for this operation.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_005
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_363
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798508)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_007
    description: >-
      LwStreams clones an LwSciSync attribute list when not requested.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory coruption. Resource leak.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_409
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4798508)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_008
    description: >-
      LwStreams creates more than one cloned list.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption. Resource exhaustion.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_073
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685961) # SWUD specs of list cloning 18844224
    evaluation:
      effectiveness: High
      justification: The SWUD specification describes how cloning is done and there is no other clone produced.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_002
    description: >-
      LwStreams returns an attribute list but it is not a new one.
    class: Incorrect value
    local_effects: Double free at deinit. If the list is unreconciled, changes to it impact another peer unexpectedly.
    external_effects: Double free at deinit. Application corruption.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_074
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685961) # SWUD specs of list cloning 18844224
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_003
    description: >-
      LwStreams returns a new attribute list but it does not match the source attribute list.
    class: Incorrect value
    local_effects: None
    external_effects: Application unable to continue as trying to use the attribute list in an intended way will result in error.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_075
        description: Internal failure in LwSciSync.
        na: Prevented by design (18844224) # SWUD specs of list cloning 18844224
    evaluation:
      effectiveness: High
      justification: The SWUD specification states that the reconciliation type is the same.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_009
    description: >-
      LwStreams returns invalid LwSciSync attribute list handle.
    class: Incorrect value
    local_effects: Unpredictable behavior in subsequent calls against this handle.
    external_effects: Unpredictable behavior when using this handle.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_087
        description: Internal failure in LwSciSync.
        na: Prevented by design (18844224) # SWUD specs of list cloning 18844224
    evaluation: *ilwalid_handle_evaluation

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CLONING_FM_006
    description: >-
      LwStreams cloning attribute list hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679362)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_138
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang


- id: LWSCISYNC_FUNC_TRANSPORT_DESCRIPTOR_FREEING
  description: Transport descriptor freeing
  requirements:
  - 18838884
  failure_modes:
  - id: LWSCISYNC_FUNC_TRANSPORT_DESCRIPTOR_FREEING_FM_001
    description: >-
      The LwStreams does not destroy the export descriptor.
    class: Functionality missing
    local_effects: None
    external_effects: Resource leak
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691492)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_076
        description: Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686532) # SWUD specs of list desc freeing 18844371
    evaluation:
      effectiveness: High
      justification: The SWUD specification states the input descriptor is freed.

  - id: LWSCISYNC_FUNC_TRANSPORT_DESCRIPTOR_FREEING_FM_006
    description: >-
      The LwStreams allows access to the descriptor after it was freed.
    class: Functionality missing
    local_effects: LwStreams accesses the memory no longer controlled by it.
      This may lead to memory corruption or even crash.
    external_effects: Application may perform operations on the descriptor which may lead to unpredicted behavior
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691492)
    causes:
    - id: LWSTREAMS_SYNC_CAUSE_NA_089
      description: Internal failure in LwStreams.
      na: This failure mode cause is prevented by design (GID-SWUD-4686532) # SWUD specs of list desc freeing 18844371
    - LWSTREAMS_SYNC_SHARED_CAUSE_001
    evaluation:
      effectiveness: High
      justification: Failure mode causes are prevented by design.

  - id: LWSCISYNC_FUNC_TRANSPORT_DESCRIPTOR_FREEING_FM_002
    description: >-
      The LwStreams destroys the export descriptor when not requested
    class: Functionality unexpected
    local_effects: The LwStreams might read from invalid memory - unpredictable behavior.
    external_effects: Application corruption
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691492)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_410
        description: >-
          Internal failure in LwStreams.
        na: >-
          LwStreams is a userspace library which is ilwoked only by application calls.
          LwStreams is not a process to execute without intent of application.
          Prevented by design (GID-SWAD-4802845, GID-SWAD-4798533)
    evaluation: *na_evaluation_when_not_requested

  - id: LWSCISYNC_FUNC_TRANSPORT_DESCRIPTOR_FREEING_FM_003
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwStreams corruption.
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691492)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_364
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802845, GID-SWAD-4798533)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_TRANSPORT_DESCRIPTOR_FREEING_FM_005
    description: >-
      LwStreams frees different descriptor than the one provided.
    class: Incorrect value
    local_effects: N/A
    external_effects: Resource exhaustion. Unpredictable behavior due to feeing a descriptor potentially still being read.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691492)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_077
        description: Internal failure in LwSciSync.
        na: Prevented by design (18844371)
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_TRANSPORT_DESCRIPTOR_FREEING_FM_004
    description: >-
      LwStreams transport descriptor freeing hangs or takes too long.
    class: Incorrect timing
    local_effects: LwStreams hang
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691492)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_142
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_OBJECT_SIGNALING
  description: Object signaling
  requirements:
  - 18838854
  - 18839004
  - 18838992
  failure_modes:

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_001
    description: >-
      LwStreams returns an error without justification (does not signal LwSciSync object when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: N/A
    impact: ASIL-B (GID-REQ-4679425)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_150
        description: >-
          LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
        - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_008
    description: >-
      LwStreams does not prevent cascade of sync object corruption for objects owned by LwSciSync.
    class: Functionality missing
    local_effects: None
    external_effects: Application corruption
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_304
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-5425904).
    evaluation:
      effectiveness: High
      justification: LwStreams does not keep track of previously allocated sync objects. It only operates on data provided by user, or data that is bounded to the input. LwStreams only modifies data in output arguments mentioned in interface specification and does not modify data in input arguments or any other random data. Hence preventing cascade of sync object corruption.

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_009
    description: >-
      LwStreams does not restrict sync object update request for objects allocated by LwStreams, to the process allocating the sync object.
    class: Functionality missing
    local_effects: None
    external_effects: Application corruption as there can be multiple signaler entities
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_305
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-5425904).
    evaluation:
      effectiveness: Medium
      justification: T2 SWAD mentions "If the synchronization object is allocated by LwStreams, then the resource owner and the signaler must be in the same QNX_System user process and no explicit mutual authentication is needed. Instances are uniquely identified by a session identifier consisting of the LwSciSync synchronization object and the LwHost syncpoint handle."
      actions:
      - ref: https://lwbugs/200741303
        description: Architecture should provide mechanism to restrict sync object update request to allocator process.

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_002
    description: >-
      LwStreams signals LwSciSync object when not requested
    class: Functionality unexpected
    local_effects: None
    external_effects: Loss of expected synchronization in an waiter application; Fences expire too early or too late; application corruption
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679425)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_151
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4802840).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_003
    description: >-
      LwStreams signals LwSciSync object when requested through a handle not having signaling permission
    class: Functionality unexpected
    local_effects: None
    external_effects: Loss of expected synchronization in an waiter application; Fences expire too early or too late; application corruption
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679425)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_152
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4802840).
    evaluation:
      effectiveness: High
      justification: Interface specification state error is returned if syncObj is not a CPU Signaler.

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_004
    description: >-
      LwStreams signals primitive other than owned by input LwSciSync Object handle.
    class: Functionality unexpected
    local_effects: None
    external_effects: Loss of expected synchronization in a waiter application; Fences expire too early or too late; application corruption
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679425)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_153
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686552).
    evaluation:
      effectiveness: High
      justification: Design verifies that primitive been signaled is owned by LwSciSync object handle.

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_005
    description: >-
      LwStreams modifies input LwSciSync Object handle other than changes due to signaling operation. OR LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: &shared_local_effects_wrong_write
      - Corruption of LwStreams data structures
    external_effects: &shared_external_effects_wrong_write
      - Corruption of memory mapped into the application's address space
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679425)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_365
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802840)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_006
    description: >-
      LwStreams signals LwSciSync object more than once
    class: Incorrect value
    local_effects: None
    external_effects: Loss of expected synchronization in an waiter application; Fences expire too early or too late; application corruption
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679425)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_155
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-UNITDSIGNPLCL123-4622097).
    evaluation:
      effectiveness: High
      justification: SWUD ensures LwHost syncpoint increment API is ilwoked just once.

  - id: LWSCISYNC_FUNC_OBJECT_SIGNALING_FM_007
    description: >-
      LwStreams object signal hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679425)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_156
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE
  description: Waiting on a fence
  requirements:
  - 18838866
  - 18839010
  - 18838872
  - 18838869
  - 18838860
  failure_modes:

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_001
    description: >-
      LwStreams returns an error without justification (input fence is cleared, or LwStreams does not wait on pending fence when it should have or returns error for fence that expired before the timeout)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679429, GID-REQ-4679428)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_157
        description: >-
          LwStreams returns an error due to internal failure.
        measures:
        - LWSCISYNC_MEAS_001
        heavens_ref: TBD
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_003
    description: >-
      LwStreams returns success for pending fence
    class: Functionality missing
    local_effects: None
    external_effects: Loss of expected synchronization in a waiter application
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679429, GID-REQ-4679428)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_159
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4789688).
    evaluation:
      effectiveness: High
      justification: Architecture lists that timeout error is returned for pending fence. Also the interface specification clearly mentions the conditions for returning success.

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_009
    description: >-
      LwStreams does not use LwHost user API to wait on synchronization object
    class: Functionality missing
    local_effects: None
    external_effects: Security concern as authentication between signaler and waiter cannot be guaranteed.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4797946)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_306
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-UNITDSIGNPLCL123-4622098).
    evaluation:
      effectiveness: High
      justification: Unit design mentions LwRmHost1xSyncpointWait() is used for waiting.

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_004
    description: >-
      LwStreams waits on input pending fence even if the LwSciSync Object bound to by the input fence doesn't have CPU waiting permissions
    class: Functionality unexpected
    local_effects: None
    external_effects: None
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679429, GID-REQ-4679428)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_160
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4789688).
    evaluation:
      effectiveness: High
      justification: Architecture lists that error is returned for if caller doesn't have CPU wait perm.

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_005
    description: >-
      LwStreams waits on fence when not requested
    class: Functionality unexpected
    local_effects: None
    external_effects: Loss of expected synchronization in an application
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679429, GID-REQ-4679428)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_161
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4789688).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_006
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679429, GID-REQ-4679428)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_366
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4789688)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_007
    description: >-
      LwStreams waits on different/incorrect fence id/value than requested.
    class: Incorrect value
    local_effects: None
    external_effects: Loss of expected synchronization in a waiter application
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679429, GID-REQ-4679428)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_300
        description: >-
          Internal failure in LwSciSync.
        na: >-
          Prevented by design (GID-SWAD-4789688)
    evaluation:
      effectiveness: High
      justification: Architecture mentions that LwHost API is called with the same id/value which are passed as input.

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_002
    description: >-
      LwStreams doesn't return immediately for a cleared fence, or doesn't return within bounded period of time after timeout completes for pending fence
    class: Incorrect timing
    local_effects: None
    external_effects: Application latency if they handle timeouts, else Application not able to continue (hang)
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679429, GID-REQ-4679428)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_158
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4789688).
    evaluation:
      effectiveness: High
      justification: Architecture ensures waiting on a cleared and expired LwSciSyncFence is always not blocking. Architecture also mentions that control is returned to calling thread within bounded time upon pending fence timeout expiry.

  - id: LWSCISYNC_FUNC_WAITING_ON_A_FENCE_FM_008
    description: >-
      LwStreams fence wait hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679429, GID-REQ-4679428)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_163
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_FENCE_TRANSPORTING
  description: Fence transporting
  requirements:
  - 18838845
  - 18838848
  - 18838974
  failure_modes:

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_001
    description: >-
      LwStreams returns an error without justification (does not populate a fence export descriptor when it should have, or doesn't populate input fence with fence descriptor data or return an cleared fence for input descriptor containing 0s)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_164
        description: >-
          LwStreams returns an error due to internal failure.
        measures:
        - LWSCISYNC_MEAS_001
        heavens_ref: TBD
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_002
    description: >-
      LwStreams does not clear the imported fence before populating it based on the imported fence descriptor
    class: Functionality missing
    local_effects: None
    external_effects: Corruption of LwSciSync
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_165
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4789690).
    evaluation:
      effectiveness: High
      justification: Interface spec states that the LwSciSyncFence will be cleared first.

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_003
    description: >-
      LwStreams populates the imported fence with a new fence but does not associate it with input LwSciSync object handle
    class: Functionality missing
    local_effects: None
    external_effects: Lack of ability to wait on that fence.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_166
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4789690).
    evaluation:
      effectiveness: High
      justification: Interface spec states that out LwSciSyncFence is associated with the LwSciSyncObj.

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_004
    description: >-
      LwStreams successfully populates the input LwSciSync fence if the input fence descriptor is malformed (it does not match any exported descriptor that LwStreams could have populated for the input LwSciSync Object handle)
    class: Functionality unexpected
    local_effects: None
    external_effects: Corruption of LwSciSync
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_168
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-5405590, GID-SWUD-4686541).
    evaluation:
      effectiveness: Medium
      justification: Fence descriptor layout is mentioned in arch and design, but validation of the fence descriptor is missing. Although, the arch ensures that fence export descriptor is created as per described layout.
      actions:
      - ref: https://lwbugs/200741303
        description: Update arch to validate fence descriptor and return error if validation fails. Also implement test to check that error is returned when input fence desc is malformed.

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_005
    description: >-
      LwStreams populates the imported fence with a new non-cleared fence even though the fence descriptor is not intended for the LwSciSync Object handle
    class: Functionality unexpected
    local_effects: None
    external_effects: Fences expire too early or too late; application corruption
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_169
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-5405590, GID-SWUD-4686541).
    evaluation:
      effectiveness: High
      justification: Validation of import descriptor mentioned in arch and design. Fence is not imported if not intended for the LwSciSyncObj.

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_006
    description: >-
      LwStreams populates fence export descriptor or imported fence with imported fence descriptor when not requested.
    class: Functionality unexpected
    local_effects: None
    external_effects: Application memory corruption
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_170
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4789690, GID-SWAD-4789689).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_007
    description: >-
      LwStreams writes memory not provided by application to write, or modifies exported fence or import descriptor
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_367
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4789689, GID-SWAD-4789690)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_008
    description: >-
      LwStreams populates the imported fence with a fence not equivalent to the exported fence, even though the fence is intended for the LwSciSyncObject handle and the imported fence descriptor exactly matches the export descriptor
    class: Incorrect value
    local_effects: None
    external_effects: Fences expire too early or too late; application corruption
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_167
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686541).
    evaluation:
      effectiveness: High
      justification: SWUD states fence is populated as per desc.

  - id: LWSCISYNC_FUNC_FENCE_TRANSPORTING_FM_009
    description: >-
      LwStreams fence export or import hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679422, GID-REQ-4679423, GID-REQ-4645390)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_173
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_GENERATING_A_FENCE
  description: Generating a fence
  requirements:
  - 18838695
  failure_modes:

  - id: LWSCISYNC_FUNC_GENERATING_A_FENCE_FM_001
    description: >-
      LwStreams returns an error without justification (does not generate fence when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679373)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_174
        description: >-
          LwStreams returns an error due to internal failure.
        measures:
        - LWSCISYNC_MEAS_001
        heavens_ref: TBD
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_GENERATING_A_FENCE_FM_002
    description: >-
      LwStreams generates fence when not requested
    class: Functionality unexpected
    local_effects: LwSciSyncObject resources not freed. Fences expire too early or too late.
    external_effects: Resource exhaustion, application data corruption, or application hang.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679373)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_175
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4789688).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_GENERATING_A_FENCE_FM_003
    description: >-
      LwStreams generates fence when requested through a handle not owning a primitive
    class: Functionality unexpected
    local_effects: None
    external_effects: Undefined behavior (corruption of LwSciSyncObj; an LwSciSyncObj not owning primitive doesn't even have a max expired state)
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679373)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_176
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686551).
    evaluation:
      effectiveness: High
      justification: Validation is performed to ensure that LwSciSync is managing the allocated primitive.

  - id: LWSCISYNC_FUNC_GENERATING_A_FENCE_FM_004
    description: >-
      LwStreams modifies values/state of LwSciSync object other than max expected state. OR LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679373)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_368
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802839)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_GENERATING_A_FENCE_FM_005
    description: >-
      LwStreams incorrectly populates output fence
    class: Incorrect value
    local_effects: None
    external_effects: Corruption of LwSciSync. Fence expires too early or too late.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679373)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_179
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686551).
    evaluation:
      effectiveness: High
      justification: Design ensures fence is populated with correct details.

  - id: LWSCISYNC_FUNC_GENERATING_A_FENCE_FM_007
    description: >-
      LwStreams advances the max expected state of LwSciSync object more than once
    class: Incorrect value
    local_effects: None
    external_effects: Fence expires too early or too late
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679373)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_180
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686551).
    evaluation:
      effectiveness: High
      justification: SWUD ensures interface updating state is called just once.

  - id: LWSCISYNC_FUNC_GENERATING_A_FENCE_FM_008
    description: >-
      LwStreams generate fence hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679373)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_181
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_OBJECT_ALLOCATION
  description: Object allocation
  requirements:
  - 18838809
  - 18838875
  - 18839004
  - 18839016
  failure_modes:

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_001
    description: >-
      LwStreams returns an error without justification (does not request LwHost to allocate a syncpoint when it could have and should have, or returns an error after successfully allocating a syncpoint from LwHost)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_182
        description: >-
          LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_002
    description: >-
      LwStreams returns new handle to a new LwSciSync Object, not bound to input reconciled attribute list.
    class: Functionality missing
    local_effects: None
    external_effects: Subsequent operations on LwSciSync Object will fail
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_183
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686546).
    evaluation:
      effectiveness: High
      justification: Design ensure reference to the input reconciled LwSciSyncAttrList is taken.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_010
    description: >-
      LwStreams does not prevent cascade of sync object corruption.
    class: Functionality missing
    local_effects: None
    external_effects: Application corruption
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_301
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-5425904).
    evaluation:
      effectiveness: High
      justification: LwStreams does not keep track of previously allocated sync objects. It only operates on data provided by user, or data that is bounded to the input. LwStreams only modifies data in output arguments mentioned in interface specification and does not modify data in input arguments or any other random data. Hence preventing cascade of sync object corruption.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_011
    description: >-
      LwStreams does not assign unique session identifier to each sync object backed by LwHost syncpoint. OR LwStreams does not allocate LwHost handle for sync object whose primitive is owned by LwSciSync.
    class: Functionality missing
    local_effects: None
    external_effects: Inability to generate fence and signal sync object.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_302
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4804391, GID-SWUD-4804392).
    evaluation:
      effectiveness: High
      justification: Design ensures that LwHost syncpoint handle is allocated during sync object allocation when primitive is owned by LwSciSync and is not changed during the lifetime of the LwSciSyncObj.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_012
    description: >-
      LwStreams allocates LwHost handle for sync object whose primitive is not owned by LwSciSync.
    class: Functionality unexpected
    local_effects: None
    external_effects: Resource exhaustion
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_303
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4804391, GID-SWUD-4804392).
    evaluation:
      effectiveness: High
      justification: Design ensures that LwHost handle is not allocated during sync object allocation when primitive is not owned by LwSciSync.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_003
    description: >-
      LwStreams requests LwHost to allocate a syncpoint when not requested via the LwSciSync API
    class: Functionality unexpected
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent object allocation failure
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_185
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWUD-4686546).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_004
    description: >-
      LwStreams modifies the input reconciled attribute list. (OR) LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_369
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802831)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_005
    description: >-
      LwStreams returns new handle to a new LwSciSync Object bound to reconciled attribute list other than passed input.
    class: Incorrect value
    local_effects: None
    external_effects: Leads to Resource exhaustion if input reconciled list does not request owning a primitive, but incorrect attribute list requests to own a primitive. Also the object does not meet the peer's requirements and its subsequent behavior will be unpredictable.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_184
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686546).
    evaluation:
      effectiveness: High
      justification: Design ensures reference to the only input reconciled LwSciSyncAttrList is taken and not some other list.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_006
    description: >-
      LwStreams returns new handle to an existing LwSciSync Object.
    class: Incorrect value
    local_effects: None
    external_effects: Application corruption, signaling operation on this handle will lead to unintended expiration of fences generated with original object.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_186
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4802831).
    evaluation:
      effectiveness: High
      justification: Arch mentions about allocating object which certainly is new object.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_007
    description: >-
      LwStreams requests LwHost to allocate number of syncpoints greater than 1.
    class: Incorrect value
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent object allocation failure
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_188
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4804392).
    evaluation:
      effectiveness: High
      justification: SWUD ensures that only single LwHost call for allocating syncpoints.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_008
    description: >-
      LwStreams returns new handle to a new LwSciSync Object with the underlying primitive type other than as specified by a single entry in the SignalerPrimitiveInfo attribute of the input reconciled attribute list
    class: Incorrect value
    local_effects: None
    external_effects: LwSciSync and UMDs whose exelwtion choice relies on primitive type will be impacted.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_189
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (LWSTRMS52-SWUD-1113).
    evaluation:
      effectiveness: High
      justification: Design mentions that primitive type is fetched from the reconciled LwSciSyncAttrList is passed onto other inter-unit API for allocation.

  - id: LWSCISYNC_FUNC_OBJECT_ALLOCATION_FM_009
    description: >-
      LwStreams object allocation hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679410, GID-REQ-4679432)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_190
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_OBJECT_FREEING
  description: Object freeing
  requirements:
  - 18838902
  - 18838905
  failure_modes:

  - id: LWSCISYNC_FUNC_OBJECT_FREEING_FM_002
    description: >-
      LwStreams does not release reference to provided LwSciSync Object
    class: Functionality missing
    local_effects: None
    external_effects: LwSciSync Object will never be destroyed, potentially leading to resource exhaustion
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691498, GID-REQ-4691499)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_192
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4802836).
    evaluation:
      effectiveness: High
      justification: Arch explicitly mentions destroys and frees resources.

  - id: LWSCISYNC_FUNC_OBJECT_FREEING_FM_003
    description: >-
      LwStreams does not destroy LwSciSync Object once all references are released and no LwSciSyncFences are bound to it.
    class: Functionality missing
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent object allocation failure
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691498, GID-REQ-4691499)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_196
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686547).
    evaluation:
      effectiveness: High
      justification: The architecture and design mentions about decrementing the reference and free resources once count drops to 0.

  - id: LWSCISYNC_FUNC_OBJECT_FREEING_FM_004
    description: >-
      LwStreams destroys the LwSciSync Object but failed to clean-up associated resources
    class: Functionality missing
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent object allocation failure
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691498, GID-REQ-4691499)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_197
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-UNITDSIGNPLCL123-4597385).
    evaluation:
      effectiveness: High
      justification: Design mentions that attribute list and other resources are freed during destroy.

  - id: LWSCISYNC_FUNC_OBJECT_FREEING_FM_005
    description: >-
      LwStreams releases reference to a LwSciSync Object that the application did not request it to close
    class: Functionality unexpected
    local_effects: None
    external_effects: Subsequent application uses of that LwSciSync object will have undefined behavior
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691498, GID-REQ-4691499)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_193
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4802836).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_OBJECT_FREEING_FM_006
    description: >-
      LwStreams destroys an LwSciSync Object for which references still exist
    class: Functionality unexpected
    local_effects: None
    external_effects: Subsequent operations on provided LwSciSync Object may lead to unpredictable behavior
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691498, GID-REQ-4691499)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_194
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686547)
    evaluation:
      effectiveness: High
      justification: The architecture and design mentions about decrementing the reference and free resources once count drops to 0.

  - id: LWSCISYNC_FUNC_OBJECT_FREEING_FM_007
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691498, GID-REQ-4691499)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_370
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802836)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_OBJECT_FREEING_FM_008
    description: >-
      LwStreams frees object other than input.
    class: Incorrect value
    local_effects: None
    external_effects: Resource exhaustion. Unpredictable behavior due to freeing an object potentially still being read.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691498, GID-REQ-4691499)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_350
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4802836).
    evaluation:
      effectiveness: High
      justification: Design ensure that input sync object is freed.

  - id: LWSCISYNC_FUNC_OBJECT_FREEING_FM_009
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs or initializes too slowly
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691498, GID-REQ-4691499)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_198
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_FENCE_CLEARING
  description: Fence clearing
  requirements:
  - 18838680
  failure_modes:

  - id: LWSCISYNC_FUNC_FENCE_CLEARING_FM_001
    description: >-
      LwStreams reports an error without justification (e.g., does not clear fence when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679369)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_199
        description: >-
          LwStreams returns error code even when API performs required functionality. Internal failure in LwSciSync.
        measures:
        - LWSCISYNC_MEAS_001
        heavens_ref: TBD
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_FENCE_CLEARING_FM_002
    description: >-
      LwStreams does not unbind fence from its LwSciSync object, but writes 0s in fence memory.
    class: Functionality missing
    local_effects: None
    external_effects: Resource exhaustion
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679369)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_200
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686537).
    evaluation:
      effectiveness: High
      justification: Design guarantees reference to LwSciSyncObj is dropped.

  - id: LWSCISYNC_FUNC_FENCE_CLEARING_FM_003
    description: >-
      LwStreams does not write 0s to the fence's memory
    class: Functionality missing
    local_effects: None
    external_effects: Fence may still have stale data.
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679369)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_201
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686537).
    evaluation:
      effectiveness: High
      justification: Design ensures the memory pointed to by the LwSciSyncFence is guaranteed to be all zeros.

  - id: LWSCISYNC_FUNC_FENCE_CLEARING_FM_004
    description: >-
      LwStreams clears fence when not requested.
    class: Functionality unexpected
    local_effects: None
    external_effects: Loss of expected synchronization in an application
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679369)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_202
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4789686).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_FENCE_CLEARING_FM_005
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679369)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_371
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4789686)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_FENCE_CLEARING_FM_006
    description: >-
      LwStreams clears some other fence than the input
    class: Incorrect value
    local_effects: None
    external_effects: Application corruption
    heavens_ref: T3_LwStreams_531
    impact: ASIL-B (GID-REQ-4679369)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_204
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686537).
    evaluation:
      effectiveness: High
      justification: Arch mentions only input fence is cleared.

  - id: LWSCISYNC_FUNC_FENCE_CLEARING_FM_007
    description: >-
      LwStreams fence clear hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679369)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_205
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION
  description: Attribute list creation
  requirements:
  - 18838653
  failure_modes:

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_001
    description: >-
      LwStreams reports an error without justification (e.g., does not return a new attribute list when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_206
        description: >-
          LwStreams returns error code even when API performs required functionality. Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_002
    description: >-
      LwStreams returns an attribute list not bound to the input module.
    class: Functionality missing
    local_effects: None
    external_effects: Leads to reconciliation failure, or later LwSciSync operations fail
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_209
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798498).
    evaluation:
      effectiveness: High
      justification: Arch states that LwSciSyncAttrList is associated with the input LwSciSyncModule.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_003
    description: >-
      LwStreams creates new attribute lists when not requested
    class: Functionality unexpected
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent memory allocation failure
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_207
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4798498).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_004
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_372
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798498)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_005
    description: >-
      LwStreams returns NULL or an invalid attribute list
    class: Incorrect value
    local_effects: None
    external_effects: Application corruption when invalid attribute list is passed back to LwStreams
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_210
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798498).
    evaluation:
      effectiveness: High
      justification: Arch states that new attribute list is returned on success which is not NULL or invalid.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_006
    description: >-
      LwStreams returns an attribute list with few properties already set
    class: Incorrect value
    local_effects: None
    external_effects: Incorrect values for those attributes which are not set by client leads to incorrect sync object allocation and application data corruption. Also it would also prevent the clients from setting them.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_211
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798498).
    evaluation:
      effectiveness: High
      justification: Arch states that new attribute list returned with empty LwSciSyncAttrKeys.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_007
    description: >-
      LwStreams returns an attribute list with multiple or 0 slots.
    class: Incorrect value
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent memory allocation failure in case of multiple slots list. Reconciliation failure due to empty attributes in case of multiple slot list. LwStream memory corruption as set attributes APIs or trying to use slot 0 (which we always assume exists) for anything would lead to some corruption for 0 slot list.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_212
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798498).
    evaluation:
      effectiveness: High
      justification: Arch states that new attribute list returned has single slot.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_008
    description: >-
      LwStreams returns a reconciled or conflict attribute list
    class: Incorrect value
    local_effects: None
    external_effects: Setting attributes and/or reconciliation will fail
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_213
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798498).
    evaluation:
      effectiveness: High
      justification: Arch states that new attribute list returned is unreconciled.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_009
    description: >-
      LwStreams returns an attribute list bound to the different module than input module.
    class: Incorrect value
    local_effects: None
    external_effects: Reconciliation failure while trying to reconcile with other attribute list bound to input module.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_214
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798498).
    evaluation:
      effectiveness: High
      justification: Arch states that LwSciSyncAttrList is associated with the input LwSciSyncModule only and not any other module.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_CREATION_FM_010
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs or initializes too slowly
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679359)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_215
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES
  description: Setting attributes
  requirements:
  - 18838638
  - 18838644
  - 18838641
  - 18838656
  failure_modes:

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_001
    description: >-
      LwStreams reports an error without justification (e.g., LwStreams does not sets attribute when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_216
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_002
    description: >-
      LwStreams returns success but did not set provided attributes in input attribute list.
    class: Functionality missing
    local_effects: None
    external_effects: Incorrect reconciliation and sync object allocation.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_219
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798503).
    evaluation:
      effectiveness: High
      justification: Interface specification mentions attributes are set in input attribute list upon success.

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_003
    description: >-
      LwStreams did not change "set status" of provided attributes in provided attribute list to "set".
    class: Functionality missing
    local_effects: None
    external_effects: LwStreams may allow "double set" operation on provided attribute in provided attribute list. This may lead to incorrect reconciliation, incorrect sync object allocation, application data corruption. LwStreams client perform a "double set" operation on provided attribute list.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_220
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685956).
    evaluation:
      effectiveness: High
      justification: Design mentions keyState is set to LwSciSyncCoreAttrKeyState_SetLocked upon setting attribute value.

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_004
    description: >-
      LwStreams successfully sets attribute in reconciled attribute list.
    class: Functionality unexpected
    local_effects: None
    external_effects: LwStreams may set data in reconciled attribute list provided by LwStreams clients. This may lead to incorrect reconciliation, incorrect sync object allocation, application data corruption.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_217
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798503).
    evaluation:
      effectiveness: High
      justification: Interface specification mentions error is returned if attrList is not unreconciled.

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_005
    description: >-
      LwStreams successfully sets attribute in non-writable attribute list.
    class: Functionality unexpected
    local_effects: None
    external_effects: LwStreams may set data in imported attribute list provided by LwStreams clients. This may lead to incorrect reconciliation, incorrect sync object allocation, application data corruption.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_218
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798503).
    evaluation:
      effectiveness: High
      justification: Interface specification mentions error is returned if attrList is not writable.

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_006
    description: >-
      LwStreams allows setting attributes of "accessibility type" other than "input" in provided attribute list
    class: Functionality unexpected
    local_effects: None
    external_effects: None
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_221
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685956).
    evaluation:
      effectiveness: High
      justification: Design checks that key member of every LwSciSyncAttrKeyValuePair in the array is an input or input/output attribute.

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_007
    description: >-
      LwStreams allowed setting attributes whose "set status" was already "set".
    class: Functionality unexpected
    local_effects: None
    external_effects: LwStreams may allow "double set" operation on provided attribute in provided attribute list. This may lead to incorrect reconciliation, incorrect sync object allocation, application data corruption. LwStreams client performs a "double set" operation on provided attribute list.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_222
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685956).
    evaluation:
      effectiveness: High
      justification: The design guarantees that an error is returned for double set.

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_008
    description: >-
      LwStreams sets attribute value for an attribute that was not provided
    class: Functionality unexpected
    local_effects: None
    external_effects: This may lead to incorrect reconciliation, incorrect sync object allocation, application data corruption.
    heavens_ref: T3_LwStreams_409, T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_223
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4685956).
    evaluation:
      effectiveness: High
      justification: Design ensures that only the attribute key passed as input are set.

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_009
    description: >-
      LwStreams sets provided attribute to wrong attribute value in provided attribute list. OR LwStreams writes memory not provided by application to write.
    class: Incorrect value
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_373
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798503, GID-SWAD-4798535)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_SETTING_ATTRIBUTES_FM_010
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs or initializes too slowly
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691483, GID-REQ-4691485, GID-REQ-4691484, GID-REQ-4679361)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_225
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST
  description: Validating a reconciled attribute list
  requirements:
  - 18838713
  - 18838761
  - 21749789
  - 18838767
  - 18838770
  - 18838776
  failure_modes:

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_001
    description: >-
      LwStreams reports an error without justification (e.g., LwStreams fails to validate when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_226
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_002
    description: >-
      LwStreams did not report error if the provided attribute list is not reconciled
    class: Functionality missing
    local_effects: None
    external_effects: This may lead to incorrect validation, as the input attribute list is not reconciled.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_227
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798501).
    evaluation:
      effectiveness: High
      justification: Interface specification returns error if provided list is not reconciled.

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_003
    description: >-
      LwStreams did not indicate inconsistency if any of the input unreconciled lists has needCpuAccess set to true and the input reconciled attribute list's needCpuAccess is set to false.
    class: Functionality missing
    local_effects: None
    external_effects: This may lead to incorrect validation.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_228
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4800660).
    evaluation:
      effectiveness: High
      justification: Architecture dolwments error is returned if any of the input unreconciled lists has needCpuAccess set to true and the input reconciled attribute list's needCpuAccess is set to false.

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_004
    description: >-
      LwStreams did not indicate inconsistency if any of the input unreconciled lists has bigger permission in RequiredPerm attribute than the input reconciled attribute list's ActualPerm attribute.
    class: Functionality missing
    local_effects: None
    external_effects: This may lead to incorrect validation.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_229
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4800660).
    evaluation:
      effectiveness: High
      justification: Architecture dolwments error is returned if any of the input unreconciled lists has bigger permission in RequiredPerm attribute than the input reconciled attribute list's ActualPerm attribute.

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_005
    description: >-
      LwStreams did not indicate inconsistency if the primitive in SignalerPrimitiveInfo attribute of the input reconciled attribute list is not present in any of the SignalerPrimitiveInfo, WaiterPrimitiveInfo attributes of the input unreconciled attribute lists.
    class: Functionality missing
    local_effects: None
    external_effects: This may lead to incorrect validation.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_230
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4800665).
    evaluation:
      effectiveness: High
      justification: Architecture dolwments error is returned if the primitive in SignalerPrimitiveInfo attribute of the input reconciled attribute list is not present in any of the SignalerPrimitiveInfo, WaiterPrimitiveInfo attributes of the input unreconciled attribute lists.

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_006
    description: >-
      LwStreams did not indicate inconsistency if any of the following conditions are met; SignalerPrimitiveCount attribute in the input reconciled list has value 0; there is an input attribute list with signaling permissions and cpuNeedAccess set to TRUE and SignalerPrimitiveCount in the input reconciled list does not equal 1; there is an input attribute list with signaling permissions and cpuNeedAccess set to FALSE and SignalerPrimitveCount in that attribute list does not match the SignalerPrimitiveCount in the input reconciled attribute list
    class: Functionality missing
    local_effects: None
    external_effects: This may lead to incorrect validation.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_231
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4800665).
    evaluation:
      effectiveness: High
      justification: Architecture dolwments error is returned if any of the following conditions are met; SignalerPrimitiveCount attribute in the input reconciled list has value 0; there is an input attribute list with signaling permissions and cpuNeedAccess set to TRUE and SignalerPrimitiveCount in the input reconciled list does not equal 1; there is an input attribute list with signaling permissions and cpuNeedAccess set to FALSE and SignalerPrimitveCount in that attribute list does not match the SignalerPrimitiveCount in the input reconciled attribute list.

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_007
    description: >-
      LwStreams validates against another attribute list than the provided reconciled and/or unreconciled attribute lists.
    class: Functionality unexpected
    local_effects: None
    external_effects: This may lead to incorrect validation.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_232
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798547).
    evaluation:
      effectiveness: High
      justification: Architecture dolwments only input lists are used for validation.

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_008
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_374
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798501)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_009
    description: >-
      LwStreams sets validation output to fail instead of pass even though no conflicts were detected.
    class: Incorrect value
    local_effects: None
    external_effects: This may lead to incorrect validation.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_235
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798547).
    evaluation:
      effectiveness: High
      justification: Architecture dolwments success is returned in case of no conflicts.

  - id: LWSCISYNC_FUNC_VALIDATING_A_RECONCILED_ATTRIBUTE_LIST_FM_010
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679360, GID-REQ-4679392, GID-REQ-5399419, GID-REQ-4679394, GID-REQ-4679395, GID-REQ-4679397)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_236
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_GETTING_ATTRIBUTE_LIST_FROM_OBJECT
  description: Getting attribute list from object
  requirements:
  - 18838692
  failure_modes:

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTE_LIST_FROM_OBJECT_FM_001
    description: >-
      LwStreams reports an error without justification (e.g., LwStreams does not get an attribute list from the input object)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679372)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_237
        description: >-
          LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTE_LIST_FROM_OBJECT_FM_002
    description: >-
      LwStreams does not return the reconciled attribute list bound to the input LwSciSync object. Instead returns NULL or invalid attribute list
    class: Functionality missing
    local_effects: None
    external_effects: Further operation on retrieved list will fail.
    heavens_ref: T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679372)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_238
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4802906).
    evaluation:
      effectiveness: High
      justification: Interface specification guarantees returned list is valid if operation is successful.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTE_LIST_FROM_OBJECT_FM_003
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679372)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_375
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802906)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTE_LIST_FROM_OBJECT_FM_004
    description: >-
      LwStreams does not return the reconciled attribute list bound to the input LwSciSync object. Instead another attribute list than the one bound to sync object.
    class: Incorrect value
    local_effects: None
    external_effects: Further operation on retrieved list will give incorrect results.
    heavens_ref: T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4679372)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_240
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4802906).
    evaluation:
      effectiveness: High
      justification: Interface specification guarantees retrieved reconciled LwSciSyncAttrList is associated with an input LwSciSyncObj.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTE_LIST_FROM_OBJECT_FM_005
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679372)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_241
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_ALLOCATION
  description: Cpu wait context allocation
  requirements:
  - 18838782
  failure_modes:

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_ALLOCATION_FM_001
    description: >-
      LwStreams reports an error without justification. (e.g. LwStreams did not allocate CPU wait context when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679399)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_242
        description: >-
          LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_ALLOCATION_FM_002
    description: >-
      LwStreams creates new cpu wait context when not requested
    class: Functionality unexpected
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent memory allocation failure, and also memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679399)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_243
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4789688).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_ALLOCATION_FM_003
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679399)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_376
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4803711)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_ALLOCATION_FM_004
    description: >-
      LwStreams returns an existing cpu wait context instead of a new one
    class: Incorrect value
    local_effects: None
    external_effects: This would lead to invalid wait request, as LwHost would return error if same wait context is used for two different wait in the same time.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679399)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_244
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4803711).
    evaluation:
      effectiveness: High
      justification: Interface spec gurantees new CPU wait context is allocated.

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_ALLOCATION_FM_005
    description: >-
      LwStreams returns a cpu wait context not bound to the specified module
    class: Incorrect value
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent memory allocation failure, or later LwSciSync operations fail
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679399)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_245
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4803711).
    evaluation:
      effectiveness: High
      justification: Arch specifies that new CPU wait context is associated with LwSciSyncModule.

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_ALLOCATION_FM_006
    description: >-
      LwStreams cpu wait context open hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hang
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679399)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_246
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_FREEING
  description: Cpu wait context freeing
  requirements:
  - 18838899
  failure_modes:

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_FREEING_FM_002
    description: >-
      LwStreams frees the cpu wait context but failed to unbind the module
    class: Functionality missing
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent memory allocation failure
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691497)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_248
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4803919).
    evaluation:
      effectiveness: High
      justification: Arch dolwments that module reference is dropped while destroying CPU wait context.

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_FREEING_FM_003
    description: >-
      LwStreams does not free the cpu wait context but returns no error.
    class: Functionality missing
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent memory allocation failure
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691497)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_251
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4686536).
    evaluation:
      effectiveness: High
      justification: Unit design guarantees that if cpu wait context is freed if operation is successful.

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_FREEING_FM_004
    description: >-
      LwStreams frees a cpu wait context when not requested.
    class: Functionality unexpected
    local_effects: None
    external_effects: Subsequent application uses of that cpu wait context will have undefined behavior, and memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691497)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_249
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWUD-4686536).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_FREEING_FM_005
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691497)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_377
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4803712)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_FREEING_FM_006
    description: >-
      LwStreams frees a cpu wait context different than the one requested to close
    class: Incorrect value
    local_effects: None
    external_effects: Subsequent application uses of that cpu wait context will have undefined behavior
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691497)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_250
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4803712).
    evaluation:
      effectiveness: High
      justification: Interface spec specifies that input cpu wait context if freed.

  - id: LWSCISYNC_FUNC_CPU_WAIT_CONTEXT_FREEING_FM_007
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691497)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_253
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FROM_OBJECT
  description: Getting attributes from object
  requirements:
  - 18838707
  - 18838704
  failure_modes:

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FROM_OBJECT_FM_001
    description: >-
      LwStreams reports an error without justification. (e.g: LwStreams did not get attributes from object when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691490, GID-REQ-4691489)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_254
        description: >-
          LwStreams returns an error due to internal failure.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FROM_OBJECT_FM_002
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691490, GID-REQ-4691489)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_378
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4802857, GID-SWAD-4802858)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FROM_OBJECT_FM_003
    description: >-
      LwStreams return incorrect number of primitives/primitive type.
    class: Incorrect value
    local_effects: None
    external_effects: Subsequent application uses of the output value will lead to incorrect results
    heavens_ref: T3_LwStreams_453
    impact: ASIL-B (GID-REQ-4691490, GID-REQ-4691489)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_256
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4802858, GID-SWAD-4802857).
    evaluation:
      effectiveness: High
      justification: Interface specification mentions attributes are returned from input sync object.

  - id: LWSCISYNC_FUNC_GETTING_ATTRIBUTES_FROM_OBJECT_FM_004
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691490, GID-REQ-4691489)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_257
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING
  description: Attribute list freeing
  requirements:
  - 18838893
  - 18838896
  failure_modes:

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING_FM_002
    description: >-
      LwStreams does not close access to provided attribute list
    class: Functionality missing
    local_effects: None
    external_effects: Attribute list will never be destroyed, potentially leading to resource exhaustion
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691495, GID-REQ-4691496)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_259
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798499).
    evaluation:
      effectiveness: High
      justification: Arch mentions that access to attribute list is closed.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING_FM_009
    description: >-
      LwStreams does not destroy attribute list
    class: Functionality missing
    local_effects: None
    external_effects: Attribute list will never be destroyed, potentially leading to resource exhaustion
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691495, GID-REQ-4691496)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_359
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798499).
    evaluation:
      effectiveness: High
      justification: Arch mentions that attribute list is destroyed.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING_FM_003
    description: >-
      LwStreams destroys the attribute list but failed to unbind the module
    class: Functionality missing
    local_effects: None
    external_effects: Resource exhaustion, leading to subsequent memory allocation failure
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691495, GID-REQ-4691496)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_264
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798499).
    evaluation:
      effectiveness: High
      justification: Interface specification mentions that association with module is removed while destroying list.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING_FM_004
    description: >-
      LwStreams closes a list when not requested
    class: Functionality unexpected
    local_effects: None
    external_effects: Subsequent application uses of that attribute list will have undefined behavior
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691495, GID-REQ-4691496)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_260
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4798499).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING_FM_005
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691495, GID-REQ-4691496)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_379
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798499)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING_FM_006
    description: >-
      LwStreams destroys an attribute list different than the one requested to close
    class: Incorrect value
    local_effects: None
    external_effects: Subsequent application uses of that attribute list will have undefined behavior
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691495, GID-REQ-4691496)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_262
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798499).
    evaluation:
      effectiveness: High
      justification: Arch mentions that input LwSciSyncAttrList is freed.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING_FM_007
    description: >-
      LwStreams destroys an attribute list for which access is not yet closed
    class: Incorrect timing
    local_effects: None
    external_effects: Subsequent operations on provided attribute list may lead to unpredictable behavior
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4691495, GID-REQ-4691496)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_263
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798499).
    evaluation:
      effectiveness: High
      justification: The architecture and design mentions about closing access and destroying attribute list.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_FREEING_FM_008
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4691495, GID-REQ-4691496)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_265
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

- id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING
  description: Attribute list appending
  requirements:
  - 18838662
  failure_modes:

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING_FM_001
    description: >-
      LwStreams reports an error without justification (e.g. LwStreams did not append attribute lists when it should have)
    class: Functionality missing
    local_effects: None
    external_effects: Application unable to continue
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679363)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_266
        description: >-
          LwStreams returns error code even when API performs required functionality. Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_001
    evaluation: *shared_na_evaluation_unjust_error_notests

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING_FM_002
    description: >-
      LwStreams returns new unreconciled list whose slot count doesn't equal sum of slot count of input unreconciled attribute lists
    class: Functionality missing
    local_effects: None
    external_effects: Loss of information if number of slots is less than requested. Resource exhaustion if slotcount is more than requested. Reconciliation failure due to slot with empty attributes.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679363)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_267
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798406).
    evaluation:
      effectiveness: High
      justification: Interface specification mention that the output single new unreconciled LwSciSyncAttrList slot count equals the sum of all the slot counts of LwSciSyncAttrList(s) in the input array.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING_FM_003
    description: >-
      LwStreams returns new unreconciled list whose content of slots doesn't match the slot content of input unreconciled attribute lists
    class: Functionality missing
    local_effects: None
    external_effects: Further usage of the output attribute list leads to unexpected results
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679363)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_268
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWUD-4805599).
    evaluation:
      effectiveness: High
      justification: Interface specification mentions that slot by slot copy of input list to output list is performed.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING_FM_004
    description: >-
      LwStreams returns new appended unreconciled list when not requested.
    class: Functionality unexpected
    local_effects: None
    external_effects: Application memory corruption.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679363)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_269
        description: >-
          Internal failure in LwSciSync.
        na: LwStreams is a userspace library which is ilwoked only by application calls. LwStreams is not a process to execute without intent of application. Prevented by design (GID-SWAD-4798406).
    evaluation:
      effectiveness: High
      justification: The design prevents this failure mode from happening.


  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING_FM_005
    description: >-
      LwStreams writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: *shared_local_effects_wrong_write
    external_effects: *shared_external_effects_wrong_write
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679363)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_380
        description: >-
          Internal failure in LwStreams.
        na: >-
          Prevented by design (GID-SWAD-4798515)
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING_FM_006
    description: >-
      LwStreams returns attribute list whose state is set to other than unreconciled.
    class: Incorrect value
    local_effects: None
    external_effects: Subsequent application uses of the output attribute list will result in failure.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679363)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_270
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798515).
    evaluation:
      effectiveness: High
      justification: Interface specification mentions output list is unreconciled.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING_FM_007
    description: >-
      LwStreams returns writable unreconciled attribute list.
    class: Incorrect value
    local_effects: None
    external_effects: Setting attributes in the output list will be allowed leading to incorrect reconciliation and sync object allocation. Provided client did not follow the programming model and set attribute in appended list.
    heavens_ref: T3_LwStreams_409
    impact: ASIL-B (GID-REQ-4679363)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_NA_271
        description: >-
          Internal failure in LwSciSync.
        na: Prevented by design (GID-SWAD-4798515).
    evaluation:
      effectiveness: High
      justification: The architecture and design mentions output list is non-writable.

  - id: LWSCISYNC_FUNC_ATTRIBUTE_LIST_APPENDING_FM_008
    description: >-
      LwStreams hangs or takes too long
    class: Incorrect timing
    local_effects: None
    external_effects: Application hangs.
    heavens_ref: TBD
    impact: ASIL-B (GID-REQ-4679363)
    causes:
      - id: LWSTREAMS_SYNC_CAUSE_272
        description: >-
          Internal failure in LwSciSync.
        heavens_ref: TBD
        measures:
          - LWSCISYNC_MEAS_006
    evaluation: *shared_evaluation_hang

measures:
  - id: LWSCISYNC_MEAS_001
    description: DRIVE OS external ARR for error handling. The user of DRIVE OS must ensure that any errors
        reported by Init APIs cause the application to prevent transition to normal operation.
    type: Detection and Reporting of Failure Mode
    refs: [DOS_RES_105] # link to DOS general error reporting safety requirement 18723063

  - id: LWSCISYNC_MEAS_002
    description: LwStreams is going to check if permissions are sufficient on the importing side. If permissions are too big and include signaling, LwHost will not allow signaling and the only impact is that the failure will be reported at the signaling attempt.
    type: Detection and Reporting of Failure Mode
    refs: [GID-SWAD-4802840] # T3 Sync function LwSciSyncObjSignal() spec 18839781

  - id: LWSCISYNC_MEAS_003
    description: LwStreams validates export descriptors on import.
    type: Detection and Reporting of Failure Mode
    refs: [GID-REQ-4830943] # T3 Sync safety req for export descriptor validation 18844038

  - id: LWSCISYNC_MEAS_004
    description: The design prevents this because the structure used to describe the LwSciSync Object handle always has a permissions field. Not setting this results in LwSciSync Object handle having empty permissions
    type: Prevention of Cause
    refs: [GID-SWAD-4802880, GID-SWAD-4761531, GID-SWAD-4761527] # data type spec in T4 of object, core attribute list, core attrs 18845820, 18845775, 18845772

  - id: LWSCISYNC_MEAS_006
    description: DRIVE OS monitoring
    type: Detection and Reporting of Failure Mode
    refs: [DOS_ASU_010] # DOS Monitor Completion Status of Submitted Tasks 18900249

  - id: LWSCISYNC_MEAS_008
    description: LwStreams does a check at the end of reconciliation for ActualPerm to be SignalWait as this is the only supported usecase now.
    type: Detection and Reporting of Failure Mode
    refs: [] # TBD

  - id: LWSCISYNC_MEAS_009
    description: LwStreams checks that the input attribute list is reconciled when a reconciled list is expected.
    type: Detection and Reporting of Failure Mode
    refs: [GID-SWAD-4798501, GID-SWAD-4802831, GID-SWAD-4798519, GID-SWAD-4802838] # function specs of relevant functions in T3 18839742, 18839769, 18839808, 18839823

  - id: LWSCISYNC_MEAS_010
    description: LwStreams checks that the input attribute list is unreconciled when an ureconciled list is expected.
    type: Detection and Reporting of Failure Mode
    refs: [GID-SWAD-4798503, GID-SWAD-4798515, GID-SWAD-4798517, GID-SWAD-4798518, GID-SWAD-4798535, GID-SWAD-4800665] # function specs of relevant functions in T3 18839745, 18839763, 18839766, 18839805, 18839847, 18840207

  - id: LWSCISYNC_MEAS_012
    description: LwStreams returns an error when the user is trying to set an attribute that was already set (considered non-writable).
    type: Detection and Reporting of Failure Mode
    refs: [GID-SWAD-4798535, GID-SWAD-4798503] # function specs of relevant functions in T3 18839847, 18839745

  - id: LWSCISYNC_MEAS_013 # for random data corruption
    description: LwStreams only modifies data in output arguments mentioned in interface specification and does not modify data in input arguments or any other random data.
    type: Prevention of Cause
    refs: [] # TBD: Raj promised there would be a change to blanket statements to include this statement

  - id: LWSCISYNC_MEAS_014 # for "when not requested"
    description: LwStreams does not keep track of previously allocated objects like module, attribute list, object. It only operates on data provided by user, or data that is bounded to the input.
    type: Prevention of Cause
    refs: [] # TBD: Raj promised there would be a change to blanket statements to include this statement

  - id: LWSCISYNC_MEAS_015
    description: LwStreams overwrites memory with 0s before freeing.
      Magic ID stored inside LwStreams data structures is overwritten by 0 before freeing.
      LwStreams validates if Magic ID is present in data structures before performing operations on them.
    type: Detection and Reporting of Failure Mode
    refs: [GID-REQ-5456550] # zeroing memory on free 21886448

causes:
  - id: LWSTREAMS_SYNC_SHARED_CAUSE_001
    description: Memory freed by LwStreams is still accessible by LwStreams or application.
    heavens_ref: N/A
    measures:
      - LWSCISYNC_MEAS_015
