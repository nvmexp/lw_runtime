#
# Copyright (c) 2021, LWPU CORPORATION.  All rights reserved.
#
# LWPU CORPORATION and its licensors retain all intellectual property
# and proprietary rights in and to this software, related documentation
# and any modifications thereto.  Any use, reproduction, disclosure or
# distribution of this software and related documentation without an express
# license agreement from LWPU CORPORATION is strictly prohibited.
#

doc_id: SWE-LWSCISTREAM-003-SWFMEA-WKSHT
reviewed_in:
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145703"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145525"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145544"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145619"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145869"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/146639"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145077"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145564"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/145851"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/146226"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/147847"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/148315"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/148761"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/149198"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/153431"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/155421"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/156213"
  - "http://git-p4swmirror.lwpu.com/r/c/p4swmirror/cheetah/gpu/drv/+/156364"
  - "https://cr.lwpu.com/ui#review:id=183301"
  - "https://cr.lwpu.com/ui#review:id=189310"
state: Development
history:
  - author: spemmineti@lwpu.com
    date: Aug 20, 2021
    comment: Initial commit
  - author: sthangaraj@lwpu.com
    date: Aug 23, 2021
    comment: Update history, references and supporting dolwments
  - author: sthangaraj@lwpu.com
    date: Aug 31, 2021
    comment: Addressed review comments from CR 183301
  - author: sthangaraj@lwpu.com
    date: Sep 6, 2021
    comment: Added Threat IDs
  - author: sthangaraj@lwpu.com
    date: Sep 9, 2021
    comment: Moved the doc to approved state
  - author: sthangaraj@lwpu.com
    date: Oct 20, 2021
    comment: updated testing methods
  - author: sthangaraj@lwpu.com
    date: Nov 11, 2021
    comment: Included a new failure mode
  - author: sthangaraj@lwpu.com
    date: Nov 19, 2021
    comment: Updated effectiveness score after validation bug update(https://lwbugs/200755758).
  - author: sthangaraj@lwpu.com
    date: Nov 25, 2021
    comment: Updated the functionality name to align with JAMA functionalities.
input_work_products:
  - title: Software Requirement Specification
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/149123/list?projectId=22182
    rev: Sep 9, 2021
    purpose: Work product to identify functionalities, causes, local and external failure mode effects
  - title: Boundary Diagram
    location: https://lwpu.jamacloud.com/perspective.req#/items/18839103?projectId=22182 (Version 17)
    rev: Sep 14, 2021
    purpose: Reference to SWAD section containing LwSciStream boundary diagram
  - title: Sub-architecture Diagram
    location: https://lwpu.jamacloud.com/perspective.req#/items/18849444?projectId=22182 (Version 46)
    rev: June 8, 2021
    purpose: Reference to SWAD section containing LwSciStream sub-architecture diagram
  - title: FMEA/Safety Plan
    location: https://p4viewer/get///sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/01_Project_Management/SWE-LWSTREAMS-002-SP.docx
    rev: Nov 23, 2021
    purpose: Reference to LwStreams Safety Plan
    cl: 30690141
  - title: LwSciStream FMEA Functionality Map table
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/142467/list?projectId=22182
    rev: May 23, 2021
    purpose: Reference to LwSciStream FMEA functionality mapping table
  - title: Software Architecture and Design
    location: https://lwpu.jamacloud.com/perspective.req#/baselines/149122/list?projectId=22182
    rev: Sep 9, 2021
    purpose: Work product to identify functionalities, causes, local and external failure mode effects
  - title: LwStreams heavens sheet for Init APIs
    cl: 30359060
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/03_Architectural_Design/Security/LwStreams_Heaven_init.xlsx?revision=2
    rev: Aug 30, 2021
    purpose: Heavens sheet for threat ID reference
  - title: LwStreams heavens sheet for Runtime APIs
    cl: 30359060
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/03_Architectural_Design/Security/LwStreams_Heaven_runtime.xlsx?revision=2
    rev: Aug 30, 2021
    purpose: Heavens sheet for threat ID reference
references:
  - title: "LwStreams FMEA Development Guidelines"
    cl: 30277502 # if location is perforce then "cl" is mandatory
    location: https://p4viewer/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/LwStreams/08_Safety_Analysis/SWE-LWSTREAMS-040-DG.docx?revision=13
    rev: Aug 9, 2021 # only date works as rev else it fails don't know why. Schema doesnt enforce this.
    purpose: Process guidance for performing FMEAs
  - title: "SW FMEA Process Guide"
    cl: 30277502 # if location is perforce then "cl" is mandatory
    location: https://p4viewer.lwpu.com/get/sw/embedded/docs/admin/process/PLC/SWE-SAFETY-005-SWFMEA.docx?revision=17
    rev: Dec 11, 2020 # only date works as rev else it fails don't know why. Schema doesnt enforce this.
    purpose: Process guidance for performing FMEAs
  - title: DRIVE OS 5.2 FMEA and DFA Tailoring
    cl: 30144530
    location: https://p4viewer.lwpu.com/get/sw/PLC_Work_Products/rel-33/DRIVE_OS/QNX/Program_Level_WPs/01_Project_Management/SWE-DRIVE-114-SWTLR.docx?revision=2
    rev: Jul 1, 2021 # only date works as rev else it fails don't know why. Schema doesnt enforce this.
    purpose: Process guidance for performing FMEAs
RASIC: # all people listed below should be in people.yaml. Take this from LwStreams RASIC
  responsible: sthangaraj@lwpu.com
  approve: pjayakumar@lwpu.com
  support:
    - spemmineti@lwpu.com
    - yingl@lwpu.com
  inform:
    - hugol@lwpu.com
    - dkamurthy@lwpu.com
    - aparnad@lwpu.com
  consult: dkartch@lwpu.com
  review:
    - spemmineti@lwpu.com
    - yingl@lwpu.com
    - sthangaraj@lwpu.com

functions:
######## Functionality :: Sync Attr ##################
- id: LWSCISTREAM_FUNC_STREAM_SYNC_ATTR
  description: Stream sync attributes between producer and consumer applications
  failure_modes:
  - id: LWSCISTREAM_SYNC_ATTR_FM_001
    description: LwSciStream does not send the sync attributes to opposing blocks.
    class: Functionality missing
    local_effects: Failure to stream sync count and sync object(s)
    external_effects: Application can hang waiting for sync attributes or fail to
      stream sync count and sync objects.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B (GID-REQ-5456922, GID-REQ-4667133)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_201
      description: Failure in TrackArray unit- checkDone() used in Multicast to
        keep track of the sync attributes received from consumers.
      na: This cause is prevented by design as checkDone() is a simple operation
        (GID-SWAD-5133229) and multicast does not fail in this way
        (GID-SWAD-5284226). This is verified by integration testing for
        multicast(GID-TEST-5415321) and checkDone(GID-TEST-5396283,
        GID-TEST-5396284).
    - id: LWSCISTREAM_CAUSE_NA_202
      description: Failure in TrackArray unit- performAction(), which does not
        perform the correct action to send the sync attributes to upstream and
        downstream blocks.
      na: This cause is prevented by design as performAction() is a simple
        operation(GID-SWAD-5301167) and is verified by
        integration testing(GID-TEST-5396281, GID-TEST-5396282).
    - id: LWSCISTREAM_CAUSE_NA_210
      description: LwSciStream fails to perform Block::eventPost() to post
        the attribute event to inform the opposing blocks.
      na: The architecture does not fail in this way (GID-SWAD-5284222,
        GID-SWAD-5284230). It is verified by integration testing that this cause
        is not present(GID-TEST-5356234).
    - LWSCISTREAM_SHARED_CAUSE_NA_013
    measures:
    - id: LWSCISTREAM_MEAS_201
      description: LwSciStream detects and reports the failure mode by throwing
        an error to the application, if the further steps to transmit sync count
        and sync objects , are attempted before the sync attributes are shared.
      type: Detection and Reporting of Failure Mode
      refs: [21270249, 21347088, 21270738, 21347394]
      tests: [GID-TEST-5329795, GID-TEST-5329810, GID-TEST-5280269, GID-TEST-5280286]
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SYNC_ATTR_FM_002
    description: LwSciStream corrupts the LwSciSyncAttrList, during relaying of the
      data between opposing blocks
    class: Functionality unexpected
    local_effects: N/A
    external_effects: "1. Wrong sync attributes for reconciliation and object allocation
      2. unpredictable behavior."
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B (GID-REQ-4637315)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_204
      description: Failure in LwSciWrap units during cloning of the LwSciSyncAttrList
        (GID-SWAD-5275885).
      na: This is prevented by design as the cloning operation failures are reported
          to the application when the the LwSciSyncAttrList are passed on to the application
          (GID-SWAD-5301169) as LwSciWrap, takeVal interface will return error in that case.
    - LWSCISTREAM_SHARED_CAUSE_NA_004
    - LWSCISTREAM_SHARED_CAUSE_NA_013
    - id: LWSCISTREAM_CAUSE_NA_206
      description: Multiple threads try to update the LwSciSyncAttrList for the
        same destination index.
      na: This is prevented by design (GID-SWAD-5301167, GID-SWAD-5301168)
        as updates to the TrackArray(which tracks the LwSciSyncAttrList)
        is atomic(GID-SWAD-5132382, GID-SWAD-5132378) and only the set
        operation of the first thread will succeed.
        This is verified by integration testing(GID-TEST-5396305).
    - id: LWSCISTREAM_CAUSE_NA_207
      description: Multiple threads try to call LwSciSyncAttrListAppendUnreconciled
        with different LwSciSyncAttrList in Multicast block.
      na: This is prevented by design as the append operation is protected
        by mutex(GID-SWAD-5301226) and it is ilwoked only after the successful
        call to TrackArray, which prevents multiple updates to same destination
        index(GID-SWAD-5301167) and is verified by integration testing(GID-TEST-5396298).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SYNC_ATTR_FM_006
    description: LwSciStream writes memory not provided by application to write,
                 or modifies input LwSciSyncAttrList handles passed to it.
    class: Functionality unexpected
    local_effects: LwSciStream corruption
    external_effects: Application memory corruption.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B (GID-REQ-4637315)
    causes:
      - id: LWSCISTREAM_CAUSE_NA_501
        description: Internal failure in LwSciStream.
        na: Architecture does not fail in this way (GID-SWAD-5158110).

    evaluation: &shared_na_evaluation_wrong_write
      effectiveness: Medium
      justification: >-
        LwSciStream does not maintain a record of previously created or
        allocated resources. As such, it only operates using data passed
        into the API function call.

        Thus, the only possibility for a write to be performed on memory
        that is not provided by the application is if some pointer
        arithmetic is not performed correctly, the wrong address is used
        as input to some operation, or some buffer/stack overflow.

        Lwrrently the verification of this doesn't happen explicitly. Thus
        the only verification is what is lwrrently performed as part of
        normal PLC processes (Code Review, Code Inspection, Testing, etc.).

        For egregious cases we would expect this to be caught during Code
        Review, if not Code Inspection. In other cases, the failure should
        be sufficiently deterministic since the operation would be
        stateless and thus can be detected via a verification test.

        The verification methods employed by our current tests lwrrently
        only assert that a result is written in the given output parameter,
        but not the absence of some other write during the API call.
      actions:
        - ref: https://lwbugs/200755758
          description: >-
            Set up builds with AddressSanitizer enabled and ensure that AddressSanitizer
            doesn't report any errors
        - ref: https://lwbugs/200755758
          description: >-
            Run AddressSanitizer builds with a fuzzing harness
        - ref: https://lwbugs/200755758
          description: >-
            Consider running the test application in a emulator or under a
            hypervisor and explicitly mapping expected allocations/accesses
            on a byte-level such that any other writes to some memory
            location outside of memory provided as an input parameter cause
            a page fault or result in an error trap (potentially in combination
            with a fuzzer harness)

  - id: LWSCISTREAM_SYNC_ATTR_FM_003
    description: LwSciStream sends (valid but) wrong sync attributes to opposing blocks.
    class: Incorrect value
    local_effects: N/A
    external_effects: "1. Wrong sync attributes for reconciliation and object allocation\n\
      2. unpredictable behavior."
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B (GID-REQ-4637315)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_208
      description: Multicast unit fails to append all the un-reconciled attribute
        list from the consumers.
      na: This cause is prevented by multicast design, by using TrackArray to make
        sure all the sync attributes are appended(GID-SWAD-5284226).
        This is verified by the integration testing(GID-TEST-5356234).
    - LWSCISTREAM_SHARED_CAUSE_NA_013
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SYNC_ATTR_FM_004
    description: LwSciStream hangs while streaming sync attributes to
      opposing blocks.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-5456922, GID-REQ-4667133)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

######## Functionality :: Sync Count##################
- id: LWSCISTREAM_FUNC_STREAM_SYNC_COUNT
  description: Stream sync count between producer and consumer applications
  failure_modes:
  - id: LWSCISTREAM_SYNC_COUNT_FM_001
    description: LwSciStream fails to send, sync count, to opposing blocks.
    class: Functionality missing
    local_effects: Failure to stream sync object(s)
    external_effects: Application can hang waiting for the sync count or
      fail to stream sync objects.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B (GID-REQ-4667133)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_219
      description: Multicast unit fails to receive the Sync count from all the
        consumers.
      na: This cause is prevented by design as the multicast initializes a
        TrackArray receiving the sync count from consumer (GID-SWAD-5285954) and
        checks if it has received all the required Sync object/count from all
        consumers using the TrackArray(GID-SWAD-5301088). It is verified by
        integration testing(GID-TEST-5356234) that the cause is not present.
    - id: LWSCISTREAM_CAUSE_NA_235
      description: LwSciStream fails to perform Block::eventPost() to post the
        sync count event to inform the opposing blocks.
      na: The architecture does not fail in this way (GID-SWAD-5285956,
        GID-SWAD-5285804). It is verified by integration testing (GID-TEST-5356234)
        that this cause is not present.
    - id: LWSCISTREAM_CAUSE_NA_220
      description: Failure in TrackCount unit- pendingAction(), which does
        not perform the correct action to send the sync count to upstream and
        downstream blocks.
      na: This cause is prevented by design as pendingAction() is a simple
        operation and cannot fail in this way(GID-SWAD-5301171) and verified
        by integration testing(GID-TEST-5329265).
    - id: LWSCISTREAM_CAUSE_NA_221
      description: Failure in TrackCount unit- pendingEvent() to retrieve the
        sync count event in ipcsrc/IpcDst blocks.
      na: This cause is prevented by design as pendingEvent() is a simple
        operation(GID-SWAD-5301173) and is verified by integration testing(GID-TEST-5329269).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_SYNC_COUNT_FM_002
    description: LwSciStream wrongly transmits sync count multiple times.
    class: Functionality unexpected
    local_effects: LwSciStream could either hang waiting for LwSciSyncObj, which will
      not be provided by application or fail to send LwSciSyncObj(s).
    external_effects: "Application could hang waiting for LwSciSyncObj(s)"
    heavens_ref: N/A
    impact: ASIL-B (GID-REQ-4667133)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_223
      description: Multiple threads try to update the sync count.
      na: This is prevented by design as updates to the TrackCount (which
        stores the sync count) is atomic and only the set operation of the first
        thread will succeed(GID-SWAD-5285949, GID-SWAD-5285797,GID-SWAD-5301172).
        This is verified by integration testing(GID-TEST-5329252, GID-TEST-5280272,
        GID-TEST-5329797) and SWAD inspection(GID-SWAD-5140241).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_SYNC_COUNT_FM_003
    description: LwSciStream transmits incorrect sync count, to configurable blocks.
    class: Incorrect value
    local_effects: LwSciStream could either hang waiting for LwSciSyncObj (which will
      not be provided by application) or fail to send LwSciSyncObj(s).
    external_effects: "Application could hang waiting for LwSciSyncObj(s)"
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B (GID-REQ-4667133)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_009
    - LWSCISTREAM_SHARED_CAUSE_NA_004
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SYNC_COUNT_FM_004
    description: 'LwSciStream sets sync count after sending sync objects.'
    class: Incorrect timing
    local_effects: 'LwSciStream could hang waiting for LwSciSyncObj, which will not
      be provided by application'
    external_effects: "Application could hang waiting for LwSciSyncObj(s)"
    heavens_ref: N/A
    impact: ASIL-B (GID-REQ-4667133)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_228
      description: LwSciStream overwrites the sync count already set.
      na: This potential cause is NA, because the producer (GID-SWAD-5301068) and
        consumer(GID-SWAD-5301083), set the default sync count during object sharing.
        LwSciStream returns error if the sync count is set again by the application
        (GID-SWAD-5285797, GID-SWAD-5285949).
        The integration testing will definitely fail if the sync count is set multiple
        times(GID-TEST-5280272, GID-TEST-5329797).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SYNC_COUNT_FM_005
    description: LwSciStream hangs while streaming sync count to
      opposing blocks.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4667133)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

  - id: LWSCISTREAM_SYNC_COUNT_FM_006
    description: Multiple threads try to send the sync count but LwSciStream returns
                 success in some of the threads before sync count is actually sent.
                 (conlwrrency issue).
    class: Incorrect timing
    local_effects: Wrong internal state.
    external_effects: The application may fail to complete further initializations.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4667133)
    causes:
      - LWSCISTREAM_SHARED_CAUSE_NA_857
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
##################Functionality:: Sync Obj########################
- id: LWSCISTREAM_FUNC_STREAM_SYNC_OBJ
  description: Stream sync objects between producer and consumer applications
  failure_modes:
  - id: LWSCISTREAM_SYNC_OBJ_FM_001
    description: LwSciStream fails to send sync objects
    class: Functionality missing
    local_effects: 'Failure to stream'
    external_effects: Application fails to switch to streaming(packet will not
      be made available) as the Sync setup is incomplete(even though the
      application completes buffer setup).
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4668025)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_238
      description: Failure in TrackArray unit- performAction(), which does not
        perform the correct action to send the sync objects to upstream and
        downstream blocks.
      na: This cause is prevented by design as performAction() is a simple
        operation(GID-SWAD-5301167) and is verified by
        integration testing(GID-TEST-5396281, GID-TEST-5396282).
    - LWSCISTREAM_SHARED_CAUSE_NA_013
    - id: LWSCISTREAM_CAUSE_NA_240
      description: Failure in TrackArrayEvent used in Multicast to keep track
        of the sync objects received from all the consumers.
      na: This cause is prevented by design (GID-SWAD-5301088, GID-SWAD-5301168,
         GID-SWAD-5301169) and the multicast does not fail in this way. The integration
         testing(GID-TEST-5415328) will not pass if it were the case.
    - id: LWSCISTREAM_CAUSE_NA_239
      description: Failure in LwSciStream Common unit - uintAdd() to compute the
        total number of sync objects received from all consumers.
      na: This cause is prevented by design as the uintAdd() is a simple addition
       and cannot fail in this way(GID-SWAD-5301088, GID-SWAD-5158932). This is
       verified by integration testing(GID-TEST-5327465, GID-TEST-5327464).
    - id: LWSCISTREAM_CAUSE_NA_237
      description: LwSciStream fails to perform Block::eventPost() to post the
        SYNC_DESC event to inform the opposing blocks.
      na: The architecture does not fail in this way (GID-SWAD-5301075,
        GID-SWAD-5301090). It is verified by integration testing (GID-TEST-5356234)
        that this cause is not present.
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SYNC_OBJ_FM_002
    description: LwSciStream sends sync objects for the same syncIndex multiple
      times(first being the intended one).
    class: Functionality unexpected
    local_effects: N/A
    external_effects: Application could use the unintended sync object for sync
      operations like signaling, generating fence.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4627529, GID-REQ-4627528)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_241
      description: Multiple threads try to send the LwSciSyncObj for the same SyncIndex
      na: This is prevented by design as updates to the TrackArray is
        atomic and only the set operation of the first thread will succeed
        (GID-SWAD-5301068, GID-SWAD-5301083, GID-SWAD-5301167). This is
        verified by integration testing(GID-TEST-5280288,GID-TEST-5408221) and
        SWAD inspection(GID-SWAD-5129098).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_SYNC_OBJ_FM_003
    description: LwSciStream corrupts the LwSciSyncObj, during relaying of the data
      between opposing blocks
    class: Functionality unexpected
    local_effects: 'Failure to stream '
    external_effects: Application could use the unintended sync object for sync
      operations like signaling, generating fence.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4627529, GID-REQ-4627528)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_243
      description: Failure in LwSciWrap units to propagate the error while
        acquiring a new reference on LwSciSyncObj(GID-SWAD-5276646).
      na: This is prevented by design as the failures during acquiring references are reported
          to the application when the the LwSciSyncObj are passed on to the application
          (GID-SWAD-5301169) as LwSciWrap, takeVal interface will return error in that case.
    - LWSCISTREAM_SHARED_CAUSE_NA_004
    - LWSCISTREAM_SHARED_CAUSE_NA_013
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SYNC_OBJ_FM_006
    description: LwSciStream writes memory not provided by application to write,
                 or modifies input LwSciSyncObj handles passed to it.
    class: Functionality unexpected
    local_effects: LwSciStream corruption
    external_effects: Application memory corruption.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4627529, GID-REQ-4627528)
    causes:
      - id: LWSCISTREAM_CAUSE_NA_502
        description: Internal failure in LwSciStream.
        na: Architecture does not fail in this way (GID-SWAD-5158112).
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISTREAM_SYNC_OBJ_FM_004
    description: LwSciStream sends valid but incorrect sync object
    class: Incorrect value
    local_effects: Incorrect streaming
    external_effects: Wrong sync objects are used for wait and signal operations
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4627529, GID-REQ-4627528)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_013
    - id: LWSCISTREAM_CAUSE_NA_244
      description: TrackArray unit messes up the mapping between sync index and the
        corresponding sync object and sends a wrong sync object corresponding to
        a particular sync index.
      na: This potential cause is NA because the architecture does not fail in
        this way(GID-SWAD-5133227, GID-SWAD-5133240).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SYNC_OBJ_FM_005
    description: LwSciStream hangs while streaming sync objects to
      opposing blocks.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

##########Functionality:: Create packets ##########
- id: LWSCISTREAM_FUNC_CREATE_PACKETS
  description: Create Packets
  failure_modes:
  - id: LWSCISTREAM_CREATE_PACKET_FM_001
    description: LwSciStream fails to create a packet/associate cookie with a packet.
    class: Functionality missing
    local_effects: Fail to setup packets
    external_effects: Failure to stream
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_321
    - LWSCISTREAM_SHARED_CAUSE_NA_322
    - id: LWSCISTREAM_CAUSE_NA_323
      description: Failure in Block unit - pktFindByHandle() used in multicast
        to identify the existing packet in pktMap and not returning Packet pointer.
      na: This cause is prevented by design as pktFindByHandle is a simple operation
        and clearly does not fail in this way (GID-SWAD-5301957) and integration testing
        will ensure that the cause is not feasible(GID-TEST-5408631).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_PACKET_FM_002
    description: LwSciStream fails to send created packet to endpoints
    class: Functionality missing
    local_effects: Fail to setup packets
    external_effects: Failure to stream
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_004
    - id: LWSCISTREAM_CAUSE_NA_335
      description: Failure in Packet unit to prepare the PACKET_CREATE event.
      na: This cause is prevented by design as the Packet unit initialization
        is a simple operation(GID-SWAD-5301958, GID-SWAD-5194578)
        and integration testing will ensure that this cause is not feasible
        (GID-TEST-5408635, GID-TEST-5355760).
    - LWSCISTREAM_SHARED_CAUSE_NA_328
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_PACKET_FM_003
    description: LwSciStream rejects packet-create request even when packet
      limit is not reached
    class: Functionality missing
    local_effects: Fail to setup packets
    external_effects: Failure to stream
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_329
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_PACKET_FM_004
    description: LwSciStream fails to associate a packet with pool block
    class: Functionality missing
    local_effects: Fail to setup packets
    external_effects: Failure to stream
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_330
      description: Failure in Block unit while inserting the packet into the map
      na: This is prevented by design as packet insertion to map is a simple
        operation(GID-SWAD-5301958) and integration testing will ensure that the cause is not feasible(GID-TEST-5408635).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_PACKET_FM_005
    description: LwSciStream accepts packet-create request even when packet limit
      is reached
    class: Functionality unexpected
    local_effects: Incorrect setup
    external_effects: Application may fail to stream properly due to an incorrect
      setup.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_329
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_PACKET_FM_012
    description: LwSciStream writes memory not provided by application.
    class: Functionality unexpected
    local_effects: LwSciStream corruption
    external_effects: Application memory corruption.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
      - id: LWSCISTREAM_CAUSE_NA_503
        description: Internal failure in LwSciStream.
        na: Architecture does not fail in this way (GID-SWAD-5158115).
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISTREAM_CREATE_PACKET_FM_006
    description: LwSciStream creates a packet when there is no request
    class: Functionality unexpected
    local_effects: Resource exhaustion/unpredictable behavior.
    external_effects: Application may fail to create packet when needed due to
      resource exhaustion causing failure to stream.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_331
      description: LwSciStream creating extra packets when requested to create
        a single packet.
      na: Potential cause is NA as Block unit- pktCreate() clearly does not fail
        in this way(GID-SWAD-5301958). This is verified by integration testing
        (GID-TEST-5356233, GID-TEST-5356234).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_PACKET_FM_007
    description: LwSciStream associates same cookie with multiple packets
    class: Functionality unexpected
    local_effects: Incorrect setup
    external_effects: Application does not know the affected packet when packet
      related events oclwrs.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667547, GID-REQ-5422775)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_332
      description: Failure in block unit allowing multiple threads to create a
        packet at the same time with same cookie.
      na: This is prevented by design as there is a mutex lock which
        allows only one thread at a time to create a packet and once the other thread
        is allowed, it encounters an error as the cookie is already associated with
        the packet(GID-SWAD-5301958). This is verified by integration testing
        (GID-TEST-5408656).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_PACKET_FM_008
    description: LwSciStream returns invalid packet handle
    class: Functionality unexpected
    local_effects: LwSciStream could fail to perform further initialization setup.
    external_effects: Application cannot use the handle for any further operation.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667547, GID-REQ-5422775)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_334
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_PACKET_FM_009
    description: LwSciStream returns incorrect packet handle
    class: Incorrect value
    local_effects: LwSciStream could fail to perform further initialization setup.
    external_effects: Application may use the handle for any further operations
      which leads to incorrect stream setup.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667547, GID-REQ-5422775)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_334
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_PACKET_FM_010
    description: LwSciStream associates incorrect cookie with packet
    class: Incorrect value
    local_effects: Incorrect setup
    external_effects: Wrong cookie associated with packet makes application
      fail to identify the affected packet when packet-related events are returned.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667547, GID-REQ-5422775)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_321
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_PACKET_FM_011
    description: Creating packet hangs.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

############ Functionality:: Delete Packets #######
- id: LWSCISTREAM_FUNC_DELETE_PACKETS
  description: Delete Packets
  failure_modes:
  - id: LWSCISTREAM_DELETE_PACKET_FM_001
    description: LwSciStream fails to delete a packet or schedule a packet for
      deletion.
    class: Functionality missing
    local_effects: "1. The packet may be never destroyed, potentially leading to resource
        exhaustion."
    external_effects: "1.Subsequent operations on this packet by the application
       may have unpredictable behavior.
      2. Resource exhaustion."
    heavens_ref: T3_LwStreams_562
    impact: "ASIL-B(GID-REQ-4667152, GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441,
      GID-REQ-4668448)"
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_261
    - id: LWSCISTREAM_CAUSE_NA_262
      description: Failure in Block unit while erasing the packet from pktMap.
      na: This cause is prevented by design as removing a packet from map is
        a simple operation(GID-SWAD-5301959) and verified by
        integration testing(GID-TEST-5408632).
    - LWSCISTREAM_SHARED_CAUSE_NA_263
    - LWSCISTREAM_SHARED_CAUSE_NA_264
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_PACKET_FM_002
    description: LwSciStream does not notify producer and consumer about packet deletion
    class: Functionality missing
    local_effects: "1. Subsequent operations on this packet by the LwSciStream may
      have unpredictable behavior.
      2. The packet may be never destroyed, potentially
      leading to resource exhaustion."
    external_effects: "1.Subsequent operations on this packet by the application may
       have unpredictable behavior.
      2. Resource exhaustion."
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_264
    - id: LWSCISTREAM_CAUSE_NA_273
      description: Failure in packet unit to enqueue PACKET_DELETE event.
      na: This is prevented by design as scheduling a packet for deletion is
        a simple operation(GID-SWAD-5194583) and verified by integration testing
        (GID-TEST-5355756).
    - id: LWSCISTREAM_CAUSE_NA_274
      description: Failure in packet unit to retrieve the pending PAKCET_DELETE event
        which makes IpcSrc unit to fail to send deleted packet to other end.
      na: This is prevented by design as pendingEvent() retrieves the PACKET_DELETE
        event and architecture clearly does not fail in this way(GID-SWAD-5303977,
        GID-SWAD-5194595). This is verified by integration testing(GID-TEST-5366622).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_DELETE_PACKET_FM_003
    description: LwSciStream deletes a packet/schedules a packet for deletion when
      there is no request
    class: Functionality unexpected
    local_effects: Subsequent operations on this packet by the application may
       have unpredictable behavior
    external_effects: Incorrect streaming/streaming gets terminated
    heavens_ref: N/A
    impact: "ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)"
    causes:
    - id: LWSCISTREAM_CAUSE_NA_268
      description: LwSciStream schedules unintended packets for deletion along with
        the packet that is requested.
      na: Potential cause is NA as Packet unit- deleteSet() clearly does not fail
        in this way as it only schedules the requested packet for deletion
        (GID-SWAD-5194583, GID-SWAD-5303973).
        #TODO: Integration test needs to be added to check if LwSciStream not
        # deleting the unintended packets.
    measures:
    - id: LWSCISTREAM_MEAS_268
      description: LwSciStream detects and reports the failure mode by returning
        an error to the application for any subsequent operations on the deleted
        packet handles as pktFindByHandle() returns NULL.
      type: Detection and Reporting of Failure Mode
      refs: [21358281]
      tests: [TBD] #TODO: Test case needs to be added for passing invalid packet handles.
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_DELETE_PACKET_FM_004
    description: LwSciStream schedules a deleted-packet for deletion
    class: Functionality unexpected
    local_effects: unpredictable behavior
    external_effects: Incorrect streaming.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_270
      description: LwScistream scheduling a deleted packet.
      na: Potential cause is NA because architecture clearly does not fail
        in this way as it reports an error to application if deleted handles are passed
        (GID-SWAD-5303973, GID-SWAD-5301957) and integration tests will not pass
        if this is the case(GID-TEST-5329164).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_DELETE_PACKET_FM_005
    description: LwSciStream schedules a packet for deletion twice.
    class: Functionality unexpected
    local_effects: unpredictable behavior
    external_effects: Incorrect streaming
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_261
    - id: LWSCISTREAM_CAUSE_NA_272
      description: Multiple threads are trying to schedule same packet for deletion
        using packet unit- deleteSet().
      na: This is prevented by design as the set operation is atomic and
        only the first thread will be successful(GID-SWAD-5194583). It is
        verified by integration testing(GID-TEST-5355755).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_DELETE_PACKET_FM_006
    description: LwSciStream deletes/schedules incorrect packet
    class: Incorrect value
    local_effects: Incorrect streaming
    external_effects: Subsequent operations on the packet triggers errors
    heavens_ref: T3_LwStreams_562
    impact: "ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)"
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_266
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_DELETE_PACKET_FM_007
    description: LwsciStream deletes a packet before it's returned to the pool
     block.
    class: Incorrect timing
    local_effects: Incorrect streaming
    external_effects: unpredictable behavior
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_269
      description: Failure in packet unit while extracting the payload from the
        payload queue in the pool block using 'PayloadQ::extract()' interface.
      na: This cause is prevented by design as extract() is a simple operation
        and it clearly does not fail in this way(GID-SWAD-5194605) and is verified by
        integration testing(GID-TEST-5355771, GID-TEST-5366628).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_PACKET_FM_008
    description: Deleting packet hangs.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

############ Functionality:: Accept Packets #######
- id: LWSCISTREAM_FUNC_ACCEPT_PACKET
  description: "Receive packet acceptance status from producer and consumer
    applications"
  failure_modes:
  - id: LWSCISTREAM_ACCEPT_PACKET_FM_001
    description: LwSciStream fails to notify pool block about the endpoint packet
      status
    class: Functionality missing
    local_effects: LwSciStream fails to complete packet setup
    external_effects: Unable to proceed to streaming
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4676875, GID-REQ-4667547, GID-REQ-4681347)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_341
      description: Failure in Packet unit- packetStatusAction() to send the packet
        status upstream/downstream.
      na: This cause is prevented by design as packetStatusAction() is a simple
        operation and cannot fail in this way(GID-SWAD-5194587). This is
        verified by integration testing(GID-TEST-5355728, GID-TEST-5366614).
    - LWSCISTREAM_SHARED_CAUSE_NA_263
    - id: LWSCISTREAM_CAUSE_NA_346
      description: Failure in Packet unit - packetStatusEventsDone() used by
        multicast for tracking the status events from various consumers.
      na: This is prevented by design as the packetStatusEventsDone() performs simple
        operations(GID-SWAD-5301307, GID-SWAD-5194593) and integration testing will not
        pass if this is the case(GID-TEST-5355747, GID-TEST-5355746).
    - id: LWSCISTREAM_CAUSE_NA_347
      description: Failure in packet unit - packetStatusEventPrepare() while
        preparing the packet status events(PACKET_STATUS_CONSUMER,
        PACKET_STATUS_PRODUCER).
      na: This is prevented by design as preparing the packet status event is a
        simple operation(GID-SWAD-5301302, GID-SWAD-5301312, GID-SWAD-5194589)
        and integration testing ensures that this cause is not feasible(GID-TEST-5355736,
        GID-TEST-5366623).
        #TODO: Test case to add for PACKET_STATUS_CONSUMER event.
    - id: LWSCISTREAM_CAUSE_NA_349
      description: Failure in packet unit - pendingEvent() to retrieve the pending
        event(PACKET_STATUS_CONSUMER) in IpcDst and Multicast blocks.
      na: This is prevented by design as pendingEvent() retrieves the PACKET_STATUS_CONSUMER
        event and architecture clearly does not fail in this way(GID-SWAD-5194595,
        GID-SWAD-5301310, GID-SWAD-5301307).
        #TODO: Test case to add for PACKET_STATUS_CONSUMER event.
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_ACCEPT_PACKET_FM_002
    description: LwSciStream fails to associate cookie with the packet
    class: Functionality missing
    local_effects: LwSciStream fails to complete packet setup
    external_effects: Unable to proceed to streaming
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4676875, GID-REQ-4667547, GID-REQ-4681347)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_351
      description: Failure in packet unit - packetStatusAction() while storing
        the cookie with packet.
      na: This is prevented by design as storing the cookie is a simple operation
        and architecture cannot fail in this way(GID-SWAD-5194587). integration testing
        ensures that this cause is not feasible(GID-TEST-5355728).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_ACCEPT_PACKET_FM_003
    description: LwSciStream fails to accept a packet
    class: Functionality missing
    local_effects: LwSciStream fails to complete packet setup
    external_effects: Unable to proceed to streaming
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4676875, GID-REQ-4667547, GID-REQ-4681347)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_350
    - LWSCISTREAM_SHARED_CAUSE_NA_360
    - id: LWSCISTREAM_CAUSE_NA_361
      description: Failure in packet unit - statusEventRejectedCheck() returning
        packet status as rejected even though the packet statuses received
        from all endpoints are 'success'.
      na: This is prevented by design as combining the packet status from endpoints
        is a simple operation and can never go wrong(GID-SWAD-5194591,
        GID-SWAD-5301953) and integration testing will ensure that this cause is
        not present(GID-TEST-5355742, GID-TEST-5329132).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_ACCEPT_PACKET_FM_004
    description: LwSciStream accepts packet even when the status is not 'Success'
    class: Functionality unexpected
    local_effects: Incorrect packet setup
    external_effects: Application may receive other packet-related events on
      the rejected packet
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4676875, GID-REQ-4676874, GID-REQ-4668025)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_360
    - id: LWSCISTREAM_CAUSE_NA_362
      description: Failure in packet unit - statusEventRejectedCheck() returning
        packet status as 'success' even though the packet status received
        from one of the endpoint is not success.
      na: This is prevented by design as combining the packet status from endpoints
        is a simple operation and can never go wrong(GID-SWAD-5194591,
        GID-SWAD-5301953) and integration testing will ensure that this cause is
        not present(GID-TEST-5355741, GID-TEST-5329132).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_ACCEPT_PACKET_FM_005
    description: LwSciStream accepts packet even when the statuses not received from
      all endpoints
    class: Functionality unexpected
    local_effects: Incorrect packet setup
    external_effects: Incorrect streaming.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4676875, GID-REQ-4676874, GID-REQ-4668025)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_350
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_ACCEPT_PACKET_FM_006
    description: LwSciStream wrongly transmits packet status multiple times
    class: Functionality unexpected
    local_effects: Incorrect packet setup
    external_effects: Application may not be able to setup the packet correctly
      which causes failure to stream.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_355
      description: Failure in Packet unit - packetStatusAction() when multiple
        threads trying to send the packet status for the same packet.
      na: This is prevented by design as the packetStatusAction() performs
        a internal state change atomically which ensures that the packet status
        is sent only once(GID-SWAD-5194587) and the same verified by integration
        testing(GID-TEST-5355727) and SWAD inspection(GID-SWUD-5194527).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_ACCEPT_PACKET_FM_008
    description: LwSciStream sends incorrect packet status to pool(Sending
      'success' instead of 'rejection')
    class: Incorrect value
    local_effects: LwSciStream fails to complete packet setup
    external_effects: Pool application may use the packet rejected by
      endpoint(producer/consumer) applications as it received the 'success' status.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4676875, GID-REQ-4676874, GID-REQ-4668025)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_360
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_ACCEPT_PACKET_FM_009
    description: LwSciStream associates cookie with the incorrect packet
    class: Incorrect value
    local_effects: LwSciStream posts incorrect event information for packet
      related events.
    external_effects: Querying for packet related events returns incorrect
      information as part of event structure.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4681050)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_266
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_ACCEPT_PACKET_FM_010
    description: Accepting packet hangs.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

############ Functionality:: Create Blocks #######
- id: LWSCISTREAM_FUNC_CREATE_BLOCKS
  description: Create blocks
  failure_modes:
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_001
    description: LwSciStream fails to create producer block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Application will be blocked to connect stream as at least one
      producer needed.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_401
      description: Failure in Block unit - while performing the producer
        block initialization.
      na: This is prevented by design as Block initialization is a simple
        operation(GID-SWAD-5275890, GID-SWAD-5138068, GID-SWAD-5154330) and
        verified by integration testing(GID-TEST-5364758).
    - LWSCISTREAM_SHARED_CAUSE_NA_402
    - id: LWSCISTREAM_CAUSE_NA_404
      description: Failure in Public API unit to bind pool block with producer block.
      na: This is prevented by design as Public API unit(GID-SWAD-5275890) relies
        on safeconnection(GID-SWAD-5275876, GID-SWAD-5275877, GID-SWAD-5275878,
        GID-SWAD-5275879) which cannot fail in this way and integration testing will
        ensure that the cause is not present(GID-TEST-5364758).
    - id: LWSCISTREAM_CAUSE_NA_405
      description: Failure in block unit - getHandle() to return the block handle.
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5275890, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5408617, GID-TEST-5364758).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_002
    description: LwSciStream fails to create consumer block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Application will be blocked to connect stream as at least one
      consumer needed.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_406
      description: Failure in Block unit - while performing the consumer
        block initialization.
      na: This is prevented by design as the Block initialization is a simple
        operation(GID-SWAD-5275911, GID-SWAD-5139025, GID-SWAD-5154330) and
        verified by integration testing(GID-TEST-5364763).
    - id: LWSCISTREAM_CAUSE_NA_407
      description: Failure in Public API unit to bind queue block with consumer block.
      na: This is prevented by design as Public API unit(GID-SWAD-5275911) relies
        on safeconnection(GID-SWAD-5275876, GID-SWAD-5275877, GID-SWAD-5275878,
        GID-SWAD-5275879) which cannot fail in this way and integration testing will
        ensure that the cause is not present(GID-TEST-5364763).
    - id: LWSCISTREAM_CAUSE_NA_408
      description: Failure in Block unit - getHandle() to return the block handle
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5275911, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5364763, GID-TEST-5408617).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_003
    description: LwSciStream fails to create static pool block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Fail to setup stream
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_409
      description: Failure in Block unit - while performing the pool block
        initialization.
      na: This is prevented by design as the Block initialization is simple
        (GID-SWAD-5275909, GID-SWAD-5155667, GID-SWAD-5154330) and verified by
        integration testing(GID-TEST-5364768).
    - id: LWSCISTREAM_CAUSE_NA_410
      description: Failure in Block unit - getHandle() to return the block handle
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5275909, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5364768, GID-TEST-5408617).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_004
    description: LwSciStream fails to create mailbox queue block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Fail to setup stream
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_411
      description: Failure in Block unit - while performing the queue(mailbox)
        block initialization.
      na: This is prevented by design as Block initialization is a simple
        operation(GID-SWAD-5275914, GID-SWAD-5150804, GID-SWAD-5154330) and
        verified by integration testing(GID-TEST-5364772).
    - id: LWSCISTREAM_CAUSE_NA_412
      description: Failure in Block unit - getHandle() to return the block handle
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5275914, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5364772, GID-TEST-5408617).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_005
    description: LwSciStream fails to create fifo queue block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Fail to setup stream
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_413
      description: Failure in Block unit - while performing the queue(FIFO)
        block initialization
      na: This is prevented by design as Block initialization is a simple
        operation(GID-SWAD-5275910, GID-SWAD-5150805, GID-SWAD-5154330) and
        verified by integration testing(GID-TEST-5364775).
    - id: LWSCISTREAM_CAUSE_NA_414
      description: Failure in block unit - getHandle() to return the block handle
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5275910, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5364775, GID-TEST-5408617).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_006
    description: LwSciStream fails to create multicast block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Fail to setup stream for multicast use case.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_415
      description: Failure in Block unit - while performing the multicast
        block initialization.
      na: This is prevented by design as Block initialization is a simple
        operation(GID-SWAD-5275915, GID-SWAD-5157361, GID-SWAD-5154330) and
        verified by integration testing(GID-TEST-5364778).
    - id: LWSCISTREAM_CAUSE_NA_416
      description: Failure in block unit - getHandle() to return the block handle
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5275915, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5364778, GID-TEST-5408617).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_007
    description: LwSciStream fails to create IpcSrc block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Fail to setup stream for Inter-process use case.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_417
      description: Failure in Block unit - while performing the IpcSrc
        block initialization
      na: This is prevented by design as the Block initialization is a simple
       operation(GID-SWAD-5275912, GID-SWAD-5154815, GID-SWAD-5154330) and
       verified by integration testing(GID-TEST-5364861).
    - LWSCISTREAM_SHARED_CAUSE_NA_418
    - id: LWSCISTREAM_CAUSE_NA_419
      description: Failure in block unit - getHandle() to return the block handle.
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5275912, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5364861, GID-TEST-5408617).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_008
    description: LwSciStream fails to create IpcDst block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Fail to setup stream for Inter-process use case.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_420
      description: Failure in Block unit - while performing the IpcDst
        block initialization.
      na: This is prevented by design as the Block initialization is a simple
        operation(GID-SWAD-5275913, GID-SWAD-5158232, GID-SWAD-5154330) and
        verified by integration testing(GID-TEST-5364865).
    - LWSCISTREAM_SHARED_CAUSE_NA_418
    - id: LWSCISTREAM_CAUSE_NA_423
      description: Failure in block unit - getHandle() to return the block handle.
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5275913, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5364865, GID-TEST-5408617).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_009
    description: LwSciStream fails to create limiter block and return handle
    class: Functionality missing
    local_effects: Fail to connect blocks on subsequent block connect operations
    external_effects: Fail to setup stream
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_424
      description: Failure in Block unit - while performing the Limiter
        block initialization.
      na: This is prevented by design as the Block initialization is a simple
        operation(GID-SWAD-5282346, GID-SWAD-5280091, GID-SWAD-5154330) and
        verified by integration testing(GID-TEST-5364858).
    - id: LWSCISTREAM_CAUSE_NA_425
      description: Failure in block unit - getHandle() to return the block handle.
      na: This is prevented by design as retrieving a block handle is a simple
        operation(GID-SWAD-5282346, GID-SWAD-5154326) and verified by integration
        testing(GID-TEST-5364858, GID-TEST-5408617).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_010
    description: LwSciStream fails to associate IpcSrc with input IPC channel,
      LwSciSync and LwSciBuf module.
    class: Functionality missing
    local_effects: subsequent operations using the IPC endpoint, LwSciSync
      module or LwSciBuf module may have unexpected behavior.
    external_effects: Fail to setup stream
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_426
      description: Failure in created IpcSrc block instance to store the
        LwSciSync/LwSciBuf/Ipc Channel information.
      na: This is prevented by design as storing this information is a simple
        operation and cannot fail in this way(GID-SWAD-5275912). This is
        verified by integration testing(GID-TEST-5364861).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_011
    description: LwSciStream fails to associate IpcDst with input IPC channel,
      LwSciSync and LwSciBuf module
    class: Functionality missing
    local_effects: subsequent operations using the IPC endpoint, LwSciSync
      module or LwSciBuf module may have unexpected behavior.
    external_effects: Fails to setup stream.
    heavens_ref: T3_LwStreams_566
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_427
      description: Failure in created IpcDst block instance to store the
        LwSciSync/LwSciBuf/Ipc Channel information.
      na: This is prevented by design as storing this information is a simple
        operation and cannot fail in this way(GID-SWAD-5275913). This is
        verified by integration testing(GID-TEST-5364865).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_012
    description: LwSciStream doesn't use the same LwSciIpc endpoint provided
      by the application.
    class: Functionality missing
    local_effects: unpredictable behavior during IPC communication
    external_effects: Fail to communicate with other process
    heavens_ref: T3_LwStreams_566
    impact: ASIL-B(GID-REQ-4667151, GID-REQ-5430026, GID-REQ-4667540,
      GID-REQ-5456925GID-REQ-4667547, GID-REQ-5456922, GID-REQ-4667133,
      GID-REQ-4667152, GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4668202,
      GID-REQ-4668448, GID-REQ-4668613)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_437
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_013
    description: LwSciStream fail to ensure LwSciIpc endpoints provided by
      application are immutable
    class: Functionality missing
    local_effects: unpredictable behavior during IPC communication
    external_effects: Fail to communicate with other process
    heavens_ref: T3_LwStreams_566
    impact: ASIL-B(GID-REQ-4667151, GID-REQ-5430026, GID-REQ-4667540,
      GID-REQ-5456925GID-REQ-4667547, GID-REQ-5456922, GID-REQ-4667133,
      GID-REQ-4667152, GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4668202,
      GID-REQ-4668448, GID-REQ-4668613)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_437
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_014
    description: LwSciStream does not use the same Communication Sets as LwSciIpc
    class: Functionality missing
    local_effects: unpredictable behavior during IPC communication
    external_effects: Fail to communicate with other process
    heavens_ref: T3_LwStreams_566
    impact: ASIL-B(GID-REQ-4667151, GID-REQ-5430026, GID-REQ-4667540,
      GID-REQ-5456925GID-REQ-4667547, GID-REQ-5456922, GID-REQ-4667133,
      GID-REQ-4667152, GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4668202,
      GID-REQ-4668448, GID-REQ-4668613)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_437
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_015
    description: LwSciStream does not use unique Session Identifier for each Intra-VM
      Channel
    class: Functionality missing
    local_effects: unpredictable behavior during IPC communication
    external_effects: Fail to communicate with other process
    heavens_ref: T3_LwStreams_566
    impact: ASIL-B(GID-REQ-4667151, GID-REQ-5430026, GID-REQ-4667540,
      GID-REQ-5456925GID-REQ-4667547, GID-REQ-5456922, GID-REQ-4667133,
      GID-REQ-4667152, GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4668202,
      GID-REQ-4668448, GID-REQ-4668613)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_437
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_016
    description: LwSciStream does not use LwSciIpc channels for communication between
      Guest OS User Processes
    class: Functionality missing
    local_effects: unpredictable behavior during IPC communication
    external_effects: Fail to communicate with other process
    heavens_ref: T3_LwStreams_566
    impact: ASIL-B(GID-REQ-4667151, GID-REQ-5430026, GID-REQ-4667540,
      GID-REQ-5456925GID-REQ-4667547, GID-REQ-5456922, GID-REQ-4667133,
      GID-REQ-4667152, GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4668202,
      GID-REQ-4668448, GID-REQ-4668613)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_440
      description: Failure in LwSciStream units to use the LwSciIpc channels.
      na: Potential cause is NA as LwSciStream relies on QNX_BSP::LwSciIpc
        for transmitting data across QNX_System user processes within a QNX VM boundary
        (GID-SWAD-5333487, GID-SWAD-5275862, GID-SWAD-5275926, GID-SWAD-5275927).
        #TODO: Implement a integration test for inter-process use case.
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_017
    description: LwSciStream returns same handle for different block instances.
    class: Functionality unexpected
    local_effects: Incorrect setup
    external_effects: Fail to setup stream
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_428
    - id: LWSCISTREAM_CAUSE_NA_429
      description: Multiple threads try to create a multiple blocks at the same
        time and block unit assigning same handle.
      na: This is prevented by design as the assigning handle to a particular
        block is done under a block lock. So same handle will never be assigned to
        more than one block(GID-SWAD-5275909,GID-SWAD-5275890, GID-SWAD-5275910,
        GID-SWAD-5275914, GID-SWAD-5275911, GID-SWAD-5275912, GID-SWAD-5275913,
        GID-SWAD-5275915, GID-SWAD-5282346). This is verified by integration testing
        (GID-TEST-5364768, GID-TEST-5364758, GID-TEST-5364775, GID-TEST-5364772,
        GID-TEST-5364763, GID-TEST-5364861, GID-TEST-5364865, GID-TEST-5364778,
        GID-TEST-5364858).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_023
    description: LwSciStream writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwSciStream corruption
    external_effects: Application memory corruption.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663976)
    causes:
      - id: LWSCISTREAM_CAUSE_NA_504
        description: Internal failure in LwSciStream.
        na: Architecture does not fail in this way (GID-SWAD-5158101, GID-SWAD-5158102,
            GID-SWAD-5158103, GID-SWAD-5158104, GID-SWAD-5158105, GID-SWAD-5158106,
            GID-SWAD-5158107, GID-SWAD-5158108).
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_019
    description: LwSciStream creates a block for invalid block type (not listed in
      the requirement GID-REQ-4663974)
    class: Functionality unexpected
    local_effects: Incorrect setup
    external_effects: Fail to setup stream
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_430
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_020
    description: LwSciStream creates a block when there is no request
    class: Functionality unexpected
    local_effects: Resource exhaustion.
    external_effects: Incorrect setup/Resource exhaustion
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_431
      description: LwSciStream creating unintended blocks along with the requested
        block.
      na: Potential cause is NA as LwSciStream architecture clearly does not fail
        in this way(GID-SWAD-5275909, GID-SWAD-5275890, GID-SWAD-5275910, GID-SWAD-5275914,
        GID-SWAD-5275911, GID-SWAD-5275912, GID-SWAD-5275913, GID-SWAD-5275915,
        GID-SWAD-5282346). This is verified by integration testing(GID-TEST-5407991).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_CREATE_BLOCKS_FM_021
    description: 'LwSciStream creates incorrect block when requested (ex: Creating
      consumer block when producer block is requested)'
    class: Incorrect value
    local_effects: Incorrect setup
    external_effects: Fail to setup stream
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_430
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_CREATE_BLOCKS_FM_022
    description: Creating block hangs.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4663976)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

###############Functionality- Delete Blocks ############
- id: LWSCISTREAM_FUNC_DELETE_BLOCKS
  description: Delete Blocks
  failure_modes:
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_001
    description: LwSciStream fails to schedule a block for deletion
    class: Functionality missing
    local_effects: 1. block is still available for use and subsequent operations
      on this block by the LwSciStream may have unpredictable behavior.
      2. The block may be never destroyed, potentially leading to resource exhaustion.
    external_effects: "1. The application may continue performing the operations
      on the block.
      2. Resource exhaustion."
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448,
      GID-REQ-4663977)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_291
      description: Failure in Safeconnection unit - disconnect() to update the
        connection state to disconnect.
      na: This cause is prevented by design as the disconnect() is a simple
        operation which cannot fail in this way(GID-SWAD-5114287,
        GID-SWAD-5278542, GID-SWAD-5278541) and integration testing will ensure
        that this cause is not feasible(GID-TEST-5302909, GID-TEST-5302910).
    - id: LWSCISTREAM_CAUSE_NA_292
      description: Failure in Block unit - disconnectDst() and disconnectSrc() while
        disconnecting destination and source block.
      na: This cause is prevented by design as disconnecting source and destination
        safeconnection is a simple operation(GID-SWAD-5278541,GID-SWAD-5278542,
        GID-SWAD-5154341, GID-SWAD-5154342) and integration testing will ensure
        that this cause is not feasible(GID-TEST-5365399).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_002
    description: LwSciStream doesn't make the block unavailable for any further use
    class: Functionality missing
    local_effects: 1. block is still available for use and resources are not released
      which causes resource exhaustion
    external_effects: "1. The application may continue performing the operations on
      the block.
      2. Resource exhaustion."
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448,
      GID-REQ-4663977)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_295
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_003
    description: LwSciStream doesn't delete the block and release resources associated
      with it when the block is not connected to any other block.
    class: Functionality missing
    local_effects: 1. block is still available for use and resources are not released
      which causes resource exhaustion
    external_effects: "1. The application may continue performing the operations
      on the block.
      2. Resource exhaustion."
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448,
      GID-REQ-4663977)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_297
      description: Failure in block destructors while freeing the resources.
      na: This cause is prevented by design(GID-SWAD-5327347, GID-SWAD-5275887)
        and verified by integration testing(GID-TEST-5365399).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_004
    description: LwSciStream doesn't notify every other blocks in the stream about
      the block that is lwrrently to be deleted
    class: Functionality missing
    local_effects: 1. Other blocks may continue calling functions on the deleted block.
      2. The block may never be deleted and the resource not released.
    external_effects: Subsequent operation on this block by the application may have
      unpredictable behavior.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448,
      GID-REQ-4663977)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_295
    - id: LWSCISTREAM_CAUSE_NA_306
      description: Failure in Block unit- preparing incorrect event for delete blocks.
      na: This cause is prevented by design as the architecture clearly does not
        fail in this way(GID-SWAD-5326300) and integration testing will ensure that
        this cause is not feasible(GID-TEST-5408628).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_005
    description: LwSciStream deletes the same block twice
    class: Functionality unexpected
    local_effects: N/A
    external_effects: undefined behavior
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448,
      GID-REQ-4663977)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_302
      description: Multiple threads tries to delete the same block.
      na: When multiple threads are triggered for deleting the same block,
        only the first thread updates the state to disconnecting and other thread
        just returns without performing any action(GID-SWAD-5114287).
        #TODO: Add test case for deleting same block using multiple threads.
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_DELETE_BLOCKS_FM_006
    description: LwSciStream deletes blocks when not requested
    class: Functionality unexpected
    local_effects: Abnormal stream termination
    external_effects: Failure to stream.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448,
      GID-REQ-4663977)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_303
      description: LwSciStream deleting an unintended block along with block
        that is requested to delete.
      na: Potential cause is NA as Block unit- removeRegisteredBlock() deletes
        only the requested block and architecture clearly does not fail in this
        way(GID-SWAD-5275882). This is verified by integration testing
        (GID-TEST-5365399).
    measures:
    - id: LWSCISTREAM_MEAS_303
      description: LwSciStream detects and reports the failure mode by returning
        an error to the application for any subsequent operations on the deleted
        block as getRegisteredBlock() returns NULL.
      type: Detection and Reporting of Failure Mode
      refs: [20996109]
      tests: [TBD] #TODO: Test case needs to be added for passing invalid block handles.
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_007
    description: 'LwSciStream deletes the block when the block is still connected '
    class: Functionality unexpected
    local_effects: Subsequent operation on this block may have unpredictable behavior.
    external_effects: unpredictable behavior
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448,
      GID-REQ-4663977)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_304
      description: Failure in safeconnection unit - while storing and retrieving the
        connect state and reference counter.
      na: This cause is prevented by design(GID-SWAD-5278541, GID-SWAD-5278542,
        GID-SWAD-5278539, GID-SWAD-5278538) and integration testing will not
        pass if the cause is present(GID-TEST-5365399).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_008
    description: LwSciStream notifies the other blocks even though blocks were not
      deleted
    class: Functionality unexpected
    local_effects: Incorrect termination of streaming
    external_effects: Abnormal streaming termination.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_295
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_009
    description: LwSciStream deletes incorrect block/schedules the incorrect block
      for deletion
    class: Incorrect value
    local_effects: "1. The block should be deleted may be never destroyed, potentially
        leading to resource exhaustion.
      2. Subsequent operations on this wrongly deleted block by LwSciStream may
        have unpredictable behavior."
    external_effects: unpredictable behavior
    heavens_ref: T3_LwStreams_562
    impact: "ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)"
    causes:
      na: All causes are heavily shared (LWSCISTREAM_SHARED_CAUSE_NA_003)
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_DELETE_BLOCKS_FM_010
    description: LwSciStream deletes block before the packet gets acquired by
      consumer.
    class: Incorrect timing
    local_effects: Packet and Block resources will be released.
    external_effects: Consumer fails to acquire the packet for consumer processing.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668441)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_310
      description: Failure in Queue unit- srcDisconnect() which incorrectly
        notifies the downstream about the disconnect even though the packet
        available in the queue to acquire.
      na: Potential cause is NA as notifying downstream about the disconnect
        cannot fail in this way(GID-SWAD-5326310) and integration test will not
        pass if it were the case.
        #TODO: Integration test needs to be added for checking the scenario
        # of deleting a block after producer presents its packet.
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_DELETE_BLOCKS_FM_011
    description: Deleting block hangs.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

############################### Buf Obj #######################################
- id: LWSCISTREAM_FUNC_REGISTER_MEM_OBJ
  description: Register memory objects
  failure_modes:
  - id: LWSCISTREAM_FUNC_REGISTER_MEM_OBJ_FM_001
    description: LwSciStream doesn't send the buffer object to the producer and
      consumer endpoints.
    class: Functionality missing
    local_effects: N/A
    external_effects: The application may hang. Could not finish the setup and
      proceed to normal operation state.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_263
    - id: LWSCISTREAM_CAUSE_NA_801
      description: Failure in packet unit - deleteGet(), which reports deletion
        of the packet by mistake.
      na: deleteGet() is a simple operation (GID-SWAD-5194584) and the integration
        testing (GID-TEST-5355758, GID-TEST-5355757) will ensure that this
        cause is not feasible.
    - id: LWSCISTREAM_CAUSE_NA_802
      description: Failure in packet unit - bufferDefineAction(), which doesn't
        perform the correct action to send the buffer object to upstream and
        downstream blocks.
      na: This cause is prevented by design (GID-SWAD-5301317, GID-SWAD-5301323)
        and verified by integration testing (GID-TEST-5355719).
    - id: LWSCISTREAM_CAUSE_NA_807
      description: Failure in packet unit - bufferDefineEventPrepare(), which
        doesn't trigger the prepareEvent() API of TrackArray.
      na: This cause is prevented by design (GID-SWAD-5301318, GID-SWAD-5301319,
        GID-SWAD-5301322, GID-SWAD-5301324) and verified by integration testing
        (GID-TEST-5355724).
    - LWSCISTREAM_SHARED_CAUSE_NA_013
    - LWSCISTREAM_SHARED_CAUSE_NA_004
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_FUNC_REGISTER_MEM_OBJ_FM_002
    description: LwSciStream sends the buffer object to the producer and
      consumer endpoints even when the packet that the buffer object belongs to
      is not associated with the pool block.
    class: Functionality unexpected
    local_effects: Subsequent LwSciStream operations may have unpredictable
      behavior.
    external_effects: The application could not register the received
      LwSciBufObj associated with the corresponding packet.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_266
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_FUNC_REGISTER_MEM_OBJ_FM_003
    description: LwSciStream sends invalid buffer object to the producer and
      consumer endpoints.
    class: Functionality unexpected
    local_effects: N/A
    external_effects: Subsequent operations on LwSciBufObj by the application
      may have unpredictable behavior.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_806
      description: Failure in LwSciWrap units to propagate the error of
        acquiring a new reference on LwSciBuf.
      na: Producer and consumer units will validate the LwSciBufObj in the
        LwSciWrap using viewVal() interface and propogate the error to the
        application (LWSTRMS52-SWAD-6415, GID-SWAD-5301318, GID-SWAD-5301319).
        It's also verified by integration testing (GID-TEST-5280329, GID-TEST-5329846).
    - LWSCISTREAM_SHARED_CAUSE_NA_004
    - LWSCISTREAM_SHARED_CAUSE_NA_820
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_FUNC_REGISTER_MEM_OBJ_FM_007
    description: LwSciStream writes memory not provided by application to write,
                   or modifies input LwSciBufObj handles passed to it.
    class: Functionality unexpected
    local_effects: LwSciStream corruption
    external_effects: Application memory corruption.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
      - id: LWSCISTREAM_CAUSE_NA_505
        description: Internal failure in LwSciStream.
        na: Architecture does not fail in this way (GID-SWAD-5158116).
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISTREAM_FUNC_REGISTER_MEM_OBJ_FM_004
    description: LwSciStream sends wrong buffer object to the producer and
      consumer endpoints.
    class: Incorrect value
    local_effects: N/A
    external_effects: Subsequent operations on LwSciBufObj by the application
      may have unpredictable behavior.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_822
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_FUNC_REGISTER_MEM_OBJ_FM_005
    description: LwSciStream sends other event type other than
      LwSciStreamEventType_PacketElement to the producer and consumers.
    class: Incorrect value
    local_effects: N/A
    external_effects: The producer/consumer application could not receive the
      LwSciBufObj and may hang.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_821
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_FUNC_REGISTER_MEM_OBJ_FM_006
    description: Registering an memory object hang.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

########################### Accept Packet Element #############################
- id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT
  description: Accept packet element
  failure_modes:
  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_001
    description: LwSciStream fails to notify pool block about the endpoint
      status of the new packet element.
    class: Functionality missing
    local_effects: N/A
    external_effects: The application may hang. Could not finish the setup and
      proceed to normal operation state.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_263
    - LWSCISTREAM_SHARED_CAUSE_NA_851
    - LWSCISTREAM_SHARED_CAUSE_NA_852
    - LWSCISTREAM_SHARED_CAUSE_NA_013
    - LWSCISTREAM_SHARED_CAUSE_NA_853
    - LWSCISTREAM_SHARED_CAUSE_NA_854
    - LWSCISTREAM_SHARED_CAUSE_NA_855
    - LWSCISTREAM_SHARED_CAUSE_NA_004
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_002
    description: LwSciStream fails to accept the packet element when all
      endpoints accept the element.
    class: Functionality missing
    local_effects: &lwscistream_acpt_pkt_elem_fm_002_local_effect
      Subsequent LwSciStream operations on this packet may have unexpected
      behavior.
    external_effects: &lwscistream_acpt_pkt_elem_fm_002_ext_effect
      - Pool application may receive incorrect acceptance-status of the element.
      - Pool application may use the rejected element in the subsequent
        operation, which may have unexpected behavior.
      - Pool application may never use the element accepted by the application,
        which may lead to not enough buffer for normal operation.
    heavens_ref: N/A
    impact: &lwscistream_acpt_pkt_elem_fm_002_impact
      ASIL-B (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes: &lwscistream_acpt_pkt_elem_fm_002_causes
    - LWSCISTREAM_SHARED_CAUSE_NA_852
    - LWSCISTREAM_SHARED_CAUSE_NA_853
    - LWSCISTREAM_SHARED_CAUSE_NA_854
    evaluation: &lwscistream_acpt_pkt_elem_fm_002_evaluation
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_008
    description: LwSciStream accepts the packet element even when not all
      endpoints accept the element.
    class: Functionality unexpected
    local_effects: *lwscistream_acpt_pkt_elem_fm_002_local_effect
    external_effects: *lwscistream_acpt_pkt_elem_fm_002_ext_effect
    heavens_ref: N/A
    impact: *lwscistream_acpt_pkt_elem_fm_002_impact
    causes: *lwscistream_acpt_pkt_elem_fm_002_causes
    evaluation: *lwscistream_acpt_pkt_elem_fm_002_evaluation
  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_003
    description: LwSciStream accepts the packet element even when not all
      endpoints have notified the pool block about the acceptance status.
    class: Functionality unexpected
    local_effects:
      - It may incorrectly accept or reject the packet element.
      - It may have unexpected behavior when receving endpoint status for this
        element.
    external_effects:
      - Pool application may receive incorrect acceptance-status of the element.
      - Pool application may use the packet element before producer or consumer
        applications setup the buffer.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_853
    - LWSCISTREAM_SHARED_CAUSE_NA_855
    evaluation:
      effectiveness: High
      justification: All causes are prevented by current design and verified by
        testing.
  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_004
    description: LwSciStream transmits the endpoint status of the same
      packet element more than once.
    class: Functionality unexpected
    local_effects: It may have unexpected behavior when receving endpoint status
       for this element.
    external_effects:
      - Pool application may receive incorrect acceptance-status of the element.
      - Pool application may use the packet element before producer or consumer
        applications setup the buffer.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_851
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_005
    description: LwSciStream sends incorrect endpoint status of the packet
      element to pool block.
    class: Incorrect value
    local_effects: T3_LwStreams_562
    external_effects:
      - Pool application may receive incorrect acceptance-status of the element.
      - Pool application may use the rejected element in the subsequent
        operation, which may have unexpected behavior.
      - Pool application may never use the element accepted by the application,
        which may lead to not enough buffer for normal operation.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_820
    evaluation:
      effectiveness: High
      justification: The cause is prevented by current design and verified by
        testing.
  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_006
    description: LwSciStream messes up the endpoint status and the index of
      the packet element.
    class: Incorrect value
    local_effects: N/A
    external_effects:
      - Pool application may receive incorrect acceptance-status of the element.
      - Pool application may use the rejected element in the subsequent
        operation, which may have unexpected behavior.
      - Pool application may never use the element accepted by the application,
        which may lead to not enough buffer for normal operation.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_822
    evaluation:
      effectiveness: High
      justification: The cause is prevented by current design and verified by
        testing.
  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_007
    description: LwSciStream transmits the status of the element before the
      status of the packet.
    class: Incorrect timing
    local_effects: Subsequent operation by LwSciStream on this packet/element
      may have unexpected behavior.
    external_effects:
      - Pool application may use the buffer which belongs to a rejected packet,
        which leads to unexpected behavior in the subsequent operation.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_853
    - id: LWSCISTREAM_SHARED_CAUSE_NA_856
      description: Failure in packet unit - pendingEvent(), which prepares the
        packet element status event before the packet status event.
      na: It's not possible with the current design (LWSTRMS52-SWAD-6052) and
        verified by integration testing (GID-TEST-5366624).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by current design and verified by
        testing.

  - id: LWSCISTREAM_FUNC_ACCEPT_PACKET_ELEMENT_FM_009
    description: LwSciStream hangs while accepting packet elements.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B
      (GID-REQ-4668025, GID-REQ-4668202, GID-REQ-4668441, GID-REQ-4668448)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

##########Functionality : Provide Attributes ######
- id: LWSCISTREAM_FUNC_PROVIDE_ATTRIBUTES
  description: Provide attribute values to application
  failure_modes:
  - id: LWSCISTREAM_PROVIDE_ATTRIBUTES_FM_001
    description: LwSciStream fails to return the value for the input attribute.
    class: Functionality missing
    local_effects: N/A
    external_effects: "Application may fail to setup required sync objects,
      element attributes and connect consumers"
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4667133, GID-REQ-5430026, GID-REQ-4663974)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_371
      description: Failure in PublicAPI unit - LwSciStreamAttributeQuery() to
        return the attribute values.
      na: Potential cause is NA as fetching an attribute value is a simple
        operation and the architecture clearly does not fail
        in this way(GID-SWAD-5276820, GID-SWAD-5158125). This is verified by
        integration testing (GID-TEST-5365401).
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_PROVIDE_ATTRIBUTES_FM_005
    description: LwSciStream writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwSciStream corruption
    external_effects: Application memory corruption.
    heavens_ref: T3_LwStreams_562
    impact: "ASIL-B(GID-REQ-4667133, GID-REQ-5430026, GID-REQ-4663974)"
    causes:
      - id: LWSCISTREAM_CAUSE_NA_506
        description: Internal failure in LwSciStream.
        na: Architecture does not fail in this way (GID-SWAD-5158125).
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISTREAM_PROVIDE_ATTRIBUTES_FM_002
    description: LwSciStream returns incorrect attribute value (higher value than
      supported).
    class: Incorrect value
    local_effects: N/A
    external_effects: "Application may fail to setup required sync objects,
      element attributes and consumers"
    heavens_ref: N/A
    impact: "ASIL-B(GID-REQ-4667133, GID-REQ-5430026, GID-REQ-4663974)"
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_373
    measures:
    - id: LWSCISTREAM_MEAS_371
      description: "LwSciStream will report error to the application, if attribute
        value is greater than what is supported by the architecture for the following
        cases.
        1. Sync count is greater than the MAX_SYNC_OBJECTS supported.
        2. Packet element count is greater than the MAX_PACKET_ELEMENTS supported.
        3. Number of Output connections to multicast block is greater than the
           MAX_DST_CONNECTIONS supported.
        'DOS_ASU_006:' It is assumed that the user of DRIVE OS evaluates all
        reported software and hardware failures during all operating modes/states
        (including transitions between all operating modes/states) and takes
        user-specific actions on failure."
      type: Detection and Reporting of Failure Mode
      refs: [21348381, 21361272, 21362133, 21365256, 21270249, 21270738, 20996313]
      tests: [GID-TEST-5329251, GID-TEST-5364780]
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_PROVIDE_ATTRIBUTES_FM_003
    description: LwSciStream returns incorrect attribute value (Lower value than
      supported).
    class: Incorrect value
    local_effects: N/A
    external_effects: "Application may fail to setup required sync objects,
      element attributes and consumers"
    heavens_ref: N/A
    impact: "ASIL-B(GID-REQ-4668616, GID-REQ-4744359)"
    causes:
    - LWSCISTREAM_SHARED_CAUSE_NA_373
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_PROVIDE_ATTRIBUTES_FM_004
    description: LwSciStream hangs while providing attributes to application.
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4667133, GID-REQ-5430026, GID-REQ-4663974)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

##########Functionality : Setup Event notifier ######
- id: LWSCISTREAM_FUNC_SETUP_EVENT_NOTIFIER
  description: Setup event notifier
  failure_modes:
  - id: LWSCISTREAM_SETUP_EVENT_NOTIFIER_FM_001
    description: LwSciStream fails to setup event notifier
    class: Functionality missing
    local_effects: LwSciStream still uses default event notifying mechanism
    external_effects: "1. Application fails to use event abstraction framework which
      enables it to wait for events simultaneously on multiple blocks at a time."
    heavens_ref: T3_LwStreams_562, T3_LwStreams_609
    impact: ASIL-B(GID-REQ-5209944)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_451
      description: Failure in Block unit - eventNotifierSetup() to create and retrieve
        the event notifier.
      na: This is prevented by design as LwSciStream relies on QNX_BSP to create
        and retrieving event notifier is a simple operation(GID-SWAD-5390434).
    - id: LWSCISTREAM_CAUSE_NA_452
      description: Failure in Block unit - eventNotifierSetup() to propagate the error
        reported by QNX_BSP while creating the event notifier.
      na: This is prevented by design as the architecture clearly shows the
        error propagation (GID-SWAD-5390434) and integration test will not pass
        if this is the case.
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.

  - id: LWSCISTREAM_SETUP_EVENT_NOTIFIER_FM_002
    description: LwSciStream binds same event notifer to different input blocks
    class: Functionality unexpected
    local_effects: N/A
    external_effects: Application may be notified incorrectly on multiple blocks which
      leads application querying for event information on incorrect blocks for which
      the event information may not be available.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4676872, GID-REQ-4676874, GID-REQ-4676875,
      GID-REQ-5422775, GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667133,
      GID-REQ-5456925, GID-REQ-5456922, GID-REQ-5430026, GID-REQ-4667151)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_454
      description: Failure in Block unit where it binds the same event notifier
        to multiple blocks.
      na: Potential cause is NA as architecture clearly cannot fail in this way
        because LwSciStream uses the QNX_BSP API CreateLocalEvent,
        to create a new LwSciLocalEvent and retrieves the LwSciEventNotifier from
        LwSciLocalEvent and doesn't reuse the existing notifier(GID-SWAD-5390434).
        This is verified by integration testing(GID-TEST-5399208, GID-TEST-5399209).
    evaluation:
      effectiveness: High
      justification: This is prevented by design and verified by testing.
  - id: LWSCISTREAM_SETUP_EVENT_NOTIFIER_FM_003
    description: LwSciStream binds event notifier to the input block multiple
      times by overwriting the exiting one.
    class: Functionality unexpected
    local_effects: N/A
    external_effects: Application may be waiting on notifier that will never be
      signaled by LwSciStream.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4663978)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_455
      description: Multiple threads try to setup the event notifier for the same input
        block.
      na: This is prevented by design as LwSciStream protects the creating and
        binding operation using a mutex and changes the internal state
        so that the successive thread will encounter an error(GID-SWAD-5390434).
    evaluation:
      effectiveness: High
      justification: This is prevented by design and verified by testing.

  - id: LWSCISTREAM_SETUP_EVENT_NOTIFIER_FM_004
    description: LwSciStream binds event notifier to an input block when not requested
    class: Functionality unexpected
    local_effects: LwSciStream starts using the event notifer mechanism which is not
      desired by application.
    external_effects: Application fails to use default event notifying mechanism.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4663977, GID-REQ-4663978)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_456
      description: Internal failure in the LwSciStream, where the setting up event
        notifier is performed for unintended block along with the requested block.
      na: Potential cause is NA because Block- getRegisteredBlock() cannot fail
        in this way as it returns the BlockPtr associated with the requested
        block(GID-SWAD-5275881) and the integration testing(GID-TEST-5365396)
        will not pass if this were the case.
    measures:
    - id: LWSCISTREAM_MEAS_456
      description: LwSciStream detects and reports the failure mode by returning
        an error to the application for any subsequent operations to setup a
        event notifer on the same block as Block- eventNotifierSetup() returns
        LwSciError_IlwalidState.
      type: Detection and Reporting of Failure Mode
      refs: [21711715]
      tests: [TBD]
      #TODO: Implement a test case to check if LwSciStream returns an error when
      # event notifier setup is already done for a block.
    evaluation:
      effectiveness: High
      justification: This is prevented by design and verified by testing.

  - id: LWSCISTREAM_SETUP_EVENT_NOTIFIER_FM_007
    description: LwSciStream writes memory not provided by application to write.
    class: Functionality unexpected
    local_effects: LwSciStream corruption
    external_effects: Application memory corruption.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4663977, GID-REQ-4663978)
    causes:
      - id: LWSCISTREAM_CAUSE_NA_507
        description: Internal failure in LwSciStream.
        na: Architecture does not fail in this way (GID-SWAD-5392846).
    evaluation: *shared_na_evaluation_wrong_write

  - id: LWSCISTREAM_SETUP_EVENT_NOTIFIER_FM_005
    description: LwSciStream binds event notifier to incorrect input block
    class: Incorrect value
    local_effects: Incorrect setup
    external_effects: Application may fail to get event information on the
      expected block.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4676872, GID-REQ-4676874, GID-REQ-4676875,
      GID-REQ-5422775, GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667133,
      GID-REQ-5456925, GID-REQ-5456922, GID-REQ-5430026, GID-REQ-4667151)
    causes:
      na: All causes are heavily shared (LWSCISTREAM_SHARED_CAUSE_NA_003)
    evaluation:
      effectiveness: High
      justification: All causes are prevented by design and verified by testing.
  - id: LWSCISTREAM_SETUP_EVENT_NOTIFIER_FM_006
    description: LwSciStream hangs while setting up the event notifer
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-5209944)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

#############Functionality: Including cookie in notification #########
- id: LWSCISTREAM_FUNC_INCLUDE_COOKIE
  description: Include cookie in notification information
  failure_modes:
  - id: LWSCISTREAM_INCLUDE_COOKIE_FM_001
    description: LwSciStream fail to include cookie in notification information
    class: Functionality missing
    local_effects: N/A
    external_effects: Application does not know about the affected packet.
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667547, GID-REQ-5422775)
    causes:
    - id: LWSCISTREAM_SHARED_CAUSE_NA_381
      description: Failure in packet unit - pendingEvent() to fill the event structure
        with cookie for the events(PACKET_ELEMENT, PACKET_DELETE, PACKET_STATUS_PRODUCER,
        PACKET_STATUS_CONSUMER, ELEMENT_STATUS_PRODUCER, ELEMENT_STATUS_CONSUMER).
      na: This is prevented by design as Packet unit ensures to fill the cookie
        for all packet related events(GID-SWAD-5194595,
        GID-SWAD-5303974, GID-SWAD-5303980, GID-SWAD-5301340, GID-SWAD-5301329,
        GID-SWAD-5301318,GID-SWAD-5301319, GID-SWAD-5301312, GID-SWAD-5301302) and
        integration testing will not pass if this is the case(GID-TEST-5366621, GID-TEST-5366622,
        GID-TEST-5366623, GID-TEST-5366624).
    evaluation:
      effectiveness: High
      justification: This is prevented by design and verified by testing.

  - id: LWSCISTREAM_INCLUDE_COOKIE_FM_002
    description: LwSciStream include cookie in notification information when information
      does not reference a packet
    class: Functionality unexpected
    local_effects: N/A
    external_effects: No affect on application as it can ignore the cookie.
    heavens_ref: N/A
    impact: QM
  - id: LWSCISTREAM_INCLUDE_COOKIE_FM_003
    description: LwSciStream includes incorrect cookie value in the notification
      information
    class: Incorrect value
    local_effects: N/A
    external_effects: Application may fail to identify the packet affected
    heavens_ref: T3_LwStreams_562
    impact: ASIL-B(GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667547, GID-REQ-5422775)
    causes:
    - id: LWSCISTREAM_CAUSE_NA_383
      description: Failure in packet unit while storing and retrieving the cookie
        value associated with packet.
      na: This is prevented by design as each packet data structure has a cookie
        associated with it and storing/retrieving this cookie is a simple
        operation(GID-SWAD-5301958, GID-SWAD-5194595, GID-SWAD-5194587). This is
        not yet verified by integration testing(GID-TEST-5408635, GID-TEST-5366621,
        GID-TEST-5366622, GID-TEST-5366623, GID-TEST-5366624, GID-TEST-5355728).
    evaluation:
      effectiveness: High
      justification: This is prevented by design and verified by testing.

  - id: LWSCISTREAM_INCLUDE_COOKIE_FM_004
    description: Including the cookie in the notification hangs
    class: Incorrect timing
    local_effects: LwSciStream hangs.
    external_effects: The application may hang.
    heavens_ref: N/A
    impact: ASIL-B(GID-REQ-4667624, GID-REQ-4681347, GID-REQ-4667547, GID-REQ-5422775)
    causes:
    - LWSCISTREAM_SHARED_CAUSE_008
    evaluation:
      effectiveness: High
      justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

############ Functionality:: Stream element info #######
- id: LWSCISTREAM_FUNC_STREAM_ELEM_INFO
  description: Stream element information to configurable blocks
  failure_modes:

    - id: LWSCISTREAM_STREAM_ELEM_INFO_FM_001
      class: Functionality missing
      description: LwSciStream does not send the packet element information to
                   configurable blocks.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4667547)
      evaluation:
        effectiveness: High
        justification: This is prevented by design and verified by testing.

      local_effects: Failure to stream packets.
      measures:
        - id: LWSCISTREAM_MEAS_001
          description: LwSciStream proceeds to sharing packet related events and
                       proceed to run-time only after the element attributes are
                       shared (GID-SWUD-5129483, GID-SWUD-5138464). Pool block
                       returns error if the element attributes are not received from
                       producer and consumer, while sharing reconciled element
                       attributes(GID-SWAD-5158114) and integration testing (GID-TEST-5364811)
                       will not pass if it weren't the case.
          refs: [19389063, 19500675, 19789941]
          type: Detection and Control of Failure Mode
      external_effects:
        - Application can hang waiting for the element information.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_001
          description: Failure in TrackArrayAction used in Multicast to keep track
                       of the element attribute received from all the consumers.
          na: This cause is prevented by design (GID-SWAD-5301167, GID-SWAD-5302439)
              and the multicast does not fail in this way. The integration testing
              (GID-TEST-5415345) will not pass if it were the case.

        - id: LWSCISTREAM_CAUSE_NA_002
          description: LwSciStream fails to perform Block::eventPost() to post the
                       attribute event to inform the configurable blocks.
          na: The architecture does not fail in this way (GID-SWAD-5302476,
              GID-SWAD-5302483, GID-SWAD-5302428, GID-SWAD-5302441). It is verified
              by integration testing (GID-TEST-5356234) that this cause is not present.

        - LWSCISTREAM_SHARED_CAUSE_NA_001

        - LWSCISTREAM_SHARED_CAUSE_NA_002

    - id: LWSCISTREAM_STREAM_ELEM_INFO_FM_002
      description: LwSciStream returns an error without justification
                   (Note) This failure mode its causes and measures are applicable to all
                   functionalities. It is mentioned here only once for brevity.
      class: Functionality unexpected
      local_effects: None
      external_effects: Application unable to continue
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4667547)
      evaluation: # This can be made shared evaluation
        effectiveness: High
        justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
      causes:
        - id: LWSCISTREAM_CAUSE_500
          heavens_ref: N/A
          description: LwSciStream returns an error due to internal failure.
          measures:
            - LWSCISTREAM_SHARED_MEAS_DOS_RES_105

    - id: LWSCISTREAM_STREAM_ELEM_INFO_FM_007
      description: LwSciStream writes memory not provided by application to write,
                   or modifies input LwSciBufAttrList handles passed to it.
      class: Functionality unexpected
      local_effects: LwSciStream corruption
      external_effects: Application memory corruption.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4667547)
      causes:
       - id: LWSCISTREAM_CAUSE_NA_508
         description: Internal failure in LwSciStream.
         na: Architecture does not fail in this way (GID-SWAD-5158114).
      evaluation: *shared_na_evaluation_wrong_write

    - id: LWSCISTREAM_STREAM_ELEM_INFO_FM_003
      class: Functionality unexpected
      description: LwSciStream corrupts the LwSciBufAttrList, during relaying of the
                   data between configurable blocks.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4667547)
      evaluation:
        effectiveness: High
        justification: This is prevented by design and verified by testing.

      local_effects: Failure to stream packets.
      external_effects:
        - Wrong buffer attributes configured for packets. Unpredictable behaviour.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_004
          description: Failure in LwSciWrap units during cloning of the LwSciBufAttrList.
          na: This is prevented by design as the cloning operation failures are reported
              to the application when the the LwSciBufAttrList are passed on to the application
              (GID-SWAD-5301169)as LwSciWrap, takeVal interface will return error in that case.

        - LWSCISTREAM_SHARED_CAUSE_NA_004

        - LWSCISTREAM_SHARED_CAUSE_NA_013

        - LWSCISTREAM_SHARED_CAUSE_NA_820

        - LWSCISTREAM_SHARED_CAUSE_NA_821

        - LWSCISTREAM_SHARED_CAUSE_NA_822

        - id: LWSCISTREAM_CAUSE_NA_005
          description: Multiple threads try to update the LwSciBufAttrList data
                       for the same element index.
          na: This is prevented by design (GID-SWAD-5301167, GID-SWAD-5301168)
              as updates to the TrackArray(which tracks the LwSciBufAttrList)
              is atomic(GID-SWAD-5132382, GID-SWAD-5132378) and only the set
              operation of the first thread will succeed.
              This is verified by integration testing (GID-TEST-5396305).

        - id: LWSCISTREAM_CAUSE_NA_006
          description: Mutiple threads try to call LwSciBufAttrListAppendUnreconciled
                       with different LwSciBufAttrList in Multicast block.
          na: This is prevented by design as the append operation is protected by
              mutex (GID-SWAD-5301948)and it is ilwoked only after the successful
              update to the TrackArray, which prevents multiple updates to same
              element index (GID-SWAD-5132382, GID-SWAD-5132378)that is verified
              by integration testing (GID-TEST-5396305).

        - id: LWSCISTREAM_SHARED_CAUSE_514
          description: Mutex lock fails due to system issue.
                       (NOTE) This cause is applicable to other functionalities as well
                       but is specified only here for brevity.
          heavens_ref: N/A
          measures:
            - id: LWSCISTREAM_MEAS_003
              description: LwSciStream halts the exelwtion if it detects mutex failures by
                           calling lwscistreamPanic(GID-SWAD-5390228). The integration testing
                           will make sure the lwscistreamPanic does not fail
                           (GID-TEST-5327471, GID-TEST-4995747).

              refs: [21710996]
              type: Detection and Control of Cause

    - id: LWSCISTREAM_STREAM_ELEM_INFO_FM_004
      class: Incorrect value
      description: LwSciStream sends (valid but) wrong packet element information
                   to configurable blocks.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4667547)
      evaluation:
        effectiveness: High
        justification: This is prevented by design and verified by testing.

      local_effects:  Failure to stream packets.
      external_effects:
        - Wrong buffer attributes configured for packets. Unpredictable behaviour.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_007
          description: TrackArray unit messes up the mapping between element index
                       and the corresponding element attribute and sends a
                       wrong attribute corresponding to a particular element index.
          na: This potential cause is NA because the architecture does not fail in
              this way(GID-SWAD-5133227, GID-SWAD-5133240).

        - id: LWSCISTREAM_CAUSE_NA_008
          description: Multicast unit fails to append all the un-reconciled attribute
                       list from the consumer.
          na: This cause is prevented by multicast design, by using TrackArray to make
              sure all the element attributes are appended (GID-SWAD-5302439).

        - LWSCISTREAM_SHARED_CAUSE_NA_013

        - LWSCISTREAM_SHARED_CAUSE_NA_820

        - LWSCISTREAM_SHARED_CAUSE_NA_821

        - LWSCISTREAM_SHARED_CAUSE_NA_822

    - id: LWSCISTREAM_STREAM_ELEM_INFO_FM_005
      class: Incorrect timing
      description: LwSciStream sends element information, when it is not supposed to
                   (like sending reconciled element information before sending the
                   unreconciled element information).
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4667547)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Incorrect streaming.
      external_effects:
        - Wrong attributes being shared.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_009
          description: LwSciStream shares reconciled attributes before getting
                       un-reconciled attributes from producer/consumer.
          na: This potential cause is NA, since the architecture does not fail
              in this way (GID-SWAD-5302452). The integration testing will not pass
              if it was the case (GID-TEST-5329107).

    - id: LWSCISTREAM_STREAM_ELEM_INFO_FM_006
      class: Incorrect timing
      description: LwSciStream hangs while streaming element
                   information to configurable blocks.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4667547)
      evaluation:
        effectiveness: High
        justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.
      local_effects:  Failure to stream packets.
      external_effects:
        - Application can hang waiting for response from LwSciStream.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_008

    - id: LWSCISTREAM_STREAM_ELEM_INFO_FM_008
      class: Incorrect timing
      description: The Init interfaces takes too long time. There is no latency
                    requirement for the init APIs of LwSciStream and hence it has
                    no safety impact. (NOTE) This failure mode
                    is applicable to other functionalities as well but is specified
                    only here for brevity.
      heavens_ref: N/A
      impact: QM
      local_effects: The initialization sequence of LwSciStream takes more time.
      external_effects: Application spends more time waiting for LwSciStream.
############ Functionality:: Stream element count #######
- id: LWSCISTREAM_FUNC_STREAM_ELEM_COUNT
  description: Stream element count to configurable blocks
  failure_modes:

    - id: LWSCISTREAM_STREAM_ELEM_COUNT_FM_001
      class: Functionality missing
      description: LwSciStream fails to send, element count, to configurable blocks.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B  (GID-REQ-5430026)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Failure to stream packets.
      external_effects:
        - Application can hang waiting for the element count.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_011
          description: Multicast unit fails to receive the element-count from all
                       the consumers.
          na: This cause is prevented by design as the mutlicast initializes a trackArray
              receiving the element count from consumer (GID-SWAD-5302389) and it checks
              if it has received all the required element info/count from all consumers
              using the trackArray(GID-SWAD-5302439). It is verified by integration testing
              (GID-TEST-5356234) that this cause is not present.

        - id: LWSCISTREAM_CAUSE_NA_012
          description: LwSciStream fails to perform Block::eventPost() to post the
                       element count event to inform the configurable blocks.
          na: The architecture does not fail in this way (GID-SWAD-5302378,
              GID-SWAD-5302390, GID-SWAD-5302460, GID-SWAD-5302453). It is verified
              by integration testing (GID-TEST-5356234) that this cause is not present.

    - id: LWSCISTREAM_STREAM_ELEM_COUNT_FM_002
      class: Functionality unexpected
      description: LwSciStream wrongly transmits element count multiple times.
      heavens_ref: N/A
      impact: ASIL-B  (GID-REQ-5430026)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  LwSciStream could either hang waiting for LwSciBufAttrList,
                      which will not be provided by application or fail to transmit
                      LwSciBufAttrList.
      external_effects:
        - Application could hang. Incorrect streaming.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_014
          description: Multiple threads try to update the element count.
          na: This cause is prevented by design as updates to the TrackCount
              (which stores the  element count) is atomic and only the set operation
              of the first thread will succeed (GID-SWAD-5140241).
              This integration testing (GID-TEST-5364806) verifies that element count can be
              set only once.

    - id: LWSCISTREAM_STREAM_ELEM_COUNT_FM_003
      class: Incorrect value
      description: LwSciStream transmits incorrect element count, to configurable blocks.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B  (GID-REQ-5430026)
      evaluation:
        effectiveness: High
        justification: This is prevented by design and verified by testing.

      local_effects:  LwSciStream could either hang waiting for LwSciBufAttrList,
                      which will not be provided by application or fail to transmit
                      LwSciBufAttrList.
      external_effects:
        - Application could hang. Incorrect streaming.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_009

        - LWSCISTREAM_SHARED_CAUSE_NA_004

    - id: LWSCISTREAM_STREAM_ELEM_COUNT_FM_004
      class: Incorrect timing
      description: LwSciStream sets element count after sending the element information.
      heavens_ref: N/A
      impact: ASIL-B  (GID-REQ-5430026)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  LwSciStream could either hang waiting for LwSciBufAttrList,
                      which will not be provided by application or fail to transmit
                      LwSciBufAttrList.
      external_effects:
        - Application could hang. Incorrect streaming.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_016
          description: LwSciStream overwrites the element count already set.
          na: This potential cause is NA, because the producer (GID-SWAD-5302422)
              and consumer(GID-SWAD-5302433), set the default element count during
              attribute sharing. LwSciStream returns error if the element count is
              set again by the application (GID-SWAD-5302384, GID-SWAD-5302377).
              The integration testing(GID-TEST-5364806) will defintely fail if the
              element count is set multiple times.

    - id: LWSCISTREAM_STREAM_ELEM_COUNT_FM_005
      description: Multiple threads try to send the element count but LwSciStream returns
                   success in some of the threads before element count is actually sent.
                   (conlwrrency issue).
      class: Incorrect timing
      local_effects: Wrong internal state.
      external_effects: The application may fail to complete further initializations.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-5430026)
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_857
      evaluation:
        effectiveness: High
        justification: All causes are prevented by design and verified by testing.

    - id: LWSCISTREAM_STREAM_ELEM_COUNT_FM_006
      description: LwSciStream hangs while streaming element count.
      class: Incorrect timing
      local_effects: LwSciStream hangs.
      external_effects: The application may hang.
      heavens_ref: N/A
      impact: ASIL-B(GID-REQ-5430026)
      causes:
       - LWSCISTREAM_SHARED_CAUSE_008
      evaluation:
        effectiveness: High
        justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

############ Functionality:: Notify application #######
- id: LWSCISTREAM_FUNC_NOTIFY_APP
  description: Notify application regarding events
  failure_modes:

    - id: LWSCISTREAM_NOTIFY_APP_FM_001
      class: Functionality missing
      description: LwSciStream fails to notify the LwSciStreamEvent notifier,
                   regarding the available events.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: The existing measures prevent the failure mode.
      local_effects:  Failure to stream packets.
      external_effects:
        - Application could hang. Incorrect streaming.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_010

    - id: LWSCISTREAM_NOTIFY_APP_FM_002
      class: Functionality missing
      description: LwSciStream fails to wake up the application threads waiting
                   for the events in LwSciStreamEventQuery() API.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Failure to stream packets.
      external_effects:
        - Application could hang. Incorrect streaming.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_011

    - id: LWSCISTREAM_NOTIFY_APP_FM_003
      class: Functionality missing
      description: LwSciStream fails to block the thread exelwtion until the event
                   is notified or time out is reached.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Failure to stream packets.
      external_effects:
        - Application could miss getting the events. Could have performance impact
          as application has to retry repeatedly to get events.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_012

    - id: LWSCISTREAM_NOTIFY_APP_FM_004
      class: Functionality missing
      description: Lwscistream fails to return the data associated with notification.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Failure to stream packets.
      external_effects:
        - Application could read wrong data from the event data structure
          as it is not correctly populated by LwSciStream.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_013

        - id: LWSCISTREAM_CAUSE_NA_017
          description: Failure in the trackCountEvent while setting and retrieving
                       event data.
          na: The TrackCount architecture does not fail in this way,
              (GID-SWAD-5301173). The integration testing (GID-TEST-5365396) will
              not pass if it were the case.

        - id: LWSCISTREAM_CAUSE_NA_020
          description: Failure in the Packet::pendingEvent() retrieving
                       event data.
          na: The Packet::pendingEvent()is a simple operation and architecture does not
              fail in this way,(GID-SWAD-5194595). The integration testing will not pass if it were
              the case (GID-TEST-5366616, GID-TEST-5366617, GID-TEST-5366618, GID-TEST-5366619,
              GID-TEST-5366620, GID-TEST-5366621, GID-TEST-5366622, GID-TEST-5366623,
              GID-TEST-5366624).

    - id: LWSCISTREAM_NOTIFY_APP_FM_010
      description: LwSciStream writes memory not provided by application to write.
      class: Functionality unexpected
      local_effects: LwSciStream corruption
      external_effects: Application memory corruption.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4668025)
      causes:
       - id: LWSCISTREAM_CAUSE_NA_509
         description: Internal failure in LwSciStream.
         na: Architecture does not fail in this way (GID-SWAD-5158109).
      evaluation: *shared_na_evaluation_wrong_write

    - id: LWSCISTREAM_NOTIFY_APP_FM_005
      class: Functionality unexpected
      description: The LwSciStream signals the event notifier or wakes up the
                   application thread waiting for events in LwSciStreamEventQuery()
                   more than once.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  none
      external_effects:
        - Application tries to get the events when there are none.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_018
          description: Failure in the Block unit, EventPost, where notifications
                       are performed more than once.
          na: The architecture does not fail in this way (GID-SWAD-5390423).
              The intergration testing (GID-TEST-5365396) will not pass if it were
              the case.

    - id: LWSCISTREAM_NOTIFY_APP_FM_011
      class: Functionality unexpected
      description: LwSciStream blocks the thread exelwtion even if the input block
                   is bound to the event notifier.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  The LwSciStream hangs while notifying events.
      external_effects:
        - Application hangs waiting for LwSciStream event notification.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_023
          description: Failure in the Block unit, eventDefaultSetup, where
                       the default waiting is performed, inspite of configuring
                       with LwSciEventService.
          na: The architecture does not fail in this way (GID-SWAD-5390427,
              LWSTRMS52-SWAD-6202, LWSTRMS52-SWAD-6201, LWSTRMS52-SWAD-6222).
              The intergration testing (GID-TEST-5615153) will not pass if it were
              the case.

    - id: LWSCISTREAM_NOTIFY_APP_FM_006
      class: Incorrect value
      description: The LwSciStream signals wrong event notifier.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Streaming can hang.
      external_effects:
        - Unpredictable behaviour as wrong application thread can get unblocked.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_019
          description: Failure in the block unit, LwSciStreamEventSetup,
                       where a wrong notifier is associated with the block.
          na: This potential cause is NA, since the architecture (GID-SWAD-5390434)
              allows only a single event notifier passed by the application to be
              attached with the block during initialization.

    - id: LWSCISTREAM_NOTIFY_APP_FM_007
      class: Incorrect value
      description: Lwscistream returns wrong data associated with notification.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Further LwSciStream API calls could fail.
      external_effects:
        - Incorrect streaming.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_013

        - LWSCISTREAM_SHARED_CAUSE_NA_820

        - LWSCISTREAM_SHARED_CAUSE_NA_821

        - LWSCISTREAM_SHARED_CAUSE_NA_822

    - id: LWSCISTREAM_NOTIFY_APP_FM_008
      class: Incorrect timing
      description: The notifying event hangs.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      local_effects:  The LwSciStream hangs while notifying events.
      external_effects:
        - Application hangs waiting for LwSciStream event notification.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_008
      evaluation:
        effectiveness: High
        justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.

    - id: LWSCISTREAM_NOTIFY_APP_FM_009
      class: Incorrect timing
      description: LwSciStream blocks application thread for less or more time than
                   the timeout specified during LwSciStreamEventQuery.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  The LwSciStream hangs while notifying events.
      external_effects:
        - Application thread, can either return before an event arrives with error or
          it can take more time to return, which cause performance impact.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_012

############ Functionality:: Connect Blocks #######
- id: LWSCISTREAM_FUNC_CONNECT_BLOCKS
  description: Connect blocks
  failure_modes:

    - id: LWSCISTREAM_CONNECT_BLOCKS_FM_001
      class: Functionality missing
      description: LwSciStream fails to connect the blocks but returns success.
      heavens_ref: T3_LwStreams_562
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  LwSciStream could fail to perform further initialization set up.
      external_effects:
        - Failure to stream.
      measures:
        - LWSCISTREAM_SHARED_MEAS_002

      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_003

        - id: LWSCISTREAM_CAUSE_NA_021
          description: Failure to propogate error reported by block unit -
                       getOutputConnectPoint() and getInputConnectPoint() APIs.
          na: The architecture clearly does not fail in this way (GID-SWAD-5275891).

        - id: LWSCISTREAM_CAUSE_NA_022
          description: Failure to propogate error reported by SafeConnection unit
                       - connInitiate() APIs.
          na: The architecture clearly does not fail in this way (GID-SWAD-5275876,
              GID-SWAD-5275877) and the integration testing(GID-TEST-5364754, GID-TEST-5364755)
              will definetly fail if this is the case.

        - LWSCISTREAM_SHARED_CAUSE_NA_014

    - id: LWSCISTREAM_CONNECT_BLOCKS_FM_003
      class: Functionality missing
      description: LwSciStream fails to notify the blocks about connection.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  LwSciStream fails to proceed to the connected state and hence
                      all further initializations such as packet creation/sync set up
                      fails. Fails to proceed to streaming phase.
      external_effects:
        - Failure to stream.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_026
          description: Failure in the block unit connSrcComplete, connDstComplete
                       interfaces or IpcSrc dstXmitNotifyConnection() and IpcDst
                       srcXmitNotifyConnection(), to notify the blocks regarding the
                       connected event.
          na: This potential cause is NA, since the architecture does not fail in
              this way (GID-SWAD-5275922) and the integration test will not pass
              if it were the case (GID-TEST-5365396).

        - id: LWSCISTREAM_CAUSE_NA_027
          description: Failure in the IPC blocks during the sending/receiving of the
                       CONNECTED message.
          na: The architecture does not fail in this way (GID-SWAD-5275924, GID-SWAD-5275923).

    - id: LWSCISTREAM_CONNECT_BLOCKS_FM_004
      class: Functionality unexpected
      description: LwSciStream connects the already connected blocks.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: The existing measures will prevent the LwSciStream from
                       connecting blocks when not requested by application.
      local_effects:  Any subsequent operations with the block may have
                      un-predictable behaviour.
      external_effects:
        - Incorrect streaming configuration.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_028
          description: Failure in the Block unit connSrcInitiate/connDstInitiate
                       or connSrcComplete/connDstComplete to keep track of the
                       available connections.
          na: This potential cause is NA because, connSrcInitiate (GID-SWAD-5275876)
              /connDstInitiate (GID-SWAD-5275877) or connSrcComplete (GID-SWAD-5275878)
              /connDstComplete(GID-SWAD-5275879) are simple operations and the integration
              testing (GID-TEST-5408604, GID-TEST-5408607, GID-TEST-5408605,
              GID-TEST-5408608) will ensure that this cause is not feasible.

        - LWSCISTREAM_SHARED_CAUSE_NA_014

        - id: LWSCISTREAM_CAUSE_NA_029
          description: Multiple application threads tries to connect the same blocks
                       and overwrite the connection information during the block
                       connSrcInitiate()/connDstInitiate() or connSrcComplete/
                       connDstComplete.
          na: The SafeConnection, connInitiate(GID-SWAD-5114284) API called by
              connSrcInitiate()/connDstInitiate() will initialize connection only when
              not done already. connComplete(GID-SWAD-5114285) called by
              connSrcComplete/connDstComplete will complete the
              connection only when connInitiate is successful. The architecture does not fail
              in this way. The integration testing(GID-TEST-5302902) will not pass if it were
              the case.

    - id: LWSCISTREAM_CONNECT_BLOCKS_FM_006
      class: Functionality unexpected
      description: LwSciStream connects the deleted blocks.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Wrong internal state. Cannot perform further initialization set up.
      external_effects:
        - Cannot proceed to streaming.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_031
          description: Application connects the blocks that are deleted.
          na: This potential cause is NA because, deleting a block removes the
              registered block instance from the global container(GID-SWAD-5326302).
              This causes the 'get registered block instance' (which is called during
              the block connect, GID-SWAD-5275891) to return error to application,
              when the deleted blocks are attempted to be connected.

        - id: LWSCISTREAM_CAUSE_NA_032
          description: Multiple application threads tries to connect and delete same
                       blocks and overwrite the connection information and result in
                       non safe state.
          na: The connection state variable ConnState is atomic (GID-SWUD-5223344) and
              is modified during the block delete(GID-SWAD-5326302, GID-SWAD-5278541,
              GID-SWAD-5278542), only when the blocks are in connected state, otherwise
              the connection state is not modified and the resources
              of the block are not released unitil refCount of block is non zero
              (GID-SWUD-5114173).
              The architecture does not fail in this way.

    - id: LWSCISTREAM_CONNECT_BLOCKS_FM_007
      class: Functionality unexpected
      description: LwSciStream notifies the blocks about connection even though
                   blocks were not connected.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: The existing measures will prevent the LwSciStream from
                       connecting blocks when not requested by application.
      local_effects:  Further initilizations such as packet creation/sync set up
                      fails. Fails to proceed to streaming phase.
      external_effects:
        - Incorect stream set up.
      measures:
        - LWSCISTREAM_SHARED_MEAS_002

      causes:

        - id: LWSCISTREAM_CAUSE_NA_033
          description: Failure in the block unit connSrcComplete and connDstComplete
                       interfaces, to correctly validate connection before posting the
                       connected event.
          na: This potential cause is NA, since the architecture checks for the
              complete paths before posting the connection event and the architecture
              cannot fail in this way (GID-SWAD-5275922). The integration tests
              will not pass if it were the case (GID-TEST-5408608, GID-TEST-5408605,
              GID-TEST-5365395).

    - id: LWSCISTREAM_CONNECT_BLOCKS_FM_008
      class: Incorrect value
      description: LwSciStream connects the incorrect blocks.
      heavens_ref: T3_LwStreams_562
      impact: ASIL B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: The existing measures will prevent the LwSciStream from
                       connecting blocks when not requested by application.
      local_effects:  Wrong internal state. Cannot perform packet/synchronization
                      set up. Cannot proceed to streaming.
      external_effects:
        - Incorrect streaming configuration.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_014

        - id: LWSCISTREAM_CAUSE_NA_035
          description: Failure in the getOutputConnectPoint() or
                       getInputConnectPoint(), which returns wrong block instances.
          na: This potential cause is NA, since the architecture (GID-SWAD-5275891),
              does not fail in this way. The integration testing will not pass if
              it were the case (GID-TEST-5365395).

    - id: LWSCISTREAM_CONNECT_BLOCKS_FM_009
      description: LwSciStream hangs while connecting blocks.
      class: Incorrect timing
      local_effects: LwSciStream hangs.
      external_effects: The application may hang.
      heavens_ref: N/A
      impact: ASIL-B(GID-REQ-4668025)
      causes:
       - LWSCISTREAM_SHARED_CAUSE_008
      evaluation:
        effectiveness: High
        justification: This measure prevents the DRIVE OS application from transitioning
                       from the init phase to the runtime phase when an error is detected.
                       As such, if an application checks the error code and observes an error,
                       the safe state is maintained.
############ Functionality:: Present packet #######
- id: LWSCISTREAM_FUNC_PRESENT_PACKET
  description: Producer presents packet and fences.
  failure_modes:

    - id: LWSCISTREAM_PRESENT_PACKET_FM_001
      class: Functionality missing
      description: LwSciStream doesn't present the packet and input fence information
                   to all queues.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Packet lost.
      external_effects:
        - Application may hang if all packets are lost.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_080
          description: Failure in the multicast block to transmit packet information
                       to all the downstream blocks.
          na: This potential cause is NA, the architecture (GID-SWAD-5313327) does
              not fail in this way and integration test (GID-TEST-5365396)
              will not pass if it were the case.

        - LWSCISTREAM_SHARED_CAUSE_NA_018

        - LWSCISTREAM_SHARED_CAUSE_NA_015

        - LWSCISTREAM_SHARED_CAUSE_NA_019

        - LWSCISTREAM_SHARED_CAUSE_NA_016

    - id: LWSCISTREAM_PRESENT_PACKET_FM_002
      class: Functionality missing
      description: LwSciStream doesn't associate the input fence information with
                   the packet.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Application may get corrupted information if the fence information is not
          correct or missing.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_016

        - LWSCISTREAM_SHARED_CAUSE_NA_009

        - LWSCISTREAM_SHARED_CAUSE_NA_025

    - id: LWSCISTREAM_PRESENT_PACKET_FM_003
      class: Functionality missing
      description: LwSciStream doesn't associate the packet with Mailbox or FIFO
                   queue block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  LwSciStream fails to deliver the packet to the consumer.
      external_effects:
        - Consumer application can hang waiting for the packet.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_082
          description: Internal failure in LwSciStream Queue blocks, where it fails
                       to enqueue the packet to the queue.
          na: This potential cause is NA, because the architecture does not fail in
              this way (GID-SWAD-5313373, GID-SWAD-5313390). The intergration
              testing will not pass if it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_PRESENT_PACKET_FM_020
      class: Functionality missing
      description: LwSciStream doesn't dissociate the packet from producer block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  LwSciStream fails to deliver the packet to the consumer.
      external_effects:
        - Consumer application can hang waiting for the packet.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_026

    - id: LWSCISTREAM_PRESENT_PACKET_FM_004
      class: Functionality missing
      description: When the number of packets associated with the consumer is equal
                   to maximum-packets parameter of the limiter block, the LwSciStream
                   doesn't designate the packet for association with the pool block but
                   it associates it with queue block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Packet lost.
      external_effects:
        - Consumer application can hang waiting for the packet.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_017

    - id: LWSCISTREAM_PRESENT_PACKET_FM_005
      class: Functionality missing
      description: LwSciStream doesn't notify the consumer about ready packet event.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Packet lost.
      external_effects:
        - The consumer application doesn't know there's packet ready for acquiring
          and could hang.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_084
          description: Failure in the Consumer block to prepare the PACKET_READY event.
          na: This potential cause is NA, as the architecture (GID-SWAD-5313410)
              does not fail in this way. The integration testing will not pass
              if it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_PRESENT_PACKET_FM_006
      class: Functionality unexpected
      description: LwSciStream allows the application to present a packet which is
                   not associated with the producer block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects: Packet information can get corrupted if the packet is still
                     in use by consumer. Incorrect internal packet management state.
      external_effects:
        - Application may get wrong packet information.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_026

    - id: LWSCISTREAM_PRESENT_PACKET_FM_008
      class: Functionality unexpected
      description: LwSciStream designates the packet for association with the pool
                   block even though the number of packets associated with the
                   consumer doesn't reach the maximum-packets parameter of the limiter
                   block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  The consumer could not receive any packets or some packets are
                      skipped unexcpectedly.
      external_effects:
        - Streaming hangs as consumer waits for the packet.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_017

    - id: LWSCISTREAM_PRESENT_PACKET_FM_009
      class: Functionality unexpected
      description: LwSciStream wrongly associates the same packet multiple times with
                   the queue block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Same packet may be presented multiple times.
      external_effects:
        - Incorrect packets received by the application during streaming.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_086
          description: Internal failure in LwSciStream Queue unit, where it enqueues
                       the same packet multiple times to the queue.
          na: This potential cause is NA, because the architecture updates the packet
              state while enqueuing to the queue (GID-SWAD-5326215) and returns error
              event if the packet is already enqueued. The integration testing will not pass
              if it were the case. TBD - Implement a integration test to check if
              enqueuing the already queued packet in queue block returns an error.

    - id: LWSCISTREAM_PRESENT_PACKET_FM_010
      class: Functionality unexpected
      description: LwSciStream associates the packet with wrong queue type.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Incorrect queue operation.
      external_effects:
        - Consumer application doesn't receive the latest packet using LwSciStream
          with the mailbox queue type. Packets skipped unexpectedly in LwSciStream
          with FIFO queue.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_087
          description: Internal failure in LwSciStream Queue unit, during Queue
                       creation where the Mailbox and FIFO queues are wrongly
                       associated.
          na: This potential cause is NA, since the architecture (GID-SWAD-5275910,
              GID-SWAD-5275914) does not fail in this way during the queue block
              creation.

        - id: LWSCISTREAM_CAUSE_NA_088
          description: Failure in the Mailbox and FIFO Queue operation.
          na: This potential cause is NA, because the architecture does not fail
              in this way (GID-SWAD-5313373, GID-SWAD-5313390).
              The integration testing will not pass if it were the case(GID-TEST-5399205,
              GID-TEST-5399206).

    - id: LWSCISTREAM_PRESENT_PACKET_FM_012
      class: Functionality unexpected
      description: LwSciStream notifies the consumer even when there is no packet
                   associated with the queue block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4663978)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:   none
      external_effects:
        - Consumer application could not acquire a ready packet even though receiving
          the packet-ready event.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_090
          description: Failure in the Queue block, where it informs the downstream
                       consumer block about available packets, even though there is no
                       new packets enqueued to the Queue.
          na: This potential cause is NA, because the architecture (GID-SWAD-5313390)
              does not fail in this way. The integration testing will not pass
              if it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_PRESENT_PACKET_FM_013
      class: Functionality unexpected
      description: The packets presented by the producer are acquired by the consumer
                   for processing in different order.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:   none
      external_effects:
        - Consumer application gets packet information in a wrong order.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_019

        - id: LWSCISTREAM_CAUSE_NA_092
          description: Mutliple threads try to enqueue and dequeue the packets at the
                       same time, hence corrupting the data in the Queue.
          na: This potential cause is NA, since enqueue operations on queue are
              protected by mutex and the architeure does not fail in this way
              (GID-SWAD-5313373, GID-SWAD-5313390).

    - id: LWSCISTREAM_PRESENT_PACKET_FM_014
      description: LwSciStream writes memory not provided by application to write.
                   or modifies input LwSciSyncFence handles passed to it.
      class: Functionality unexpected
      local_effects: LwSciStream corruption
      external_effects: Application memory corruption.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668441)
      causes:
        - id: LWSCISTREAM_CAUSE_NA_093
          description: Application passes input fence array of wrong size.
          na: This potential cause is NA since the LwSciStream ICD (GID-SWAD-5158121),
              specifies the correct size of the array to be passed by the application.

        - id: LWSCISTREAM_CAUSE_NA_510
          description: Internal failure in LwSciStream.
          na: Architecture does not fail in this way (GID-SWAD-5158121).

      evaluation: *shared_na_evaluation_wrong_write

    - id: LWSCISTREAM_PRESENT_PACKET_FM_021
      class: Functionality unexpected
      description: LwSciStream designates the invalid fence for association
                   with the queue block.
      heavens_ref: T3_LwStreams_586
      impact: ASIL - B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Wrong internal state, packets may be lost.
      external_effects:
        - Subsequent operation on the fences by the application may have unexpected behavior.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_025

        - LWSCISTREAM_SHARED_CAUSE_NA_009

        - LWSCISTREAM_SHARED_CAUSE_NA_004

    - id: LWSCISTREAM_PRESENT_PACKET_FM_015
      class: Incorrect value
      description: LwSciStream designates the wrong packet for association with
                   the queue block.
      heavens_ref: T3_LwStreams_586
      impact: ASIL - B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: The existing measures will prevent this failure mode.
      local_effects:  Wrong internal state, packets may be lost.
      external_effects:
        - Consumer receives wrong packet.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_018

    - id: LWSCISTREAM_PRESENT_PACKET_FM_019
      class: Incorrect value
      description: LwSciStream designates the wrong fence for association
                   with the queue block.
      heavens_ref: T3_LwStreams_586
      impact: ASIL - B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Wrong internal state, packets may be lost.
      external_effects:
        - Consumer receives wrong fence information.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_016

    - id: LWSCISTREAM_PRESENT_PACKET_FM_016
      class: Incorrect value
      description: LwSciStream notifies the consumer for a wrong event instead
                   of packet ready.
      heavens_ref: T3_LwStreams_586
      impact: ASIL - B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects: none
      external_effects:
        - The consumer application doesn't know that packet is ready for
          acquiring. Streaming hangs.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_094
          description: The internal failure in the LwSciStream counsumer unit,
                       where a wrong event is posted.
          na: The potential cause is NA, architecture (GID-SWAD-5313410) does
              not fail in this way. The integration testing will not pass
              if it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_PRESENT_PACKET_FM_017
      class: Incorrect timing
      description: Presenting a packet hang.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-4668441)
      evaluation:
        effectiveness: High
        justification: This measure detects when the cause oclwrs.

      local_effects: LwSciStream hangs.
      external_effects:
        - Application hangs waiting for LwSciStream.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_023
        - LWSCISTREAM_SHARED_CAUSE_024

    - id: LWSCISTREAM_PRESENT_PACKET_FM_018
      class: Incorrect timing
      description: Presenting a packet takes too long. There is no ASIL requirement for
                   latency of the run-time APIs of LwSciStream and hence it has no safety impact.
                   (Note) This failure mode corresponding to LwSciStream API taking
                   too long is applicable to other functionalities as well, but specified
                   only here for brevity.
      heavens_ref: N/A
      impact: QM
      local_effects: LwSciStream takes too long to transmit packet.
      external_effects: Application waits too long to transmit packets through LwSciStream.

############ Functionality:: Get packet #######
- id: LWSCISTREAM_FUNC_GET_PACKET
  description: Get packet and fences.
  failure_modes:

    - id: LWSCISTREAM_GET_PACKET_FM_001
      class: Functionality missing
      description: LwSciStream doesn't return available packet (cookie).
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668202)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Application fails to get the available packet for processing.
          Streaming hangs.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_020

        - LWSCISTREAM_SHARED_CAUSE_NA_018

        - LWSCISTREAM_SHARED_CAUSE_NA_021

        - LWSCISTREAM_SHARED_CAUSE_NA_015

        - id: LWSCISTREAM_CAUSE_NA_097
          description: Failure in the Packet::deleteGet interface, to detect the deleted block.
          na: This potential cause is NA, since the Packet::deleteGet is a simple operation
              and integration testing will not pass if it were the case (GID-TEST-5355757,
              GID-TEST-5355758).

    - id: LWSCISTREAM_GET_PACKET_FM_002
      class: Functionality missing
      description: LwSciStream doesn't return fence information with the available
                   packet.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668202)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Synchronization failure between producer and consumer application.
          Streaming data corruption.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_016

    - id: LWSCISTREAM_GET_PACKET_FM_003
      class: Functionality missing
      description: LwSciStream doesn't disassociate the packet from the pool block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668202)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Wrong internal state, packets may be lost.
      external_effects:
        - Application fails to get the available packet for processing.
          Streaming hangs.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_019

    - id: LWSCISTREAM_GET_PACKET_FM_004
      class: Functionality unexpected
      description: LwSciStream returns success, when there is no available packet.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668202)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  none.
      external_effects:
        - Application fails to get correct cookie/packet for streaming.
          Streaming fails.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_098
          description: Failure in the producer::getPacket() where it fails to
                       propogate error reported by downstream srcGetPacket().
          na: This potential cause is NA because architecture (GID-SWAD-5313257)
              does not fail in this way. The integration testing will not pass
              if it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_GET_PACKET_FM_005
      description: LwSciStream writes memory not provided by application to write.
      class: Functionality unexpected
      local_effects: LwSciStream corruption
      external_effects: Application memory corruption.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668202)
      causes:
        - id: LWSCISTREAM_CAUSE_NA_099
          description: Application passes input fence array of wrong size.
          na: This potential cause is NA since the LwSciStream ICD (GID-SWAD-5158120),
              specifies the correct size of the array to be passed by the application.

        - id: LWSCISTREAM_CAUSE_NA_100
          description: Application passes input cookie pointer of wrong size.
          na: This potential cause is NA since the LwSciStream ICD (GID-SWAD-5158120),
              specifies the correct size of the array to be passed by the application.

        - id: LWSCISTREAM_CAUSE_NA_511
          description: Internal failure in LwSciStream.
          na: Architecture does not fail in this way (GID-SWAD-5158120).

      evaluation: *shared_na_evaluation_wrong_write

    - id: LWSCISTREAM_GET_PACKET_FM_006
      class: Functionality unexpected
      description: LwSciStream disassociates and returns an unavailable packet from
                   the pool block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668202)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Wrong internal state, loss of packets for streaming.
                      Incorrect streaming.
      external_effects:
        - Returning packet back to LwSciStream fails. Streaming hangs.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_101
          description: Failure in the pool unit dequeue payloadQ, where unavailable
                       packets are dequeued.
          na: This potential cause is NA because architecture does not fail in this
              way because, the pool payloadQ is only enqueued,
              1. when packets and all elements are created and accepted
              (GID-SWAD-5301953) and
              2. during run time when consumer releases the packet (GID-SWAD-5314382).
              Thus the unavailable packets are not enqueued in pool PayloadQ.
              The integration testing (GID-TEST-5365395) will not pass if it were the case.

        - LWSCISTREAM_SHARED_CAUSE_NA_015

        - LWSCISTREAM_SHARED_CAUSE_NA_019

    - id: LWSCISTREAM_GET_PACKET_FM_007
      class: Incorrect value
      description: LwSciStream return wrong fence information with the packet.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668202)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Synchronization failure between producer and consumer application.
          Streaming data corruption.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_016

        - LWSCISTREAM_SHARED_CAUSE_NA_009

        - LWSCISTREAM_SHARED_CAUSE_NA_022

    - id: LWSCISTREAM_GET_PACKET_FM_008
      class: Incorrect timing
      description: getting an available packet hangs.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-5209942)
      evaluation:
        effectiveness: High
        justification: This measure detects when the cause oclwrs.
      local_effects: LwSciStream hangs.
      external_effects:
        - Application hangs waiting for LwSciStream.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_023

############ Functionality:: Acquire packet #######
- id: LWSCISTREAM_FUNC_ACQUIRE_PACKET
  description: Acquire packet and fences.
  failure_modes:

    - id: LWSCISTREAM_ACQUIRE_PACKET_FM_001
      class: Functionality missing
      description: LwSciStream doesn't return the ready packet (cookie).
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668448)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Application fails to get the ready packet for processing.
          Streaming hangs.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_020

        - LWSCISTREAM_SHARED_CAUSE_NA_018

        - LWSCISTREAM_SHARED_CAUSE_NA_021

        - LWSCISTREAM_SHARED_CAUSE_NA_015

    - id: LWSCISTREAM_ACQUIRE_PACKET_FM_002
      class: Functionality missing
      description: LwSciStream doesn't return fence information with the
                   ready packet.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668448)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Synchronization failure between producer and consumer application.
          Streaming data corruption.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_016

    - id: LWSCISTREAM_ACQUIRE_PACKET_FM_003
      class: Functionality missing
      description: LwSciStream doesn't disassociate the packet from the queue block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668448)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Wrong internal state, packets may be lost.
      external_effects:
        - Application fails to return the packet after processing. Streaming hangs.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_019

    - id: LWSCISTREAM_ACQUIRE_PACKET_FM_004
      class: Functionality unexpected
      description: LwSciStream returns success, when there is no ready packet.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668448)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  none.
      external_effects:
        - Application fails to get correct cookie/packet for streaming.
          Streaming fails.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_102
          description: Failure in the consumer::acquirePacket() where it fails to
                       propogate error reported by downstream dstAcquirePacket().
          na: This potential cause is NA because architecture (GID-SWAD-5314310)
              does not fail in this way. The integration testing will not pass
              if it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_ACQUIRE_PACKET_FM_005
      description: LwSciStream writes memory not provided by application to write.
      class: Functionality unexpected
      local_effects: LwSciStream corruption
      external_effects: Application memory corruption.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B GID-REQ-4668448)
      causes:

        - id: LWSCISTREAM_CAUSE_NA_103
          description: Application passes input fence array of wrong size.
          na: This potential cause is NA since the LwSciStream ICD (GID-SWAD-5158122),
              specifies the correct size of the array to be passed by the application.

        - id: LWSCISTREAM_CAUSE_NA_104
          description: Application passes input cookie pointer of wrong size.
          na: This potential cause is NA since the LwSciStream ICD (GID-SWAD-5158122),
              specifies the correct size of the array to be passed by the application.

        - id: LWSCISTREAM_CAUSE_NA_512
          description: Internal failure in LwSciStream.
          na: Architecture does not fail in this way (GID-SWAD-5158122).

      evaluation: *shared_na_evaluation_wrong_write

    - id: LWSCISTREAM_ACQUIRE_PACKET_FM_006
      class: Functionality unexpected
      description: The packets presented by the producer are acquired by the consumer
                   for processing in different order.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668448)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Consumer application gets packet information in a wrong order.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_105
          description: Failure in the Packet payloadQ dequeue mechanism.
          na: This potential cause is NA, since dequeue(GID-SWAD-5194604) operation
              from queue is simple operation. The integration test has to implemented to
              check the order of enqueue and dequeue of payloadQ.

        - id: LWSCISTREAM_CAUSE_NA_106
          description: Mutliple threads try to dequeue the packets at the same time,
                       hence corrupting the data in the Queue.
          na: This potential cause is NA, since dequeue operation from queue are
              protected by mutex and the architecture does not fail in this way
              (GID-SWAD-5314311).

    - id: LWSCISTREAM_ACQUIRE_PACKET_FM_007
      class: Incorrect value
      description: LwSciStream return wrong fence information with the packet.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668448)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Synchronization failure between producer and consumer application.
          Streaming data corruption.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_016

        - LWSCISTREAM_SHARED_CAUSE_NA_009

        - LWSCISTREAM_SHARED_CAUSE_NA_022

    - id: LWSCISTREAM_ACQUIRE_PACKET_FM_008
      class: Incorrect timing
      description: Acquiring a packet hang.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-4668448)
      evaluation:
        effectiveness: High
        justification: This measure detects when the cause oclwrs.
      local_effects: LwSciStream hangs.
      external_effects:
        - Application hangs waiting for LwSciStream.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_023

############ Functionality:: Release packet #######
- id: LWSCISTREAM_FUNC_RELEASE_PACKET
  description: Consumer releases packet to the producer
  failure_modes:

    - id: LWSCISTREAM_RELEASE_PACKET_FM_001
      class: Functionality missing
      description: LwSciStream fails to release packet to pool block, even though it
                   is designated for association by all consumer blocks.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Packet lost.
      external_effects:
        - Application may hang if all packets are lost.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_107
          description: Failure in the multicast block to transmit information to
                       upstream block even after receiving information from all the
                       downstream blocks.
          na: This potential cause is NA, the architecture (GID-SWAD-5314378,
              GID-SWAD-5326208) does not fail in this way and integration test
              will not pass if it were the case (GID-TEST-5365396).

        - LWSCISTREAM_SHARED_CAUSE_NA_018

        - LWSCISTREAM_SHARED_CAUSE_NA_015

        - LWSCISTREAM_SHARED_CAUSE_NA_016

        - LWSCISTREAM_SHARED_CAUSE_NA_019

    - id: LWSCISTREAM_RELEASE_PACKET_FM_002
      class: Functionality missing
      description: LwSciStream doesn't associate the input fence information with
                   the packet.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  none.
      external_effects:
        - Application may get corrupted information if the fence information is not
          correct or missing.
      causes:

        - LWSCISTREAM_SHARED_CAUSE_NA_016

        - LWSCISTREAM_SHARED_CAUSE_NA_009

        - LWSCISTREAM_SHARED_CAUSE_NA_025

    - id: LWSCISTREAM_RELEASE_PACKET_FM_003
      class: Functionality missing
      description: LwSciStream doesn't associate the packet with pool block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  LwSciStream fails to deliver the packet to the producer.
      external_effects:
        - Producer application can hang waiting for the packet.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_108
          description: Internal failure in LwSciStream Pool blocks, where it fails to
                       enqueue the packet to the queue.
          na: This potential cause is NA, because the architecture does not fail in
              this way (GID-SWAD-5314382). The intergration testing will not pass if
              it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_RELEASE_PACKET_FM_013
      class: Functionality missing
      description: LwSciStream doesn't disassociate the packet from consumer block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  LwSciStream fails to deliver the packet to the producer.
      external_effects:
        - Producer application can hang waiting for the packet.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_027

    - id: LWSCISTREAM_RELEASE_PACKET_FM_004
      class: Functionality missing
      description: LwSciStream doesn't notify the producer about ready packet event.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Packet lost.
      external_effects:
        - The Producer application doesn't know there's packet ready for acquiring
          and could hang.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_109
          description: Failure in the Producer block to prepare the PACKET_READY
                       event.
          na: This potential cause is NA, as the architecture (GID-SWAD-5314385)
              does not fail in this way and the integration testing will not pass
              if it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_RELEASE_PACKET_FM_005
      class: Functionality unexpected
      description: LwSciStream allows the application to release a packet which
                   is not associated with the consumer block.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Packet information can get corrupted if the packet is still
                      in use by producer. Incorrect internal packet management state.
      external_effects:
        - Application may get wrong packet information.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_027

    - id: LWSCISTREAM_RELEASE_PACKET_FM_006
      class: Functionality unexpected
      description: LwSciStream wrongly associates the same packet multiple times with
                   the pool block.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Same packet may be released multiple times.
      external_effects:
        - Incorrect packets received by the application during streaming.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_111
          description: Internal failure in LwSciStream Pool unit, where it associates
                       the same packet multiple times to the pool.
          na: This potential cause is NA, because the architecture updates the packet
              state while enqueuing to the payloadQ (GID-SWAD-5314382) and returns
              error event if the packet is already enqueued. The integration testing will not
              pass if it were the case. TBD - Implement a integration test to check if
              enqueuing the already queued packet in pool block returns an error.

    - id: LWSCISTREAM_RELEASE_PACKET_FM_007
      class: Functionality unexpected
      description: LwSciStream notifies the producer about the packet-ready event
                   even when there is no packet associated with the pool block.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  none.
      external_effects:
        - Producer application could not acquire a ready packet even though
          receiving the packet-ready event.
      causes:
        - id: LWSCISTREAM_CAUSE_NA_112
          description: Failure in the Pool/Producer block, where it informs the
                       application about available packets, even though there is
                       no new packets enqueued to the Pool.
          na: This potential cause is NA, because the Pool block (GID-SWAD-5314382)
              informs about packet ready to producer block (GID-SWAD-5314385)
              only after packet is enqueued. The integration testing will not pass
              if it were the case (GID-TEST-5365396).

    - id: LWSCISTREAM_RELEASE_PACKET_FM_014
      class: Functionality unexpected
      description: LwSciStream associates a packet with pool block before it is
                   designated for association by all consumer blocks.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  Wrong internal state, streaming can fail.
      external_effects:
        - Producer can overwrite the memory that consumer is reading.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_022

    - id: LWSCISTREAM_RELEASE_PACKET_FM_015
      class: Functionality unexpected
      description: LwSciStream designates the invalid fence for association
                   with the pool block.
      heavens_ref: T3_LwStreams_586
      impact: ASIL - B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Wrong internal state, packets may be lost.
      external_effects:
        - Subsequent operation on the fences by the application may have unexpected behavior.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_025

        - LWSCISTREAM_SHARED_CAUSE_NA_009

        - LWSCISTREAM_SHARED_CAUSE_NA_004

    - id: LWSCISTREAM_RELEASE_PACKET_FM_008
      description: LwSciStream writes memory not provided by application to write.
                   or modifies input LwSciSyncFence handles passed to it.
      class: Functionality unexpected
      local_effects: LwSciStream corruption
      external_effects: Application memory corruption.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668025)
      causes:
        - id: LWSCISTREAM_CAUSE_NA_113
          description: Application passes input fence array of wrong size.
          na: This potential cause is NA since the LwSciStream ICD (GID-SWAD-5158123),
              specifies the correct size of the array to be passed by the application.

        - id: LWSCISTREAM_CAUSE_NA_513
          description: Internal failure in LwSciStream.
          na: Architecture does not fail in this way (GID-SWAD-5158123).

      evaluation: *shared_na_evaluation_wrong_write

    - id: LWSCISTREAM_RELEASE_PACKET_FM_009
      class:  Incorrect value
      description: LwSciStream designates the wrong packet for association with pool block.
      heavens_ref: N/A
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: The existing measures will prevent this failure mode.
      local_effects:  Wrong internal state, packets may be lost.
      external_effects:
        - producer receives wrong packet.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_018
        - LWSCISTREAM_SHARED_CAUSE_NA_019

    - id: LWSCISTREAM_RELEASE_PACKET_FM_012
      class: Incorrect value
      description: LwSciStream designates the wrong fence for association
                   with the pool block.
      heavens_ref: T3_LwStreams_586
      impact: ASIL - B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects:  Wrong internal state, packets may be lost.
      external_effects:
        - Consumer receives wrong fence information.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_NA_016

    - id: LWSCISTREAM_RELEASE_PACKET_FM_010
      class:  Incorrect value
      description: LwSciStream notifies the producer for a wrong event instead of
                   packet ready.
      heavens_ref: T3_LwStreams_586
      impact: ASIL-B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.
      local_effects:  none.
      external_effects:
        - The producer application doesn't know that packet is ready for acquiring.
          Streaming hangs.
      causes:

        - id: LWSCISTREAM_CAUSE_NA_114
          description: The internal failure in the LwSciStream producer unit, where
                       a wrong event is posted.
          na: The potential cause is NA, architecture (GID-SWAD-5314385) does not fail
              in this way. The integration testing will not pass if it were the
              case (GID-TEST-5365396).

    - id: LWSCISTREAM_RELEASE_PACKET_FM_011
      class: Incorrect timing
      description: Releasing a packet hang.
      heavens_ref: N/A
      impact: ASIL - B (GID-REQ-4668025)
      evaluation:
        effectiveness: High
        justification: Existing measures will prevent the cause to occur.

      local_effects: LwSciStream hangs.
      external_effects:
        - Application hangs waiting for LwSciStream.
      causes:
        - LWSCISTREAM_SHARED_CAUSE_023
        - LWSCISTREAM_SHARED_CAUSE_024

# List of common / shared causes can be defined here as well.
causes:
  - id: LWSCISTREAM_SHARED_CAUSE_NA_001
    description: LwSciStream units fails to relay the data to upstream/
      downstream blocks due to failure in src/dst Send*() safeconnection
      unit interfaces.
    na: src/dst Send*() safeconnection unit interfaces (GID-SWAD-5276645,
      GID-SWAD-5275873) would not fail this way, otherwise, the integration
      test would not pass (GID-TEST-5365395, GID-TEST-5365396).
      (NOTE) This cause could lead to similar failure modes for other
      functionalities as well but specified only here for breviety.
  - id: LWSCISTREAM_SHARED_CAUSE_NA_002
    description: Failure in block unit - entry point validation, which allows
      application to attempt data transfer when the blocks are not in connected
      state or source/destination connection index is invalid.
    na: The entry point validation is a simple operation (GID-SWAD-5275875) and
      the integration testing (GID-TEST-5408625, LWSTRMS52-TEST-7265, GID-TEST-5408624,
      GID-TEST-5408669, GID-TEST-5408670, GID-TEST-5408671) will ensure that
      this cause is not feasible.
      (NOTE) This cause could lead to similar failure modes for other
      functionalities as well but specified only here for breviety.
  - id: LWSCISTREAM_SHARED_CAUSE_NA_003
    description: Failure in block unit - getRegisteredBlock(), which results in wrong
                 block_ptr used to transfer the data.
    na: getRegisteredBlock() is a simple look up operation (GID-SWAD-5275881) and
        the integration testing(GID-TEST-5365396) will not pass if this were the case.
        (NOTE) This cause could lead to similar failure modes for other functionalities
        as well but specified only here for brevity.
  - id: LWSCISTREAM_SHARED_CAUSE_NA_004
    description: The LwSciStream corrupts the exported/imported data in case of
      IPC use case, due to failures in IpcComm packVal() and unpackVal()
      interfaces.
    na: packVal() (GID-SWAD-5165754) and unpackVal() (GID-SWAD-5167078) are
      simple functions. And the LwSciStream propagates error related to packVal
      (GID-SWAD-5275926) and unpackVal (GID-SWAD-5275927) interfaces to the
      application.
        #TODO: Implement an integration test for inter-process use case
  - id: LWSCISTREAM_SHARED_CAUSE_008
    description: LwSciStream hangs because of internal failures within it
      (all causes).
      LwSciBuf/LwSciSync may hang during init state.
      Other elements, like LwSciIpc, QNX_SYSTEM, may hang during init state.
    heavens_ref: N/A
    measures:
    - LWSCISTREAM_SHARED_MEAS_DOS_RES_104
    - LWSCISTREAM_SHARED_MEAS_DOS_ASU_010

  - id: LWSCISTREAM_SHARED_CAUSE_NA_009
    description: Corruption in data, during setting and retrieving of data through
                 the TrackCount interface.
    na: This potential cause is NA because the architecture does not fail in this
        way. The trackCount integration test (GID-TEST-5329253) will fail if it were the case.

  - id: LWSCISTREAM_SHARED_CAUSE_NA_010
    description: Failure in the LwSciStream, to signal the
                 notifier.
    na: This cause is prevented by design (GID-SWAD-5390423) as LwSciStream relies
        on QNX_BSP event notifier service and posts the events to it through eventPost().
        (NOTE) This cause could lead to similar failure modes for other functionalities
        as well but specified only here for breviety. The integration testing will not pass
        if the cause is present(GID-TEST-5399209).

  - id: LWSCISTREAM_SHARED_CAUSE_NA_011
    description: Failure in the LwSciStream, to signal the condition variable used
                 by application to wait for events.
    na: This cause is prevented by design (GID-SWAD-5390423) as LwSciStream
        relies on std condition-variable from QNX toolchain for waiting/signalling
        events. It is verified by integration testing (GID-TEST-5365396)
        that this cause is not present.
        (NOTE) This cause could lead to similar failure modes for other
        functionalities as well but specified only here for breviety.

  - id: LWSCISTREAM_SHARED_CAUSE_NA_012
    description: Failure in the block unit, LwSciStreamEventQuery to wait for the
                 specified timeout.
    na: The architecture does not fail in this way (GID-SWAD-5390429) as it performs
        the eventWait with specified timeout.

  - id: LWSCISTREAM_SHARED_CAUSE_NA_013
    description: Failure in the TrackArrayEvent unit, which couldn't save or
      retrieve the pending event data.
    na: The TrackArray architecture does not fail in this way while preparing
      event (GID-SWAD-5301168) or retrieving event (GID-SWAD-5301169). It's
      also verified by integration testing for preparing event (GID-TEST-5396287,
      GID-TEST-5396288) and retrieving event (GID-TEST-5396289).

  - id: LWSCISTREAM_SHARED_CAUSE_NA_014
    description: Failure in the safeconnection connInitiate and connComplete.
    na: This potential cause is NA, since the architecture does not fail in this way
        (GID-SWAD-5114284, GID-SWAD-5114285) and the integration testing will not pass if
        this is the case (GID-TEST-5302900, GID-TEST-5302901, GID-TEST-5302904,
        GID-TEST-5302906).


  - id: LWSCISTREAM_SHARED_CAUSE_NA_015
    description: Failure in packet unit, update packet location APIs.
    na: This potential cause is NA since updating packet location is a simple operation
        (GID-SWAD-5326212) and architecture does not fail in this way. Integration
        testing(GID-TEST-5365396) will not pass if it were the cause.

  - id: LWSCISTREAM_SHARED_CAUSE_NA_016
    description: Failure in the payloadGet/payloadSet in Packet unit.
    na: This potential cause is NA since the get/set payloadQ operation is a simple operation
        (GID-SWAD-5326209, GID-SWAD-5326208). The integration testing will not pass if
        this is the case.

  - id: LWSCISTREAM_SHARED_CAUSE_NA_017
    description: Failure in the Limiter unit to keep track of the number of packets
                 associated with Queue/Consumer block, because of multithreaded
                 access during increment/decrement of counters.
    na: This potential cause is NA because the increment and decrement operations
        are atomic and architecture does not fail in this way (GID-SWAD-5313331).

  - id: LWSCISTREAM_SHARED_CAUSE_NA_018
    description: Failure in block unit, finding packet by handle.
    na: The finding packet by handle is a simple look up operation and integration
        testing (GID-TEST-5365396) will not pass if this were the case. The look up is
        created during packet create(GID-SWAD-5301958) and removed only during packet
        or block deletion(GID-SWAD-5301959). The integration test (GID-TEST-5408631) will not pass
        if it were the case.

  - id: LWSCISTREAM_SHARED_CAUSE_NA_019
    description: Failure in the Packet payloadQ enqueue/dequeue mechanism.
    na: This potential cause is NA, since enqueue(GID-SWAD-5194603) and dequeue operation
        (GID-SWAD-5194604) from queue is simple operation. The integration testing will not
        pass if it were the case(GID-TEST-5355768, GID-TEST-5366626).

  - id: LWSCISTREAM_SHARED_CAUSE_NA_020
    description: Failure in the Packet unit, cookieGet API.
    na: This potential cause is NA, because the packet to cookie look up operation is
        deterministic(GID-SWAD-5194580) and architecture cannot fail in this way.
        The integration testing (GID-TEST-5365396) will not pass if it were the case.

  - id: LWSCISTREAM_SHARED_CAUSE_NA_021
    description: Mutliple threads try to enqueue/dequeue the packets at the same time,
                 hence corrupting the data in the PayloadQ.
    na: This potential cause is NA, since enqueue and dequeue operation from queue are
        protected by mutex and the architeure does not fail in this way (GID-SWAD-5313280).

  - id: LWSCISTREAM_SHARED_CAUSE_NA_022
    description: Failure in the trackArrayAction cycle, where it fails to keep track of the setting
                 of the data.
    na: The TrackArray architecture does not fail in this way while preparing
        (GID-SWAD-5133231). The integration testing
        will not pass if it were the case(GID-TEST-5396285).

  - id: LWSCISTREAM_SHARED_CAUSE_023
    description: Internal hangs/deadlocks within LwSciStream.
    heavens_ref: N/A
    measures:
      - LWSCISTREAM_SHARED_MEAS_DOS_ASU_010

  - id: LWSCISTREAM_SHARED_CAUSE_024
    description: LwSciSync APIs for export/import of LwSciSyncFences hangs.
    heavens_ref: N/A
    measures:
      - id: LWSCISTREAM_MEAS_002
        description: This is prevented by LwSciSync sub-element
                     (GID-REQ-4627288, GID-REQ-4627290).
        refs: [13053940, 13053958]
        tests: []
        type: Prevention of Cause

  - id: LWSCISTREAM_SHARED_CAUSE_NA_025
    description: Failure to propogate error from LwSciWrap SyncFence copy operations.
    na:   This is prevented by design as the  LwSciSyncFenceDup() failures are reported
          to the application when the the LwSciSyncFence are passed on to the application
          (GID-SWAD-5314310, GID-SWAD-5313257) as LwSciWrap, takeVal interface will
          return error in that case.

  - id: LWSCISTREAM_SHARED_CAUSE_NA_026
    description: Internal failure in LwSciStream, where it fails to check
                 or change the packet location after receiving the packet
                 from producer application.
    na: This potential cause is NA, since architecture (GID-SWAD-5313294),
                update packet location(GID-SWAD-5313294) does not fail in this way.
                The integration testing will not pass if it were the case (GID-TEST-5364844).

  - id: LWSCISTREAM_SHARED_CAUSE_NA_027
    description: Internal failure in LwSciStream, where it fails to check or
                 change the packet location after receiving the packet from
                 consumer application.
    na: This potential cause is NA, since architecture (GID-SWAD-5314376),
        update packet location(GID-SWAD-5313294) does not fail in this way.
        The integration testing will not pass if it were the case (GID-TEST-5364853).

  - id: LWSCISTREAM_SHARED_CAUSE_NA_261
    description: Failure in Packet unit while storing and retrieving the packet
      location and packet deletion status.
    na: This cause is prevented by design as storing and retrieving the packet
      deletion status(GID-SWAD-5194583, GID-SWAD-5194584) and packet location
      (GID-SWAD-5194581, GID-SWAD-5194582) are simple operations and is verified
      by integration testing for packet deletion status(GID-TEST-5355756,
      GID-TEST-5355758) and for packet location (GID-TEST-5355752, GID-TEST-5355754).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_263
    description: Failure in Block unit - pktFindByHandle() to locate
      the packet even though the packet exists in the pktMap.
    na: This cause is prevented by design as pktFindByHandle is a simple operation
        and clearly does not fail in this way (GID-SWAD-5301957) and integration testing
        will ensure that the cause is not feasible(GID-TEST-5408631).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_264
    description: LwSciStream units fails to relay the data to upstream/downstream
      blocks due to failure in src/dst delete*() safeconnection unit interfaces.
    na: src/dst delete*() safeconnection unit interfaces (GID-SWAD-5276645,
      GID-SWAD-5275873) would not fail this way, otherwise, the integration
      test would not pass (GID-TEST-5356217, GID-TEST-5356222, GID-TEST-5356227).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_266
    description: Failure in Block unit where pktFindByHandle() interface returns
        incorrect packet pointer.
    na: This cause is prevented by design as pktFindByHandle is a simple operation
        and clearly does not fail in this way (GID-SWAD-5301957) and integration testing
        will ensure that the cause is not feasible(GID-TEST-5408631).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_295
    description: Failure in Safeconnection unit - release() to release the source
      and destination safeConnection.
    na: This cause is prevented by design(GID-SWAD-5278538, GID-SWAD-5278539) and
      integration testing will ensure that this cause is not feasible(GID-TEST-5302919,
      GID-TEST-5302920).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_321
    description: 'Failure in Block unit - pktCreate() function while creating the
      new packet. '
    na: This cause is prevented by design as packet creation is a simple operation
      (GID-SWAD-5301958) and integration testing will ensure that the cause is not
      feasible(GID-TEST-5408635).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_322
    description: Failure in Packet unit while creating the packet instance
    na: This cause is prevented by design as Packet initialization is a
      simple operation(GID-SWAD-5301958) and integration testing will ensure
      that the cause is not feasible(GID-TEST-5408635).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_328
    description: Failure in Packet unit - pendingEvent() to retrieve the PACKET_CREATE
      event leads to multicast and IpcSrc blocks fail to send the packet downstream.
    na: This cause is prevented by design as the architecture clearly does not fail
      in this way(GID-SWAD-5301294, GID-SWAD-5301295,
      GID-SWAD-5194595) and integration testing will ensure that this cause is not
      feasible(GID-TEST-5355760).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_329
    description: Failure in pool unit to store and retrieve the number of packets
      created and number of packets desired.
    na: This cause is prevented by design(GID-SWAD-5301288) as storing and
      retrieving the number of packets desired/created is a simple operation and
      integration testing will ensure that this cause is not feasible
      (GID-TEST-5329109, GID-TEST-5329114).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_334
    description: Failure in pool unit- createPacket() interface which returns an
      invalid/incorrect packet handle.
    na: This cause is prevented by design as creating a packet handle from the
      given cookie is a simple operation(GID-SWAD-5301288) and integration testing will
      ensure that this cause is not feasible(GID-TEST-5329109, GID-TEST-5364813).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_350
    description: Failure in Packet unit allStatusEventsUsed() to track the packet
      status from all endpoints.
    na: This cause is prevented by design as allStatusEventsUsed() is a simple
      operation(GID-SWAD-5301302, GID-SWAD-5301312, GID-SWAD-5301953,
      GID-SWAD-5194592) and integration testing will ensure that the cause is not
      present (GID-TEST-5355745).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_360
    description: Failure in packet unit to store and retrieve the packet status.
    na: This is prevented by design as storing (GID-SWAD-5194589) and
      retrieving (GID-SWAD-5194595) packet status is a simple operation and
      verified by integration testing(GID-TEST-5355736, GID-TEST-5366623).
      #TODO: Test case to add for querying PACKET_STATUS_CONSUMER event and check
      # the packet status received on event.
  - id: LWSCISTREAM_SHARED_CAUSE_NA_373
    description: Internal failure in LwSciStream reporting an incorrect value
      for an attribute.
    na: This cause is implausible. Architecture clearly does not fail in
      this way(GID-SWAD-5158125) as there are set of constant types defined in the
      architecture(GID-SWAD-5153900, GID-SWAD-5153899, GID-SWAD-5153898). This
      is verified by integration testing (GID-TEST-5365401).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_402
    description: Failure in Block unit - registerBlock() to register the created
      block.
    na: This is prevented by design as registering the block is a simple operation
        (GID-SWAD-5275880) and verified by integration testing(GID-TEST-5407991).
      (NOTE) This cause can lead to other failure modes as well but is specified
      only here for brevity.
  - id: LWSCISTREAM_SHARED_CAUSE_NA_418
    description: Failure in IpcComm unit - while performing the IpcComm initialization.
    na: This is prevented by design as the IpcComm initialization is a simple
      operation(GID-SWAD-5275925, GID-SWAD-5165488) and verified by integration
      testing(GID-TEST-5364861, GID-TEST-5364865).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_428
    description: Failure in Block unit while assigning the block handle for a new
        block.
    na: This is prevented by design as Block unit ensures to assign a unique
      handle on every block creation(GID-SWAD-5275909,GID-SWAD-5275890,
      GID-SWAD-5275910, GID-SWAD-5275914, GID-SWAD-5275911, GID-SWAD-5275912,
      GID-SWAD-5275913, GID-SWAD-5275915, GID-SWAD-5282346). This is verified
      by integration testing(GID-TEST-5364768, GID-TEST-5364758, GID-TEST-5364775,
      GID-TEST-5364772, GID-TEST-5364763, GID-TEST-5364861, GID-TEST-5364865,
      GID-TEST-5364778, GID-TEST-5364858).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_430
    description: LwSciStream internal failure creating a block with incorrect
      block type.
    na: Potential cause is NA as the architecture clearly does not fail
      in this way because always correct block type is passed for creating blocks
      (GID-SWAD-5275909,GID-SWAD-5275890, GID-SWAD-5275910,
      GID-SWAD-5275914, GID-SWAD-5275911, GID-SWAD-5275912, GID-SWAD-5275913,
      GID-SWAD-5275915, GID-SWAD-5282346). This is verified by integration testing
      (GID-TEST-5408614).
      #TODO: Test cases needs to be added for checking all the blocks types
      #(GID-SWUD-5122017)
  - id: LWSCISTREAM_SHARED_CAUSE_NA_437
    description: Failure in created IpcDst/IpcSrc block instance to store and
      retrieve the correct IPC endpoint handle.
    na: This is prevented by design as storing and retrieving of IPC endpoint
      handle is a simple operation and cannot fail in this way(GID-SWAD-5275913,
      GID-SWAD-5275912).
      #TODO: Missing integration test for inter-process communication, also
      # rely on integration testing.
  - id: LWSCISTREAM_SHARED_CAUSE_NA_820
    description: Failure in TrackArrayEvent units, which corrupts the data while
      storing and retreiving the event data.
    na: The TrackArray architecture does not fail in this way while preparing
      event (GID-SWAD-5301168) or retrieving event (GID-SWAD-5301169). It's
      also verified by integration testing for preparing event (GID-TEST-5396287,
      GID-TEST-5396288) and retrieving event (GID-TEST-5396289,
      GID-TEST-5327467, GID-TEST-5327468, GID-TEST-5327469, GID-TEST-5327470,
      GID-TEST-5327466).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_821
    description: TrackArrayEvent unit prepares the event with a wrong event
      type.
    na: This cause is prevented by design (GID-SWAD-5301169) and verified by
      testing (GID-TEST-5396289, GID-TEST-5327467, GID-TEST-5327468,
      GID-TEST-5327469, GID-TEST-5327470, GID-TEST-5327466).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_822
    description: TrackArrayEvent unit messes up the mapping between the index
      and the corresponding object/value and sends the wrong data
      corresponding to a particular element index.
    na: Preparing event data (GID-SWAD-5301168) and retrieving event data
      (GID-SWAD-5301169) could not fail this way, which are also verified by
      testing (GID-TEST-5396287, GID-TEST-5396288, GID-TEST-5396289).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_852
    description: Failure in packet unit - bufferStatusEventPrepare(), which
      doesn't trigger the prepareEvent() API of TrackArray.
    na: This cause is prevented by design (GID-SWAD-5301329, GID-SWAD-5301334,
      GID-SWAD-5301338, GID-SWAD-5301340) and the integration test would not
      pass if it fails (GID-TEST-5365395, GID-TEST-5365396).
      # TODO: Add positive integration test case for bufferStatusEventPrepare()
  - id: LWSCISTREAM_SHARED_CAUSE_NA_853
    description: Failure in packet unit - allStatusEventsUsed(), which fails
      when checking whether all expected acceptance-status from all endpoints
      are received.
    na: It's prevented by the current design (GID-SWAD-5194592) and verified
      by integration testing (GID-TEST-5355745, GID-TEST-5355743, GID-TEST-5355744).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_854
    description: Failure in packet unit - statusEventRejectedCheck(), which
      fails to report whether the packet and elements are rejected by any
      endpont.
    na: It's a simple opration (GID-SWAD-5194591) and verified by integration testing
      (GID-TEST-5355742, GID-TEST-5355741).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_855
    description: Failure in packet unit - bufferStatusEventsDone(), which
      fails to report whether the packet and elements are received from all
      consumers for multicast use case.
    na: It's prevented by the current design (LWSTRMS52-SWAD-6431) and
      verified by integration testing (GID-TEST-5355750, GID-TEST-5355748,
      GID-TEST-5355749, GID-TEST-5366615).
  - id: LWSCISTREAM_SHARED_CAUSE_NA_851
    description: Failure in packet unit - bufferStatusAction(), which doesn't
      perform the correct action to send the endpoint status for the packet
      element to upstream and downstream blocks.
    na: This cause is prevented by design (GID-SWAD-5301328, GID-SWAD-5301332,
      GID-SWAD-5301335) and the integration test would not pass if it fails
      (GID-TEST-5365395, GID-TEST-5365396).
      # TODO: Add positive integration test case for bufferStatusAction()
  - id: LWSCISTREAM_SHARED_CAUSE_NA_857
    description: Failure in trackCount, pendingAction to wait
                 for the completion of pending action.
    na: This cause is prevented by design (GID-SWAD-5301171) and the integration
        testing will not pass if it were the case (GID-TEST-4995748).
# List of common / shared safety measures can be defined here as well.
measures:
  - id: LWSCISTREAM_SHARED_MEAS_DOS_RES_104
    description: "DOS_RES_104: The user of DRIVE OS must ensure that
        exelwtion of all Init group APIs is completed before transitioning to
        the Normal Operation state."
    type: Detection and Control of Failure Mode
    refs: DOS_RES_104

  - id: LWSCISTREAM_SHARED_MEAS_002
    description: LwSciStream will report error to the application,
                 if further initialization steps such as syncronization or the
                 packet element setup is attempted before the stream is in
                 connected state (GID-SWAD-5275875).
                 (DOS_RES_105) When any error is reported by the Init group APIs,
                 the user's application must not transition itself to the
                 Normal Operation state.
    refs: [20996091]
    type: Detection and Control of Failure Mode

  - id: LWSCISTREAM_SHARED_MEAS_DOS_ASU_010
    description: (DOS_ASU_010) It is assumed that the user of DRIVE OS will detect
                 non-completion of the safety-related task when it does not complete
                 within the expected timeframe.
    type: Detection and Control of Failure Mode
    refs: DOS_ASU_010

  - id: LWSCISTREAM_SHARED_MEAS_DOS_RES_105
    description: When any error is reported by the Init group APIs,
                 the user's application must not transition itself to the
                 Normal Operation state.
    type: Detection and Reporting of Failure Mode
    refs: [DOS_RES_105] # link to DRIVE OS ARR
